{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "66a242f9",
   "metadata": {
    "id": "x9LNzEYERaH2",
    "papermill": {
     "duration": 0.004637,
     "end_time": "2025-01-20T03:57:53.150208",
     "exception": false,
     "start_time": "2025-01-20T03:57:53.145571",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Download Packages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "2564ba83",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T03:57:53.160213Z",
     "iopub.status.busy": "2025-01-20T03:57:53.159204Z",
     "iopub.status.idle": "2025-01-20T03:57:54.253168Z",
     "shell.execute_reply": "2025-01-20T03:57:54.251835Z"
    },
    "papermill": {
     "duration": 1.101645,
     "end_time": "2025-01-20T03:57:54.255747",
     "exception": false,
     "start_time": "2025-01-20T03:57:53.154102",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/bin/bash: nvidia-smi: command not found\r\n"
     ]
    }
   ],
   "source": [
    "!nvidia-smi -L"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "aab54f09",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T03:57:54.266541Z",
     "iopub.status.busy": "2025-01-20T03:57:54.265523Z",
     "iopub.status.idle": "2025-01-20T03:59:15.026571Z",
     "shell.execute_reply": "2025-01-20T03:59:15.025157Z"
    },
    "id": "K0oS6IH7VTZX",
    "papermill": {
     "duration": 80.769006,
     "end_time": "2025-01-20T03:59:15.029285",
     "exception": false,
     "start_time": "2025-01-20T03:57:54.260279",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "%%capture\n",
    "!pip install -U git+https://github.com/UN-GCPDS/python-gcpds.databases #Package for database reading.\n",
    "!pip install mne #The MNE Package is installed\n",
    "FILEID = \"1lo0MjWLvsyne2CgTA6VZ2HGY9SKxiwZ7\"\n",
    "!wget --load-cookies /tmp/cookies.txt \"https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id='$FILEID -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\\1\\n/p')&id=\"$FILEID -O MI_EEG_ClassMeth.zip && rm -rf /tmp/cookies.txt\n",
    "!unzip MI_EEG_ClassMeth.zip #Package with useful functions for motor imagery classification based in EEG.\n",
    "!pip install -U git+https://github.com/UN-GCPDS/python-gcpds.EEG_Tensorflow_models.git\n",
    "!dir"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "35e8a31a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T03:59:15.039514Z",
     "iopub.status.busy": "2025-01-20T03:59:15.039091Z",
     "iopub.status.idle": "2025-01-20T04:03:07.274965Z",
     "shell.execute_reply": "2025-01-20T04:03:07.273506Z"
    },
    "papermill": {
     "duration": 232.245064,
     "end_time": "2025-01-20T04:03:07.278438",
     "exception": false,
     "start_time": "2025-01-20T03:59:15.033374",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\r\n",
      "\r\n",
      "\r\n",
      "E: Unable to locate package libcudnn8\r\n",
      "Collecting tensorflow==2.8.2\r\n",
      "  Downloading tensorflow-2.8.2-cp310-cp310-manylinux2010_x86_64.whl.metadata (2.9 kB)\r\n",
      "Requirement already satisfied: absl-py>=0.4.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.4.0)\r\n",
      "Requirement already satisfied: astunparse>=1.6.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.6.3)\r\n",
      "Requirement already satisfied: flatbuffers>=1.12 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (24.3.25)\r\n",
      "Requirement already satisfied: gast>=0.2.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (0.5.4)\r\n",
      "Requirement already satisfied: google-pasta>=0.1.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (0.2.0)\r\n",
      "Requirement already satisfied: h5py>=2.9.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (3.11.0)\r\n",
      "Collecting keras-preprocessing>=1.1.1 (from tensorflow==2.8.2)\r\n",
      "  Downloading Keras_Preprocessing-1.1.2-py2.py3-none-any.whl.metadata (1.9 kB)\r\n",
      "Requirement already satisfied: libclang>=9.0.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (18.1.1)\r\n",
      "Requirement already satisfied: numpy>=1.20 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.26.4)\r\n",
      "Requirement already satisfied: opt-einsum>=2.3.2 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (3.3.0)\r\n",
      "Collecting protobuf<3.20,>=3.9.2 (from tensorflow==2.8.2)\r\n",
      "  Downloading protobuf-3.19.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (787 bytes)\r\n",
      "Requirement already satisfied: setuptools in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (70.0.0)\r\n",
      "Requirement already satisfied: six>=1.12.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.16.0)\r\n",
      "Requirement already satisfied: termcolor>=1.1.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (2.4.0)\r\n",
      "Requirement already satisfied: typing-extensions>=3.6.6 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (4.12.2)\r\n",
      "Requirement already satisfied: wrapt>=1.11.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.16.0)\r\n",
      "Collecting tensorboard<2.9,>=2.8 (from tensorflow==2.8.2)\r\n",
      "  Downloading tensorboard-2.8.0-py3-none-any.whl.metadata (1.9 kB)\r\n",
      "Collecting tensorflow-estimator<2.9,>=2.8 (from tensorflow==2.8.2)\r\n",
      "  Downloading tensorflow_estimator-2.8.0-py2.py3-none-any.whl.metadata (1.3 kB)\r\n",
      "Collecting keras<2.9,>=2.8.0rc0 (from tensorflow==2.8.2)\r\n",
      "  Downloading keras-2.8.0-py2.py3-none-any.whl.metadata (1.3 kB)\r\n",
      "Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (0.37.0)\r\n",
      "Requirement already satisfied: grpcio<2.0,>=1.24.3 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.64.1)\r\n",
      "Requirement already satisfied: wheel<1.0,>=0.23.0 in /opt/conda/lib/python3.10/site-packages (from astunparse>=1.6.0->tensorflow==2.8.2) (0.43.0)\r\n",
      "Requirement already satisfied: google-auth<3,>=1.6.3 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8.2) (2.30.0)\r\n",
      "Collecting google-auth-oauthlib<0.5,>=0.4.1 (from tensorboard<2.9,>=2.8->tensorflow==2.8.2)\r\n",
      "  Downloading google_auth_oauthlib-0.4.6-py2.py3-none-any.whl.metadata (2.7 kB)\r\n",
      "Requirement already satisfied: markdown>=2.6.8 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8.2) (3.6)\r\n",
      "Requirement already satisfied: requests<3,>=2.21.0 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8.2) (2.32.3)\r\n",
      "Collecting tensorboard-data-server<0.7.0,>=0.6.0 (from tensorboard<2.9,>=2.8->tensorflow==2.8.2)\r\n",
      "  Downloading tensorboard_data_server-0.6.1-py3-none-manylinux2010_x86_64.whl.metadata (1.1 kB)\r\n",
      "Collecting tensorboard-plugin-wit>=1.6.0 (from tensorboard<2.9,>=2.8->tensorflow==2.8.2)\r\n",
      "  Downloading tensorboard_plugin_wit-1.8.1-py3-none-any.whl.metadata (873 bytes)\r\n",
      "Requirement already satisfied: werkzeug>=0.11.15 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8.2) (3.0.4)\r\n",
      "Requirement already satisfied: cachetools<6.0,>=2.0.0 in /opt/conda/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (4.2.4)\r\n",
      "Requirement already satisfied: pyasn1-modules>=0.2.1 in /opt/conda/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (0.4.0)\r\n",
      "Requirement already satisfied: rsa<5,>=3.1.4 in /opt/conda/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (4.9)\r\n",
      "Requirement already satisfied: requests-oauthlib>=0.7.0 in /opt/conda/lib/python3.10/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (2.0.0)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (3.3.2)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (3.7)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (1.26.18)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (2024.8.30)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.1.1 in /opt/conda/lib/python3.10/site-packages (from werkzeug>=0.11.15->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (2.1.5)\r\n",
      "Requirement already satisfied: pyasn1<0.7.0,>=0.4.6 in /opt/conda/lib/python3.10/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (0.6.0)\r\n",
      "Requirement already satisfied: oauthlib>=3.0.0 in /opt/conda/lib/python3.10/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (3.2.2)\r\n",
      "Downloading tensorflow-2.8.2-cp310-cp310-manylinux2010_x86_64.whl (498.0 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m498.0/498.0 MB\u001b[0m \u001b[31m1.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading keras-2.8.0-py2.py3-none-any.whl (1.4 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.4/1.4 MB\u001b[0m \u001b[31m41.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading Keras_Preprocessing-1.1.2-py2.py3-none-any.whl (42 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m42.6/42.6 kB\u001b[0m \u001b[31m1.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading protobuf-3.19.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.1 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.1/1.1 MB\u001b[0m \u001b[31m36.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading tensorboard-2.8.0-py3-none-any.whl (5.8 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m5.8/5.8 MB\u001b[0m \u001b[31m86.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading tensorflow_estimator-2.8.0-py2.py3-none-any.whl (462 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m462.3/462.3 kB\u001b[0m \u001b[31m21.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading google_auth_oauthlib-0.4.6-py2.py3-none-any.whl (18 kB)\r\n",
      "Downloading tensorboard_data_server-0.6.1-py3-none-manylinux2010_x86_64.whl (4.9 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.9/4.9 MB\u001b[0m \u001b[31m85.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading tensorboard_plugin_wit-1.8.1-py3-none-any.whl (781 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m781.3/781.3 kB\u001b[0m \u001b[31m30.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hInstalling collected packages: tensorflow-estimator, tensorboard-plugin-wit, keras, tensorboard-data-server, protobuf, keras-preprocessing, google-auth-oauthlib, tensorboard, tensorflow\r\n",
      "  Attempting uninstall: tensorflow-estimator\r\n",
      "    Found existing installation: tensorflow-estimator 2.15.0\r\n",
      "    Uninstalling tensorflow-estimator-2.15.0:\r\n",
      "      Successfully uninstalled tensorflow-estimator-2.15.0\r\n",
      "  Attempting uninstall: keras\r\n",
      "    Found existing installation: keras 3.3.3\r\n",
      "    Uninstalling keras-3.3.3:\r\n",
      "      Successfully uninstalled keras-3.3.3\r\n",
      "  Attempting uninstall: tensorboard-data-server\r\n",
      "    Found existing installation: tensorboard-data-server 0.7.2\r\n",
      "    Uninstalling tensorboard-data-server-0.7.2:\r\n",
      "      Successfully uninstalled tensorboard-data-server-0.7.2\r\n",
      "  Attempting uninstall: protobuf\r\n",
      "    Found existing installation: protobuf 3.20.3\r\n",
      "    Uninstalling protobuf-3.20.3:\r\n",
      "      Successfully uninstalled protobuf-3.20.3\r\n",
      "  Attempting uninstall: google-auth-oauthlib\r\n",
      "    Found existing installation: google-auth-oauthlib 1.2.0\r\n",
      "    Uninstalling google-auth-oauthlib-1.2.0:\r\n",
      "      Successfully uninstalled google-auth-oauthlib-1.2.0\r\n",
      "  Attempting uninstall: tensorboard\r\n",
      "    Found existing installation: tensorboard 2.16.2\r\n",
      "    Uninstalling tensorboard-2.16.2:\r\n",
      "      Successfully uninstalled tensorboard-2.16.2\r\n",
      "  Attempting uninstall: tensorflow\r\n",
      "    Found existing installation: tensorflow 2.16.1\r\n",
      "    Uninstalling tensorflow-2.16.1:\r\n",
      "      Successfully uninstalled tensorflow-2.16.1\r\n",
      "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\r\n",
      "apache-beam 2.46.0 requires cloudpickle~=2.2.1, but you have cloudpickle 3.0.0 which is incompatible.\r\n",
      "apache-beam 2.46.0 requires dill<0.3.2,>=0.3.1.1, but you have dill 0.3.8 which is incompatible.\r\n",
      "apache-beam 2.46.0 requires numpy<1.25.0,>=1.14.3, but you have numpy 1.26.4 which is incompatible.\r\n",
      "apache-beam 2.46.0 requires pyarrow<10.0.0,>=3.0.0, but you have pyarrow 17.0.0 which is incompatible.\r\n",
      "google-ai-generativelanguage 0.6.10 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-aiplatform 0.6.0a1 requires google-api-core[grpc]<2.0.0dev,>=1.22.2, but you have google-api-core 2.11.1 which is incompatible.\r\n",
      "google-cloud-automl 1.0.1 requires google-api-core[grpc]<2.0.0dev,>=1.14.0, but you have google-api-core 2.11.1 which is incompatible.\r\n",
      "google-cloud-language 2.14.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-spanner 3.47.0 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-videointelligence 2.13.5 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "kfp 2.5.0 requires google-cloud-storage<3,>=2.2.1, but you have google-cloud-storage 1.44.0 which is incompatible.\r\n",
      "onnx 1.17.0 requires protobuf>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorboardx 2.6.2.2 requires protobuf>=3.20, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorflow-datasets 4.9.6 requires protobuf>=3.20, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorflow-decision-forests 1.9.1 requires tensorflow~=2.16.1, but you have tensorflow 2.8.2 which is incompatible.\r\n",
      "tensorflow-serving-api 2.16.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorflow-serving-api 2.16.1 requires tensorflow<3,>=2.16.1, but you have tensorflow 2.8.2 which is incompatible.\r\n",
      "tensorflow-text 2.16.1 requires tensorflow<2.17,>=2.16.1; platform_machine != \"arm64\" or platform_system != \"Darwin\", but you have tensorflow 2.8.2 which is incompatible.\r\n",
      "tf-keras 2.16.0 requires tensorflow<2.17,>=2.16, but you have tensorflow 2.8.2 which is incompatible.\u001b[0m\u001b[31m\r\n",
      "\u001b[0mSuccessfully installed google-auth-oauthlib-0.4.6 keras-2.8.0 keras-preprocessing-1.1.2 protobuf-3.19.6 tensorboard-2.8.0 tensorboard-data-server-0.6.1 tensorboard-plugin-wit-1.8.1 tensorflow-2.8.2 tensorflow-estimator-2.8.0\r\n"
     ]
    }
   ],
   "source": [
    "!apt-get install --allow-change-held-packages libcudnn8=8.1.0.77-1+cuda11.2 -y\n",
    "!pip install tensorflow==2.8.2"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "21f0a1c9",
   "metadata": {
    "papermill": {
     "duration": 0.232107,
     "end_time": "2025-01-20T04:03:07.776144",
     "exception": false,
     "start_time": "2025-01-20T04:03:07.544037",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Functions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "a353d644",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T04:03:08.274430Z",
     "iopub.status.busy": "2025-01-20T04:03:08.273940Z",
     "iopub.status.idle": "2025-01-20T04:03:16.330352Z",
     "shell.execute_reply": "2025-01-20T04:03:16.329257Z"
    },
    "id": "yE1sbHYQVbBq",
    "papermill": {
     "duration": 8.293886,
     "end_time": "2025-01-20T04:03:16.332806",
     "exception": false,
     "start_time": "2025-01-20T04:03:08.038920",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [],
   "source": [
    "from gcpds.databases.BCI_Competition_IV import Dataset_2a\n",
    "from typing import Sequence, Tuple\n",
    "from MI_EEG_ClassMeth.FeatExtraction import TimeFrequencyRpr\n",
    "import numpy as np\n",
    "from scipy.signal import resample\n",
    "\n",
    "def load_BCICIV2a(db: Dataset_2a,\n",
    "               sbj: int,\n",
    "               mode: str,\n",
    "               fs: float, \n",
    "               f_bank: np.ndarray, \n",
    "               vwt: np.ndarray, \n",
    "               new_fs: float) -> np.ndarray:\n",
    "\n",
    "  tf_repr = TimeFrequencyRpr(sfreq = fs, f_bank = f_bank, vwt = vwt)\n",
    "\n",
    "  db.load_subject(sbj, mode = mode)\n",
    "    \n",
    "  X, y = db.get_data() #Load all classes, all channels {EEG, EOG}, reject bad trials\n",
    "\n",
    "  X = X[:,:-3,:] # pick EEG channels\n",
    "  X = X*1e6 #uV\n",
    "  X = np.squeeze(tf_repr.transform(X))\n",
    "  #Resampling\n",
    "  if new_fs == fs:\n",
    "    print('No resampling, since new sampling rate same.')\n",
    "  else:\n",
    "    print(\"Resampling from {:f} to {:f} Hz.\".format(fs, new_fs))\n",
    "    X = resample(X, int((X.shape[-1]/fs)*new_fs), axis = -1)\n",
    "    \n",
    "  return X, y\n",
    "\n",
    "\n",
    "from gcpds.databases import GIGA_MI_ME\n",
    "\n",
    "def load_GIGA_MI_ME(db: GIGA_MI_ME,\n",
    "              sbj: int,\n",
    "              eeg_ch_names: Sequence[str],\n",
    "              fs: float, \n",
    "              f_bank: np.ndarray, \n",
    "              vwt: np.ndarray, \n",
    "              new_fs: float) -> Tuple[np.ndarray, np.ndarray]:\n",
    "\n",
    "    index_eeg_chs = db.format_channels_selectors(channels=eeg_ch_names) - 1\n",
    "\n",
    "    tf_repr = TimeFrequencyRpr(sfreq=fs, f_bank=f_bank, vwt=vwt)\n",
    "\n",
    "    # Load subject data\n",
    "    db.load_subject(sbj)\n",
    "    X, y = db.get_data(classes=['left hand mi', 'right hand mi'])\n",
    "    \n",
    "    # Debugging total trials\n",
    "    print(f\"Total trials loaded: {X.shape[0]}\")\n",
    "    print(f\"Shape of X: {X.shape}, Shape of y: {y.shape}\")\n",
    "\n",
    "    # Spatial rearrangement\n",
    "    X = X[:, index_eeg_chs, :]  \n",
    "    X = np.squeeze(tf_repr.transform(X))\n",
    "\n",
    "    # Resampling\n",
    "    if new_fs == fs:\n",
    "        print('No resampling, since new sampling rate is the same.')\n",
    "    else:\n",
    "        print(f\"Resampling from {fs} to {new_fs} Hz.\")\n",
    "        X = resample(X, int((X.shape[-1] / fs) * new_fs), axis=-1)\n",
    "    \n",
    "    return X, y\n",
    "\n",
    "\n",
    "\n",
    "def load_DB(db_name, **load_args):\n",
    "  if db_name == 'BCICIV2a':\n",
    "    X_train, y_train = load_BCICIV2a(**load_args, mode = 'training')\n",
    "    X_test, y_test = load_BCICIV2a(**load_args, mode = 'evaluation')\n",
    "\n",
    "    X_train = np.concatenate([X_train, X_test], axis = 0)\n",
    "    y_train = np.concatenate([y_train, y_test], axis = 0)\n",
    "\n",
    "  elif db_name == 'GIGA_MI_ME':\n",
    "    X_train, y_train = load_GIGA_MI_ME(**load_args)\n",
    "    \n",
    "  else:\n",
    "    raise ValueError('No valid database name')\n",
    "\n",
    "  return X_train, y_train\n",
    "\n",
    "\n",
    "from EEG_Tensorflow_models.Models import DeepConvNet, ShallowConvNet, EEGNet, DMTL_BCI, TCNet_fusion, PST_attention\n",
    "\n",
    "\n",
    "def get_model(model_name, nb_classes):\n",
    "  if model_name == 'DeepConvNet':\n",
    "    model = DeepConvNet\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      dropoutRate = 0.5, version='2018')\n",
    "    \n",
    "  elif model_name == 'ShallowConvNet':\n",
    "    model = ShallowConvNet\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      dropoutRate = 0.5,\n",
    "                      version = '2018')\n",
    "    \n",
    "  elif model_name == 'EEGNet':\n",
    "    model = EEGNet\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      dropoutRate = 0.5,\n",
    "                      kernLength = 32,\n",
    "                      F1 = 8,\n",
    "                      D = 2,\n",
    "                      F2 = 16,\n",
    "                      norm_rate = 0.25, \n",
    "                      dropoutType = 'Dropout')\n",
    "    \n",
    "  elif model_name == 'DMTL_BCI':\n",
    "    model = DMTL_BCI\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      dropoutRate = 0.5,\n",
    "                      l1 = 0,\n",
    "                      l2 = 0)\n",
    "    \n",
    "  elif model_name == 'TCNet_fusion':\n",
    "    model = TCNet_fusion\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      layers = 2,\n",
    "                      kernel_s = 4,\n",
    "                      filt = 12,\n",
    "                      dropout = 0.3,\n",
    "                      activation = 'relu',\n",
    "                      F1 = 24,\n",
    "                      D = 2,\n",
    "                      kernLength = 32,\n",
    "                      N_residuals = 2)\n",
    "    \n",
    "  elif model_name == 'PST_attention':\n",
    "    model = PST_attention\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      dropoutRate = 0.5,\n",
    "                      last_layer = 'Dense')\n",
    "    \n",
    "  else:\n",
    "    raise ValueError('No valid model name')\n",
    "    \n",
    "  return model, model_params\n",
    "\n",
    "from tensorflow.random import set_seed\n",
    "from tensorflow.keras.backend import clear_session\n",
    "from tensorflow.keras.optimizers import Adam\n",
    "from sklearn.metrics import accuracy_score, cohen_kappa_score, roc_auc_score,\\\n",
    "                            f1_score, recall_score, precision_score\n",
    "\n",
    "def train(db_name, load_args, cv_args, model_args, compile_args, fit_args, seed):\n",
    "    X_train, y_train = load_DB(db_name, **load_args)\n",
    "    X_train = X_train[..., np.newaxis]  # Add channel dimension\n",
    "    print(f\"X_train shape: {X_train.shape}, y_train shape: {y_train.shape}\")\n",
    "    \n",
    "    cv_results = {'params': [],\n",
    "                  'mean_acc': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_kappa': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_auc': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_f1_left': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_f1_right': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_recall_left': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_recall_right': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_precision_left': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_precision_right': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'all_folds': []}\n",
    "    \n",
    "    k = 0\n",
    "    max_acc = -np.inf\n",
    "\n",
    "    # Loop through folds\n",
    "    for train_index, val_index in cv_args['cv'].split(X_train, y_train):\n",
    "        print(f\"Running fold {k} with {len(train_index)} training samples and {len(val_index)} validation samples\")\n",
    "        print(f\"Fold {k}: train indices: {train_index[:5]}, val indices: {val_index[:5]}\")  # Print first indices\n",
    "        \n",
    "        X, X_val = X_train[train_index], X_train[val_index]\n",
    "        y, y_val = y_train[train_index], y_train[val_index]\n",
    "        \n",
    "        if model_args['autoencoder']:\n",
    "            y = [X, y]\n",
    "        \n",
    "        print(f\"Training data shape: {X.shape}, Validation data shape: {X_val.shape}\")\n",
    "        \n",
    "        batch_size, C, T = X.shape[:-1]\n",
    "        clear_session()\n",
    "        set_seed(seed)\n",
    "\n",
    "        model_cll, model_params = get_model(model_args['model_name'], model_args['nb_classes'])\n",
    "        model = model_cll(**model_params, Chans=64, Samples=T)\n",
    "        model.compile(loss=compile_args['loss'], optimizer=Adam(compile_args['init_lr']))\n",
    "\n",
    "        history = model.fit(X, y, batch_size=batch_size, **fit_args)\n",
    "        print(f\"Fold {k} training loss: {history.history['loss'][-1]}\")  # Print final loss\n",
    "\n",
    "        if model_args['autoencoder']:\n",
    "            y_prob = model.predict(X_val)[-1]\n",
    "        else:\n",
    "            y_prob = model.predict(X_val)\n",
    "        y_pred = np.argmax(y_prob, axis=1)\n",
    "\n",
    "        print(f\"y_true (val): {y_val[:5]}\")\n",
    "        print(f\"y_pred: {y_pred[:5]}\")\n",
    "        \n",
    "        # Calculate metrics\n",
    "        acc = accuracy_score(y_val, y_pred)\n",
    "        kappa = cohen_kappa_score(y_val, y_pred)\n",
    "        auc = roc_auc_score(y_val, y_prob[:, 1], average='macro') if model_args['nb_classes'] == 2 else None\n",
    "        \n",
    "        # Save metrics for this fold\n",
    "        fold_result = {\n",
    "            'fold_index': k,\n",
    "            'train_indices': train_index.tolist(),\n",
    "            'val_indices': val_index.tolist(),\n",
    "            'accuracy': acc,\n",
    "            'kappa': kappa,\n",
    "            'auc': auc\n",
    "        }\n",
    "        print(f\"Appending results for fold {k}: {fold_result}\")\n",
    "        cv_results['all_folds'].append(fold_result)\n",
    "\n",
    "        # Update overall fold metrics\n",
    "        cv_results['mean_acc'][k] = acc\n",
    "        cv_results['mean_kappa'][k] = kappa\n",
    "        if auc is not None:\n",
    "            cv_results['mean_auc'][k] = auc\n",
    "        \n",
    "        # Save the best model weights\n",
    "        if acc > max_acc:\n",
    "            print('New Max Found!')\n",
    "            max_acc = acc\n",
    "            model.save_weights(f'sbj{load_args[\"sbj\"]}.h5')\n",
    "\n",
    "        k += 1\n",
    "    \n",
    "    # Calculate mean and std metrics\n",
    "    cv_results['std_acc'] = round(cv_results['mean_acc'].std(), 3)\n",
    "    cv_results['mean_acc'] = round(cv_results['mean_acc'].mean(), 3)\n",
    "    cv_results['std_kappa'] = round(cv_results['mean_kappa'].std(), 3)\n",
    "    cv_results['mean_kappa'] = round(cv_results['mean_kappa'].mean(), 3)\n",
    "    cv_results['std_auc'] = round(cv_results['mean_auc'].std(), 3)\n",
    "    cv_results['mean_auc'] = round(cv_results['mean_auc'].mean(), 3)\n",
    "    \n",
    "    print(f\"Final cross-validation results: {cv_results}\")\n",
    "    return cv_results\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0c3235ee",
   "metadata": {
    "id": "uBAeW6J5S68g",
    "papermill": {
     "duration": 0.184534,
     "end_time": "2025-01-20T04:03:16.699732",
     "exception": false,
     "start_time": "2025-01-20T04:03:16.515198",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Config"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "db5271a3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T04:03:17.078250Z",
     "iopub.status.busy": "2025-01-20T04:03:17.077550Z",
     "iopub.status.idle": "2025-01-20T04:03:17.082776Z",
     "shell.execute_reply": "2025-01-20T04:03:17.081743Z"
    },
    "id": "2I3IQnNSS9-a",
    "papermill": {
     "duration": 0.201894,
     "end_time": "2025-01-20T04:03:17.084939",
     "exception": false,
     "start_time": "2025-01-20T04:03:16.883045",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Marcos, use these two variables to run the state of the art. First, for BCICIV2a run all the models.\n",
    "# Remeber that this network DMTL_BCI is an autoencoder. Set the nb_classses parameter depending of the database.\n",
    "# set autoencoder based on the model\n",
    "# We need to run all these tests again. Do not forget to add the recall, preci, and f1 for each class (bci 4, giga 2)\n",
    "db_name = 'GIGA_MI_ME'\n",
    "model_args = dict(model_name = 'EEGNet',\n",
    "                  nb_classes = 2,\n",
    "                  autoencoder = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "83af638c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T04:03:17.507941Z",
     "iopub.status.busy": "2025-01-20T04:03:17.507015Z",
     "iopub.status.idle": "2025-01-20T04:03:17.522042Z",
     "shell.execute_reply": "2025-01-20T04:03:17.521171Z"
    },
    "id": "tqMhUFoBIc3B",
    "outputId": "1405fd59-1374-4d5d-8e3a-5e7a45c79bba",
    "papermill": {
     "duration": 0.200457,
     "end_time": "2025-01-20T04:03:17.524245",
     "exception": false,
     "start_time": "2025-01-20T04:03:17.323788",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from tensorflow.keras.callbacks import ReduceLROnPlateau, TerminateOnNaN\n",
    "import numpy as np\n",
    "from tensorflow.keras.losses import SparseCategoricalCrossentropy, MeanSquaredError\n",
    "from sklearn.model_selection import StratifiedShuffleSplit\n",
    "\n",
    "if db_name == 'BCICIV2a':\n",
    "  db = Dataset_2a('/kaggle/input/dataset-2a')\n",
    "  fs = db.metadata['sampling_rate']\n",
    "  load_args = dict(db = db,\n",
    "                 fs = fs,\n",
    "                 f_bank = np.asarray([[4., 40.]]),\n",
    "                 vwt = np.asarray([[2.5, 6]]),\n",
    "                 new_fs = 128.)\n",
    "  subjects = np.arange(db.metadata['subjects']) + 1\n",
    "  \n",
    "elif db_name == 'GIGA_MI_ME':\n",
    "  db = GIGA_MI_ME('/kaggle/input/giga-science-gcpds/GIGA_MI_ME')\n",
    "  fs = db.metadata['sampling_rate']\n",
    "\n",
    "  eeg_ch_names = ['Fp1','Fpz','Fp2',\n",
    "                     'AF7','AF3','AFz','AF4','AF8',\n",
    "                    'F7','F5','F3','F1','Fz','F2','F4','F6','F8',\n",
    "                   'FT7','FC5','FC3','FC1','FCz','FC2','FC4','FC6','FT8',\n",
    "                    'T7','C5','C3','C1','Cz','C2','C4','C6','T8',\n",
    "                   'TP7','CP5','CP3','CP1','CPz','CP2','CP4','CP6','TP8',\n",
    "                    'P9','P7','P5','P3','P1','Pz','P2','P4','P6','P8','P10',\n",
    "                    'PO7','PO3','POz','PO4','PO8',\n",
    "                    'O1','Oz','O2',\n",
    "                    'Iz']\n",
    "\n",
    "  # eeg_ch_names = ['Fp1','Fp2',\n",
    "  #                  'AF3','AF4',\n",
    "  #                  'F7','F3','Fz','F4','F8',\n",
    "  #                  'FC5','FC1','FC2','FC6',\n",
    "  #                  'T7','C3','Cz','C4','T8',\n",
    "  #                  'CP5','CP1','CP2','CP6',\n",
    "  #                  'P7','P3','Pz','P4','P8',\n",
    "  #                  'PO3','PO4',\n",
    "  #                  'O1','Oz','O2']\n",
    "\n",
    "  # eeg_ch_names = ['Fp1','Fp2',\n",
    "  #                 'F7','F3','F4','F8',\n",
    "  #                 'T7','C3','C4','T8',\n",
    "  #                 'P7','P3','P4','P8',\n",
    "  #                 'O1','O2']\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "  # eeg_ch_names = ['Fp1','Fp2',\n",
    "  #              'T7','C3','C4','T8',\n",
    "  #              'O1','O2']\n",
    "    \n",
    "\n",
    "\n",
    "  load_args = dict(db = db,\n",
    "                  eeg_ch_names = eeg_ch_names,\n",
    "                  fs = fs,\n",
    "                  f_bank = np.asarray([[4., 40.]]),\n",
    "                  vwt = np.asarray([[2.5, 5]]),\n",
    "                  new_fs = 128.)\n",
    "  subjects = np.arange(db.metadata['subjects']) + 1\n",
    "  subjects = np.delete(subjects, [28,33])\n",
    "  \n",
    "else:\n",
    "  raise ValueError('No valid database name')\n",
    "\n",
    "verbose = 0\n",
    "reduce_lr_on_plateau = ReduceLROnPlateau(monitor = 'loss', factor = 0.1, patience = 30, verbose = verbose, mode = 'min', min_delta = 0.01, min_lr = 0)\n",
    "terminate_on_nan = TerminateOnNaN()\n",
    "callbacks = [reduce_lr_on_plateau, terminate_on_nan]\n",
    "seed = 23\n",
    "\n",
    "cv_args = dict(cv = StratifiedShuffleSplit(n_splits = 5, test_size = 0.2, random_state = seed))\n",
    "\n",
    "compile_args = dict(loss = SparseCategoricalCrossentropy(), #['mse' , SparseCategoricalCrossentropy()]\n",
    "                    init_lr = 1e-2)\n",
    "                      \n",
    "fit_args = dict(epochs = 500,\n",
    "                verbose = verbose,\n",
    "                callbacks = callbacks)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b1f4df49",
   "metadata": {
    "id": "ukhXifxzTaj9",
    "papermill": {
     "duration": 0.197986,
     "end_time": "2025-01-20T04:03:17.903954",
     "exception": false,
     "start_time": "2025-01-20T04:03:17.705968",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Main"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "67309c27",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T04:03:18.284648Z",
     "iopub.status.busy": "2025-01-20T04:03:18.284238Z",
     "iopub.status.idle": "2025-01-20T09:16:55.711367Z",
     "shell.execute_reply": "2025-01-20T09:16:55.708212Z"
    },
    "id": "Ymqd_W21y3NK",
    "outputId": "5ca97a2f-f57c-46ee-8f53-f00181ccea90",
    "papermill": {
     "duration": 18817.776411,
     "end_time": "2025-01-20T09:16:55.874310",
     "exception": false,
     "start_time": "2025-01-20T04:03:18.097899",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "sbj =  47\n",
      "Total trials loaded: 192\n",
      "Shape of X: (192, 64, 3584), Shape of y: (192,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (192, 64, 320, 1), y_train shape: (192,)\n",
      "Running fold 0 with 153 training samples and 39 validation samples\n",
      "Fold 0: train indices: [177 163  46 143  13], val indices: [135  40 148  49  31]\n",
      "Training data shape: (153, 64, 320, 1), Validation data shape: (39, 64, 320, 1)\n",
      "Fold 0 training loss: 0.1380750685930252\n",
      "y_true (val): [1 0 1 0 0]\n",
      "y_pred: [1 0 1 0 0]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [177, 163, 46, 143, 13, 11, 80, 65, 56, 14, 88, 113, 15, 4, 7, 79, 41, 67, 42, 154, 74, 18, 93, 159, 111, 138, 162, 184, 99, 170, 68, 133, 36, 178, 30, 0, 48, 72, 155, 175, 19, 47, 171, 181, 86, 24, 141, 55, 137, 109, 173, 23, 34, 145, 37, 183, 185, 166, 1, 103, 28, 146, 167, 153, 102, 77, 16, 100, 27, 29, 97, 52, 176, 59, 186, 124, 182, 140, 78, 120, 101, 125, 149, 17, 81, 91, 60, 84, 110, 115, 71, 8, 33, 160, 188, 62, 26, 106, 32, 5, 187, 20, 38, 44, 165, 122, 70, 2, 104, 108, 35, 130, 189, 89, 85, 57, 43, 168, 61, 96, 158, 116, 53, 9, 114, 119, 150, 157, 87, 22, 112, 63, 151, 139, 131, 95, 180, 152, 90, 142, 107, 58, 3, 169, 10, 118, 174, 92, 161, 134, 50, 190, 164], 'val_indices': [135, 40, 148, 49, 31, 191, 105, 123, 128, 45, 75, 94, 21, 73, 54, 117, 127, 136, 39, 83, 121, 12, 172, 126, 144, 51, 6, 132, 156, 129, 69, 25, 82, 66, 179, 147, 64, 76, 98], 'accuracy': 0.8974358974358975, 'kappa': 0.7952755905511811, 'auc': 0.9789473684210527}\n",
      "New Max Found!\n",
      "Running fold 1 with 153 training samples and 39 validation samples\n",
      "Fold 1: train indices: [113 162 181  56 147], val indices: [130 176  21 111  18]\n",
      "Training data shape: (153, 64, 320, 1), Validation data shape: (39, 64, 320, 1)\n",
      "Fold 1 training loss: 0.09760107100009918\n",
      "y_true (val): [1 1 0 1 0]\n",
      "y_pred: [1 0 0 0 1]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [113, 162, 181, 56, 147, 51, 17, 126, 44, 37, 77, 46, 91, 104, 102, 20, 158, 129, 70, 116, 184, 128, 95, 35, 120, 25, 121, 145, 81, 110, 6, 163, 93, 52, 59, 185, 114, 123, 107, 174, 73, 179, 109, 10, 167, 28, 92, 71, 39, 27, 33, 175, 122, 178, 170, 132, 34, 148, 48, 98, 30, 74, 164, 65, 133, 45, 5, 4, 12, 139, 166, 173, 151, 82, 62, 142, 124, 84, 119, 118, 115, 40, 106, 75, 101, 36, 66, 186, 8, 0, 1, 160, 141, 89, 156, 29, 97, 149, 15, 26, 41, 11, 152, 177, 103, 85, 64, 23, 171, 68, 108, 136, 58, 83, 24, 146, 60, 157, 140, 99, 168, 159, 72, 189, 125, 50, 190, 9, 144, 79, 134, 55, 53, 183, 96, 188, 63, 76, 100, 49, 14, 19, 135, 69, 153, 47, 42, 117, 180, 137, 31, 43, 3], 'val_indices': [130, 176, 21, 111, 18, 87, 112, 80, 172, 54, 150, 67, 155, 61, 16, 13, 182, 131, 165, 57, 127, 94, 105, 90, 191, 22, 86, 138, 187, 7, 2, 154, 169, 143, 78, 88, 161, 38, 32], 'accuracy': 0.717948717948718, 'kappa': 0.4347826086956521, 'auc': 0.8289473684210527}\n",
      "Running fold 2 with 153 training samples and 39 validation samples\n",
      "Fold 2: train indices: [190  72  89 149  79], val indices: [  3  15  12 106  22]\n",
      "Training data shape: (153, 64, 320, 1), Validation data shape: (39, 64, 320, 1)\n",
      "Fold 2 training loss: 0.04947523772716522\n",
      "y_true (val): [0 0 0 1 0]\n",
      "y_pred: [0 0 0 1 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [190, 72, 89, 149, 79, 4, 173, 36, 135, 185, 122, 1, 27, 51, 174, 133, 37, 139, 33, 155, 109, 76, 144, 161, 80, 105, 108, 73, 43, 179, 115, 184, 58, 116, 156, 19, 66, 55, 183, 17, 95, 25, 157, 9, 120, 88, 146, 151, 143, 31, 90, 181, 112, 142, 87, 91, 145, 169, 153, 134, 56, 96, 107, 35, 104, 162, 63, 32, 124, 49, 41, 137, 165, 82, 2, 102, 118, 129, 20, 172, 132, 85, 6, 42, 10, 103, 140, 44, 64, 170, 154, 99, 39, 53, 13, 117, 77, 8, 101, 159, 57, 114, 119, 30, 11, 62, 128, 48, 67, 187, 158, 75, 141, 23, 138, 130, 97, 24, 131, 83, 147, 168, 34, 178, 60, 98, 28, 46, 0, 123, 78, 54, 94, 186, 164, 110, 191, 166, 150, 21, 16, 71, 65, 113, 167, 81, 93, 38, 86, 84, 18, 7, 14], 'val_indices': [3, 15, 12, 106, 22, 45, 68, 189, 176, 26, 136, 29, 111, 92, 163, 171, 50, 175, 188, 125, 182, 70, 152, 69, 5, 160, 126, 61, 74, 177, 121, 52, 40, 47, 100, 148, 127, 180, 59], 'accuracy': 0.8205128205128205, 'kappa': 0.6393659180977542, 'auc': 0.918421052631579}\n",
      "Running fold 3 with 153 training samples and 39 validation samples\n",
      "Fold 3: train indices: [145  75 130 115  20], val indices: [120  97  28  35 107]\n",
      "Training data shape: (153, 64, 320, 1), Validation data shape: (39, 64, 320, 1)\n",
      "Fold 3 training loss: 0.13480854034423828\n",
      "y_true (val): [1 1 0 0 1]\n",
      "y_pred: [1 1 0 1 1]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [145, 75, 130, 115, 20, 50, 22, 4, 104, 137, 153, 1, 118, 119, 185, 164, 8, 0, 29, 177, 74, 176, 19, 87, 76, 129, 44, 165, 26, 89, 24, 16, 90, 48, 162, 136, 68, 57, 139, 126, 109, 105, 9, 82, 173, 88, 144, 174, 71, 181, 128, 168, 81, 37, 112, 61, 92, 122, 95, 63, 25, 10, 189, 123, 59, 53, 62, 34, 138, 131, 56, 55, 178, 65, 77, 39, 155, 166, 160, 110, 101, 116, 106, 175, 14, 47, 11, 33, 161, 121, 100, 72, 99, 158, 134, 159, 157, 41, 146, 140, 27, 111, 135, 54, 133, 85, 182, 154, 94, 171, 70, 184, 6, 152, 142, 125, 169, 79, 147, 52, 124, 113, 180, 42, 43, 12, 18, 58, 179, 69, 64, 66, 132, 149, 83, 93, 36, 167, 143, 80, 32, 84, 127, 96, 5, 7, 98, 2, 51, 21, 191, 156, 40], 'val_indices': [120, 97, 28, 35, 107, 23, 78, 183, 46, 67, 187, 114, 188, 117, 49, 3, 102, 15, 30, 170, 141, 13, 172, 60, 150, 38, 103, 31, 86, 186, 108, 73, 148, 163, 190, 45, 17, 91, 151], 'accuracy': 0.7692307692307693, 'kappa': 0.5363276089828268, 'auc': 0.9263157894736842}\n",
      "Running fold 4 with 153 training samples and 39 validation samples\n",
      "Fold 4: train indices: [ 18 171 160  85  15], val indices: [ 34  63 156 134  73]\n",
      "Training data shape: (153, 64, 320, 1), Validation data shape: (39, 64, 320, 1)\n",
      "Fold 4 training loss: 0.08303196728229523\n",
      "y_true (val): [0 0 1 1 0]\n",
      "y_pred: [1 0 1 1 0]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [18, 171, 160, 85, 15, 167, 8, 122, 112, 93, 88, 145, 173, 11, 100, 13, 185, 17, 123, 149, 62, 177, 25, 118, 51, 153, 99, 116, 190, 53, 89, 147, 187, 133, 32, 10, 111, 9, 119, 77, 52, 79, 74, 98, 64, 67, 126, 71, 24, 41, 81, 158, 163, 159, 110, 54, 140, 170, 14, 27, 132, 12, 28, 102, 146, 60, 16, 5, 68, 56, 175, 105, 38, 19, 161, 61, 87, 58, 176, 108, 59, 1, 130, 0, 50, 152, 107, 157, 92, 80, 23, 142, 139, 84, 109, 191, 101, 106, 138, 86, 45, 21, 165, 135, 44, 181, 69, 2, 78, 4, 155, 7, 83, 180, 31, 121, 42, 162, 46, 96, 182, 150, 104, 33, 172, 125, 90, 39, 120, 128, 36, 183, 91, 188, 3, 131, 94, 103, 30, 26, 137, 141, 166, 174, 75, 65, 72, 168, 127, 169, 55, 114, 97], 'val_indices': [34, 63, 156, 134, 73, 48, 35, 29, 95, 66, 113, 70, 20, 154, 148, 49, 129, 57, 151, 186, 117, 76, 82, 143, 164, 179, 124, 144, 136, 40, 22, 6, 189, 184, 37, 178, 115, 43, 47], 'accuracy': 0.7435897435897436, 'kappa': 0.4841269841269841, 'auc': 0.8815789473684211}\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.79, 'mean_kappa': 0.578, 'mean_auc': 0.907, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [177, 163, 46, 143, 13, 11, 80, 65, 56, 14, 88, 113, 15, 4, 7, 79, 41, 67, 42, 154, 74, 18, 93, 159, 111, 138, 162, 184, 99, 170, 68, 133, 36, 178, 30, 0, 48, 72, 155, 175, 19, 47, 171, 181, 86, 24, 141, 55, 137, 109, 173, 23, 34, 145, 37, 183, 185, 166, 1, 103, 28, 146, 167, 153, 102, 77, 16, 100, 27, 29, 97, 52, 176, 59, 186, 124, 182, 140, 78, 120, 101, 125, 149, 17, 81, 91, 60, 84, 110, 115, 71, 8, 33, 160, 188, 62, 26, 106, 32, 5, 187, 20, 38, 44, 165, 122, 70, 2, 104, 108, 35, 130, 189, 89, 85, 57, 43, 168, 61, 96, 158, 116, 53, 9, 114, 119, 150, 157, 87, 22, 112, 63, 151, 139, 131, 95, 180, 152, 90, 142, 107, 58, 3, 169, 10, 118, 174, 92, 161, 134, 50, 190, 164], 'val_indices': [135, 40, 148, 49, 31, 191, 105, 123, 128, 45, 75, 94, 21, 73, 54, 117, 127, 136, 39, 83, 121, 12, 172, 126, 144, 51, 6, 132, 156, 129, 69, 25, 82, 66, 179, 147, 64, 76, 98], 'accuracy': 0.8974358974358975, 'kappa': 0.7952755905511811, 'auc': 0.9789473684210527}, {'fold_index': 1, 'train_indices': [113, 162, 181, 56, 147, 51, 17, 126, 44, 37, 77, 46, 91, 104, 102, 20, 158, 129, 70, 116, 184, 128, 95, 35, 120, 25, 121, 145, 81, 110, 6, 163, 93, 52, 59, 185, 114, 123, 107, 174, 73, 179, 109, 10, 167, 28, 92, 71, 39, 27, 33, 175, 122, 178, 170, 132, 34, 148, 48, 98, 30, 74, 164, 65, 133, 45, 5, 4, 12, 139, 166, 173, 151, 82, 62, 142, 124, 84, 119, 118, 115, 40, 106, 75, 101, 36, 66, 186, 8, 0, 1, 160, 141, 89, 156, 29, 97, 149, 15, 26, 41, 11, 152, 177, 103, 85, 64, 23, 171, 68, 108, 136, 58, 83, 24, 146, 60, 157, 140, 99, 168, 159, 72, 189, 125, 50, 190, 9, 144, 79, 134, 55, 53, 183, 96, 188, 63, 76, 100, 49, 14, 19, 135, 69, 153, 47, 42, 117, 180, 137, 31, 43, 3], 'val_indices': [130, 176, 21, 111, 18, 87, 112, 80, 172, 54, 150, 67, 155, 61, 16, 13, 182, 131, 165, 57, 127, 94, 105, 90, 191, 22, 86, 138, 187, 7, 2, 154, 169, 143, 78, 88, 161, 38, 32], 'accuracy': 0.717948717948718, 'kappa': 0.4347826086956521, 'auc': 0.8289473684210527}, {'fold_index': 2, 'train_indices': [190, 72, 89, 149, 79, 4, 173, 36, 135, 185, 122, 1, 27, 51, 174, 133, 37, 139, 33, 155, 109, 76, 144, 161, 80, 105, 108, 73, 43, 179, 115, 184, 58, 116, 156, 19, 66, 55, 183, 17, 95, 25, 157, 9, 120, 88, 146, 151, 143, 31, 90, 181, 112, 142, 87, 91, 145, 169, 153, 134, 56, 96, 107, 35, 104, 162, 63, 32, 124, 49, 41, 137, 165, 82, 2, 102, 118, 129, 20, 172, 132, 85, 6, 42, 10, 103, 140, 44, 64, 170, 154, 99, 39, 53, 13, 117, 77, 8, 101, 159, 57, 114, 119, 30, 11, 62, 128, 48, 67, 187, 158, 75, 141, 23, 138, 130, 97, 24, 131, 83, 147, 168, 34, 178, 60, 98, 28, 46, 0, 123, 78, 54, 94, 186, 164, 110, 191, 166, 150, 21, 16, 71, 65, 113, 167, 81, 93, 38, 86, 84, 18, 7, 14], 'val_indices': [3, 15, 12, 106, 22, 45, 68, 189, 176, 26, 136, 29, 111, 92, 163, 171, 50, 175, 188, 125, 182, 70, 152, 69, 5, 160, 126, 61, 74, 177, 121, 52, 40, 47, 100, 148, 127, 180, 59], 'accuracy': 0.8205128205128205, 'kappa': 0.6393659180977542, 'auc': 0.918421052631579}, {'fold_index': 3, 'train_indices': [145, 75, 130, 115, 20, 50, 22, 4, 104, 137, 153, 1, 118, 119, 185, 164, 8, 0, 29, 177, 74, 176, 19, 87, 76, 129, 44, 165, 26, 89, 24, 16, 90, 48, 162, 136, 68, 57, 139, 126, 109, 105, 9, 82, 173, 88, 144, 174, 71, 181, 128, 168, 81, 37, 112, 61, 92, 122, 95, 63, 25, 10, 189, 123, 59, 53, 62, 34, 138, 131, 56, 55, 178, 65, 77, 39, 155, 166, 160, 110, 101, 116, 106, 175, 14, 47, 11, 33, 161, 121, 100, 72, 99, 158, 134, 159, 157, 41, 146, 140, 27, 111, 135, 54, 133, 85, 182, 154, 94, 171, 70, 184, 6, 152, 142, 125, 169, 79, 147, 52, 124, 113, 180, 42, 43, 12, 18, 58, 179, 69, 64, 66, 132, 149, 83, 93, 36, 167, 143, 80, 32, 84, 127, 96, 5, 7, 98, 2, 51, 21, 191, 156, 40], 'val_indices': [120, 97, 28, 35, 107, 23, 78, 183, 46, 67, 187, 114, 188, 117, 49, 3, 102, 15, 30, 170, 141, 13, 172, 60, 150, 38, 103, 31, 86, 186, 108, 73, 148, 163, 190, 45, 17, 91, 151], 'accuracy': 0.7692307692307693, 'kappa': 0.5363276089828268, 'auc': 0.9263157894736842}, {'fold_index': 4, 'train_indices': [18, 171, 160, 85, 15, 167, 8, 122, 112, 93, 88, 145, 173, 11, 100, 13, 185, 17, 123, 149, 62, 177, 25, 118, 51, 153, 99, 116, 190, 53, 89, 147, 187, 133, 32, 10, 111, 9, 119, 77, 52, 79, 74, 98, 64, 67, 126, 71, 24, 41, 81, 158, 163, 159, 110, 54, 140, 170, 14, 27, 132, 12, 28, 102, 146, 60, 16, 5, 68, 56, 175, 105, 38, 19, 161, 61, 87, 58, 176, 108, 59, 1, 130, 0, 50, 152, 107, 157, 92, 80, 23, 142, 139, 84, 109, 191, 101, 106, 138, 86, 45, 21, 165, 135, 44, 181, 69, 2, 78, 4, 155, 7, 83, 180, 31, 121, 42, 162, 46, 96, 182, 150, 104, 33, 172, 125, 90, 39, 120, 128, 36, 183, 91, 188, 3, 131, 94, 103, 30, 26, 137, 141, 166, 174, 75, 65, 72, 168, 127, 169, 55, 114, 97], 'val_indices': [34, 63, 156, 134, 73, 48, 35, 29, 95, 66, 113, 70, 20, 154, 148, 49, 129, 57, 151, 186, 117, 76, 82, 143, 164, 179, 124, 144, 136, 40, 22, 6, 189, 184, 37, 178, 115, 43, 47], 'accuracy': 0.7435897435897436, 'kappa': 0.4841269841269841, 'auc': 0.8815789473684211}], 'std_acc': 0.064, 'std_kappa': 0.128, 'std_auc': 0.05}\n",
      "sbj =  48\n",
      "Total trials loaded: 199\n",
      "Shape of X: (199, 64, 3584), Shape of y: (199,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (199, 64, 320, 1), y_train shape: (199,)\n",
      "Running fold 0 with 159 training samples and 40 validation samples\n",
      "Fold 0: train indices: [  4 142 183  71  50], val indices: [ 25 104  31 154  83]\n",
      "Training data shape: (159, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 0 training loss: 0.05773238465189934\n",
      "y_true (val): [0 1 0 1 0]\n",
      "y_pred: [0 1 0 1 1]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [4, 142, 183, 71, 50, 179, 125, 102, 117, 60, 82, 55, 89, 21, 157, 47, 5, 42, 11, 19, 23, 172, 143, 99, 140, 34, 146, 198, 48, 147, 93, 2, 182, 138, 43, 57, 158, 187, 128, 18, 160, 33, 97, 14, 44, 177, 195, 61, 56, 174, 46, 67, 8, 101, 7, 41, 129, 131, 197, 98, 190, 74, 169, 24, 159, 173, 15, 70, 163, 58, 186, 72, 27, 87, 81, 26, 122, 96, 120, 65, 119, 193, 123, 167, 94, 130, 135, 77, 115, 175, 20, 37, 16, 0, 180, 144, 52, 145, 106, 139, 63, 9, 36, 153, 126, 17, 59, 29, 164, 30, 85, 148, 53, 79, 38, 118, 124, 192, 171, 35, 13, 151, 110, 95, 149, 136, 165, 168, 156, 88, 84, 92, 3, 121, 114, 189, 1, 10, 194, 28, 196, 103, 137, 152, 113, 112, 32, 184, 62, 78, 68, 176, 161, 22, 155, 108, 80, 181, 166], 'val_indices': [25, 104, 31, 154, 83, 86, 162, 75, 191, 105, 76, 12, 100, 178, 73, 6, 66, 54, 116, 188, 91, 51, 132, 39, 107, 40, 134, 170, 45, 109, 185, 141, 127, 150, 111, 69, 133, 90, 64, 49], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 0.9974999999999999}\n",
      "New Max Found!\n",
      "Running fold 1 with 159 training samples and 40 validation samples\n",
      "Fold 1: train indices: [ 84 185  70 103 140], val indices: [160  16  76   2 101]\n",
      "Training data shape: (159, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 1 training loss: 0.03400706127285957\n",
      "y_true (val): [1 0 0 0 1]\n",
      "y_pred: [1 0 0 0 1]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [84, 185, 70, 103, 140, 79, 4, 150, 142, 172, 11, 15, 135, 87, 154, 55, 94, 114, 86, 47, 124, 21, 56, 176, 92, 109, 39, 158, 113, 129, 19, 50, 110, 108, 184, 25, 88, 14, 60, 130, 17, 49, 153, 186, 192, 159, 107, 105, 138, 121, 194, 34, 104, 65, 12, 128, 30, 40, 38, 77, 125, 102, 141, 132, 68, 24, 71, 180, 168, 36, 27, 96, 66, 169, 81, 143, 139, 63, 99, 10, 174, 145, 5, 115, 146, 196, 122, 148, 9, 166, 155, 53, 181, 75, 52, 123, 43, 170, 59, 35, 164, 198, 93, 106, 3, 183, 33, 165, 74, 37, 1, 48, 179, 147, 126, 72, 62, 0, 162, 83, 119, 152, 23, 95, 73, 191, 44, 58, 120, 127, 157, 20, 163, 69, 189, 26, 112, 6, 134, 29, 64, 177, 187, 173, 28, 45, 193, 8, 46, 31, 116, 85, 131, 51, 32, 188, 197, 151, 42], 'val_indices': [160, 16, 76, 2, 101, 7, 182, 41, 54, 156, 117, 190, 144, 78, 167, 171, 175, 82, 118, 161, 91, 137, 149, 195, 67, 22, 57, 100, 90, 18, 80, 136, 98, 111, 89, 13, 178, 133, 97, 61], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 0.9924999999999999}\n",
      "Running fold 2 with 159 training samples and 40 validation samples\n",
      "Fold 2: train indices: [ 90  13  93 178 100], val indices: [ 33 152 153  83 171]\n",
      "Training data shape: (159, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 2 training loss: 0.04524726793169975\n",
      "y_true (val): [0 1 1 0 1]\n",
      "y_pred: [0 1 1 0 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [90, 13, 93, 178, 100, 119, 79, 138, 187, 72, 3, 148, 32, 174, 196, 127, 172, 192, 147, 22, 102, 16, 130, 134, 81, 92, 84, 70, 26, 89, 99, 85, 181, 125, 86, 98, 82, 165, 40, 53, 46, 179, 69, 59, 176, 63, 109, 105, 106, 78, 197, 177, 185, 143, 113, 164, 123, 67, 74, 144, 52, 96, 122, 75, 37, 108, 167, 115, 142, 1, 107, 166, 175, 49, 118, 188, 169, 30, 145, 155, 39, 77, 94, 87, 38, 41, 80, 17, 182, 0, 162, 146, 161, 190, 173, 103, 66, 95, 55, 68, 111, 137, 15, 44, 136, 198, 64, 4, 124, 20, 43, 195, 42, 160, 51, 168, 73, 157, 151, 31, 189, 36, 19, 141, 154, 121, 193, 24, 135, 58, 14, 34, 2, 7, 194, 131, 129, 23, 156, 184, 71, 65, 28, 91, 158, 110, 117, 35, 10, 126, 25, 97, 101, 128, 11, 60, 56, 27, 133], 'val_indices': [33, 152, 153, 83, 171, 5, 170, 21, 12, 29, 180, 6, 150, 9, 48, 183, 54, 120, 159, 114, 116, 186, 8, 149, 61, 50, 88, 139, 104, 45, 47, 132, 112, 76, 62, 163, 18, 140, 191, 57], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 1.0}\n",
      "Running fold 3 with 159 training samples and 40 validation samples\n",
      "Fold 3: train indices: [ 40  48  69 131   8], val indices: [182 152  97  27 114]\n",
      "Training data shape: (159, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 3 training loss: 0.07731417566537857\n",
      "y_true (val): [1 1 0 0 1]\n",
      "y_pred: [1 0 0 0 1]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [40, 48, 69, 131, 8, 44, 60, 103, 127, 125, 74, 148, 123, 165, 29, 135, 34, 38, 22, 132, 72, 45, 128, 140, 185, 149, 66, 172, 28, 73, 92, 154, 96, 23, 157, 171, 91, 32, 33, 43, 25, 175, 4, 167, 37, 145, 113, 168, 1, 180, 21, 111, 52, 178, 198, 68, 153, 136, 12, 139, 53, 49, 141, 35, 142, 15, 50, 54, 160, 159, 101, 7, 197, 0, 89, 55, 56, 10, 98, 122, 106, 191, 158, 138, 176, 63, 88, 83, 117, 130, 81, 65, 61, 108, 78, 26, 47, 104, 9, 196, 170, 31, 94, 71, 77, 18, 187, 166, 75, 162, 150, 86, 85, 183, 173, 3, 84, 181, 190, 82, 95, 174, 100, 107, 133, 179, 24, 76, 41, 62, 134, 6, 143, 112, 121, 30, 11, 99, 177, 93, 87, 13, 120, 109, 189, 186, 118, 110, 161, 164, 137, 194, 126, 16, 59, 119, 151, 17, 146], 'val_indices': [182, 152, 97, 27, 114, 155, 124, 14, 169, 195, 36, 102, 129, 79, 39, 105, 5, 80, 193, 144, 46, 192, 57, 58, 184, 90, 116, 64, 70, 19, 20, 2, 51, 42, 115, 67, 156, 147, 163, 188], 'accuracy': 0.95, 'kappa': 0.9, 'auc': 0.98}\n",
      "Running fold 4 with 159 training samples and 40 validation samples\n",
      "Fold 4: train indices: [178  87 170 167  99], val indices: [ 56 132   5  40 169]\n",
      "Training data shape: (159, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 4 training loss: 0.059548210352659225\n",
      "y_true (val): [0 1 0 0 1]\n",
      "y_pred: [0 1 0 0 1]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [178, 87, 170, 167, 99, 118, 115, 44, 26, 151, 190, 28, 64, 30, 135, 54, 176, 157, 155, 165, 67, 174, 55, 73, 77, 143, 36, 85, 100, 131, 195, 82, 145, 122, 198, 13, 149, 83, 126, 153, 71, 6, 161, 189, 12, 4, 39, 95, 80, 105, 112, 116, 163, 57, 187, 137, 171, 140, 47, 107, 111, 14, 91, 45, 98, 10, 60, 50, 181, 25, 101, 76, 58, 173, 53, 130, 127, 183, 89, 103, 22, 110, 34, 119, 70, 186, 37, 75, 184, 27, 102, 177, 129, 90, 74, 154, 104, 117, 156, 20, 86, 144, 9, 191, 136, 158, 66, 175, 49, 114, 48, 162, 96, 8, 69, 63, 125, 188, 52, 31, 168, 11, 46, 61, 38, 196, 84, 59, 15, 88, 18, 68, 141, 159, 150, 0, 3, 35, 133, 97, 147, 21, 185, 109, 23, 51, 192, 121, 72, 160, 148, 16, 94, 193, 179, 7, 138, 24, 182], 'val_indices': [56, 132, 5, 40, 169, 142, 17, 1, 19, 42, 65, 180, 32, 139, 41, 128, 79, 106, 134, 62, 166, 93, 92, 120, 194, 108, 33, 146, 124, 123, 78, 29, 43, 197, 152, 164, 113, 2, 81, 172], 'accuracy': 0.925, 'kappa': 0.85, 'auc': 0.9824999999999999}\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.96, 'mean_kappa': 0.92, 'mean_auc': 0.99, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [4, 142, 183, 71, 50, 179, 125, 102, 117, 60, 82, 55, 89, 21, 157, 47, 5, 42, 11, 19, 23, 172, 143, 99, 140, 34, 146, 198, 48, 147, 93, 2, 182, 138, 43, 57, 158, 187, 128, 18, 160, 33, 97, 14, 44, 177, 195, 61, 56, 174, 46, 67, 8, 101, 7, 41, 129, 131, 197, 98, 190, 74, 169, 24, 159, 173, 15, 70, 163, 58, 186, 72, 27, 87, 81, 26, 122, 96, 120, 65, 119, 193, 123, 167, 94, 130, 135, 77, 115, 175, 20, 37, 16, 0, 180, 144, 52, 145, 106, 139, 63, 9, 36, 153, 126, 17, 59, 29, 164, 30, 85, 148, 53, 79, 38, 118, 124, 192, 171, 35, 13, 151, 110, 95, 149, 136, 165, 168, 156, 88, 84, 92, 3, 121, 114, 189, 1, 10, 194, 28, 196, 103, 137, 152, 113, 112, 32, 184, 62, 78, 68, 176, 161, 22, 155, 108, 80, 181, 166], 'val_indices': [25, 104, 31, 154, 83, 86, 162, 75, 191, 105, 76, 12, 100, 178, 73, 6, 66, 54, 116, 188, 91, 51, 132, 39, 107, 40, 134, 170, 45, 109, 185, 141, 127, 150, 111, 69, 133, 90, 64, 49], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 0.9974999999999999}, {'fold_index': 1, 'train_indices': [84, 185, 70, 103, 140, 79, 4, 150, 142, 172, 11, 15, 135, 87, 154, 55, 94, 114, 86, 47, 124, 21, 56, 176, 92, 109, 39, 158, 113, 129, 19, 50, 110, 108, 184, 25, 88, 14, 60, 130, 17, 49, 153, 186, 192, 159, 107, 105, 138, 121, 194, 34, 104, 65, 12, 128, 30, 40, 38, 77, 125, 102, 141, 132, 68, 24, 71, 180, 168, 36, 27, 96, 66, 169, 81, 143, 139, 63, 99, 10, 174, 145, 5, 115, 146, 196, 122, 148, 9, 166, 155, 53, 181, 75, 52, 123, 43, 170, 59, 35, 164, 198, 93, 106, 3, 183, 33, 165, 74, 37, 1, 48, 179, 147, 126, 72, 62, 0, 162, 83, 119, 152, 23, 95, 73, 191, 44, 58, 120, 127, 157, 20, 163, 69, 189, 26, 112, 6, 134, 29, 64, 177, 187, 173, 28, 45, 193, 8, 46, 31, 116, 85, 131, 51, 32, 188, 197, 151, 42], 'val_indices': [160, 16, 76, 2, 101, 7, 182, 41, 54, 156, 117, 190, 144, 78, 167, 171, 175, 82, 118, 161, 91, 137, 149, 195, 67, 22, 57, 100, 90, 18, 80, 136, 98, 111, 89, 13, 178, 133, 97, 61], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 0.9924999999999999}, {'fold_index': 2, 'train_indices': [90, 13, 93, 178, 100, 119, 79, 138, 187, 72, 3, 148, 32, 174, 196, 127, 172, 192, 147, 22, 102, 16, 130, 134, 81, 92, 84, 70, 26, 89, 99, 85, 181, 125, 86, 98, 82, 165, 40, 53, 46, 179, 69, 59, 176, 63, 109, 105, 106, 78, 197, 177, 185, 143, 113, 164, 123, 67, 74, 144, 52, 96, 122, 75, 37, 108, 167, 115, 142, 1, 107, 166, 175, 49, 118, 188, 169, 30, 145, 155, 39, 77, 94, 87, 38, 41, 80, 17, 182, 0, 162, 146, 161, 190, 173, 103, 66, 95, 55, 68, 111, 137, 15, 44, 136, 198, 64, 4, 124, 20, 43, 195, 42, 160, 51, 168, 73, 157, 151, 31, 189, 36, 19, 141, 154, 121, 193, 24, 135, 58, 14, 34, 2, 7, 194, 131, 129, 23, 156, 184, 71, 65, 28, 91, 158, 110, 117, 35, 10, 126, 25, 97, 101, 128, 11, 60, 56, 27, 133], 'val_indices': [33, 152, 153, 83, 171, 5, 170, 21, 12, 29, 180, 6, 150, 9, 48, 183, 54, 120, 159, 114, 116, 186, 8, 149, 61, 50, 88, 139, 104, 45, 47, 132, 112, 76, 62, 163, 18, 140, 191, 57], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 1.0}, {'fold_index': 3, 'train_indices': [40, 48, 69, 131, 8, 44, 60, 103, 127, 125, 74, 148, 123, 165, 29, 135, 34, 38, 22, 132, 72, 45, 128, 140, 185, 149, 66, 172, 28, 73, 92, 154, 96, 23, 157, 171, 91, 32, 33, 43, 25, 175, 4, 167, 37, 145, 113, 168, 1, 180, 21, 111, 52, 178, 198, 68, 153, 136, 12, 139, 53, 49, 141, 35, 142, 15, 50, 54, 160, 159, 101, 7, 197, 0, 89, 55, 56, 10, 98, 122, 106, 191, 158, 138, 176, 63, 88, 83, 117, 130, 81, 65, 61, 108, 78, 26, 47, 104, 9, 196, 170, 31, 94, 71, 77, 18, 187, 166, 75, 162, 150, 86, 85, 183, 173, 3, 84, 181, 190, 82, 95, 174, 100, 107, 133, 179, 24, 76, 41, 62, 134, 6, 143, 112, 121, 30, 11, 99, 177, 93, 87, 13, 120, 109, 189, 186, 118, 110, 161, 164, 137, 194, 126, 16, 59, 119, 151, 17, 146], 'val_indices': [182, 152, 97, 27, 114, 155, 124, 14, 169, 195, 36, 102, 129, 79, 39, 105, 5, 80, 193, 144, 46, 192, 57, 58, 184, 90, 116, 64, 70, 19, 20, 2, 51, 42, 115, 67, 156, 147, 163, 188], 'accuracy': 0.95, 'kappa': 0.9, 'auc': 0.98}, {'fold_index': 4, 'train_indices': [178, 87, 170, 167, 99, 118, 115, 44, 26, 151, 190, 28, 64, 30, 135, 54, 176, 157, 155, 165, 67, 174, 55, 73, 77, 143, 36, 85, 100, 131, 195, 82, 145, 122, 198, 13, 149, 83, 126, 153, 71, 6, 161, 189, 12, 4, 39, 95, 80, 105, 112, 116, 163, 57, 187, 137, 171, 140, 47, 107, 111, 14, 91, 45, 98, 10, 60, 50, 181, 25, 101, 76, 58, 173, 53, 130, 127, 183, 89, 103, 22, 110, 34, 119, 70, 186, 37, 75, 184, 27, 102, 177, 129, 90, 74, 154, 104, 117, 156, 20, 86, 144, 9, 191, 136, 158, 66, 175, 49, 114, 48, 162, 96, 8, 69, 63, 125, 188, 52, 31, 168, 11, 46, 61, 38, 196, 84, 59, 15, 88, 18, 68, 141, 159, 150, 0, 3, 35, 133, 97, 147, 21, 185, 109, 23, 51, 192, 121, 72, 160, 148, 16, 94, 193, 179, 7, 138, 24, 182], 'val_indices': [56, 132, 5, 40, 169, 142, 17, 1, 19, 42, 65, 180, 32, 139, 41, 128, 79, 106, 134, 62, 166, 93, 92, 120, 194, 108, 33, 146, 124, 123, 78, 29, 43, 197, 152, 164, 113, 2, 81, 172], 'accuracy': 0.925, 'kappa': 0.85, 'auc': 0.9824999999999999}], 'std_acc': 0.02, 'std_kappa': 0.04, 'std_auc': 0.008}\n",
      "sbj =  50\n",
      "Total trials loaded: 200\n",
      "Shape of X: (200, 64, 3584), Shape of y: (200,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (200, 64, 320, 1), y_train shape: (200,)\n",
      "Running fold 0 with 160 training samples and 40 validation samples\n",
      "Fold 0: train indices: [  4 142 183  71  50], val indices: [ 25 107  31 188  83]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 0 training loss: 0.03623785823583603\n",
      "y_true (val): [0 1 0 1 0]\n",
      "y_pred: [0 1 0 1 0]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [4, 142, 183, 71, 50, 179, 125, 131, 117, 60, 82, 55, 89, 21, 157, 47, 5, 42, 11, 19, 23, 172, 148, 99, 140, 34, 146, 115, 48, 147, 93, 2, 182, 138, 43, 57, 158, 187, 128, 18, 160, 33, 97, 14, 44, 177, 196, 61, 56, 174, 46, 67, 8, 101, 7, 41, 129, 184, 198, 98, 190, 74, 169, 24, 159, 173, 15, 70, 163, 58, 186, 72, 27, 87, 81, 26, 122, 96, 120, 65, 119, 102, 123, 167, 94, 130, 135, 77, 192, 175, 20, 37, 16, 0, 180, 144, 52, 145, 106, 139, 63, 9, 36, 153, 126, 17, 59, 29, 164, 30, 85, 156, 53, 79, 38, 118, 124, 193, 171, 35, 13, 151, 110, 95, 149, 136, 165, 168, 109, 88, 84, 92, 3, 121, 114, 143, 1, 10, 195, 28, 197, 103, 137, 152, 113, 112, 32, 189, 62, 199, 78, 68, 176, 161, 22, 155, 108, 80, 181, 166], 'val_indices': [25, 107, 31, 188, 83, 86, 111, 75, 191, 170, 76, 12, 100, 154, 73, 6, 66, 54, 104, 162, 91, 51, 132, 39, 105, 40, 134, 141, 45, 116, 185, 178, 127, 150, 194, 69, 133, 90, 64, 49], 'accuracy': 1.0, 'kappa': 1.0, 'auc': 1.0}\n",
      "New Max Found!\n",
      "Running fold 1 with 160 training samples and 40 validation samples\n",
      "Fold 1: train indices: [162  56 128 110  84], val indices: [175 156   7 191  76]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 1 training loss: 0.017210667952895164\n",
      "y_true (val): [1 1 0 1 0]\n",
      "y_pred: [1 1 0 1 0]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [162, 56, 128, 110, 84, 70, 139, 147, 115, 155, 50, 165, 142, 109, 159, 194, 60, 15, 140, 195, 55, 86, 87, 130, 38, 79, 177, 92, 145, 47, 39, 135, 94, 197, 164, 104, 108, 88, 14, 21, 154, 17, 49, 11, 187, 114, 181, 158, 19, 77, 185, 123, 34, 25, 4, 12, 65, 30, 40, 129, 81, 189, 102, 141, 170, 68, 24, 71, 132, 107, 36, 27, 96, 66, 138, 63, 193, 113, 124, 99, 10, 150, 103, 5, 143, 146, 153, 122, 148, 9, 183, 105, 53, 166, 75, 52, 169, 43, 188, 59, 35, 186, 199, 93, 106, 3, 184, 33, 125, 74, 37, 1, 48, 180, 126, 121, 72, 62, 0, 173, 83, 119, 152, 23, 95, 73, 179, 44, 58, 120, 127, 157, 20, 163, 69, 190, 26, 112, 6, 134, 29, 64, 192, 172, 174, 28, 45, 168, 8, 46, 31, 116, 85, 131, 51, 32, 176, 198, 151, 42], 'val_indices': [175, 156, 7, 191, 76, 117, 54, 16, 2, 80, 41, 118, 78, 90, 100, 160, 149, 161, 171, 18, 82, 182, 101, 61, 91, 167, 144, 133, 196, 67, 22, 57, 137, 136, 98, 111, 89, 13, 178, 97], 'accuracy': 0.95, 'kappa': 0.9, 'auc': 0.995}\n",
      "Running fold 2 with 160 training samples and 40 validation samples\n",
      "Fold 2: train indices: [  3 109 165  70  15], val indices: [ 58 152 153  54 171]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 2 training loss: 0.04317643120884895\n",
      "y_true (val): [0 1 1 0 1]\n",
      "y_pred: [0 1 1 0 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [3, 109, 165, 70, 15, 172, 19, 5, 38, 146, 77, 11, 147, 198, 92, 18, 174, 2, 176, 168, 118, 199, 63, 100, 158, 17, 134, 86, 105, 24, 34, 175, 61, 166, 125, 97, 39, 108, 78, 79, 80, 31, 46, 180, 60, 113, 127, 87, 186, 144, 124, 67, 13, 136, 74, 65, 115, 167, 123, 72, 191, 182, 82, 23, 110, 40, 119, 183, 148, 128, 143, 85, 142, 107, 189, 30, 130, 145, 103, 96, 164, 151, 98, 64, 101, 43, 81, 49, 75, 69, 89, 106, 66, 162, 154, 161, 122, 188, 121, 10, 20, 91, 52, 111, 137, 57, 93, 178, 102, 138, 55, 47, 133, 42, 12, 196, 99, 177, 44, 169, 37, 193, 157, 1, 190, 0, 26, 141, 155, 173, 28, 27, 16, 32, 7, 195, 131, 197, 14, 156, 185, 36, 95, 71, 51, 160, 194, 117, 56, 68, 126, 41, 59, 135, 129, 4, 53, 90, 94, 179], 'val_indices': [58, 152, 153, 54, 171, 88, 170, 45, 21, 84, 181, 73, 150, 22, 29, 184, 25, 120, 159, 114, 116, 187, 6, 149, 83, 33, 50, 139, 104, 9, 48, 132, 112, 35, 76, 163, 8, 140, 192, 62], 'accuracy': 0.95, 'kappa': 0.9, 'auc': 0.995}\n",
      "Running fold 3 with 160 training samples and 40 validation samples\n",
      "Fold 3: train indices: [66 43 45 22 69], val indices: [ 20  14 169 144 196]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 3 training loss: 0.04647992178797722\n",
      "y_true (val): [0 0 1 1 1]\n",
      "y_pred: [0 0 1 1 1]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [66, 43, 45, 22, 69, 48, 44, 60, 123, 74, 179, 25, 150, 171, 132, 28, 165, 96, 73, 113, 127, 72, 135, 52, 38, 23, 122, 100, 177, 92, 137, 148, 12, 8, 91, 159, 172, 125, 187, 32, 29, 173, 40, 108, 4, 151, 37, 186, 34, 21, 1, 33, 190, 176, 35, 146, 143, 68, 160, 136, 107, 103, 53, 49, 141, 131, 15, 50, 54, 199, 126, 154, 7, 193, 0, 89, 55, 56, 10, 98, 134, 106, 161, 168, 138, 112, 63, 88, 83, 174, 121, 81, 65, 61, 109, 78, 26, 47, 104, 9, 153, 180, 31, 94, 71, 77, 18, 195, 167, 75, 164, 162, 86, 85, 157, 119, 3, 84, 149, 142, 82, 95, 175, 191, 139, 133, 117, 24, 76, 41, 62, 198, 6, 111, 183, 110, 30, 11, 99, 178, 93, 87, 13, 166, 189, 170, 185, 118, 130, 197, 120, 128, 158, 140, 16, 59, 145, 101, 17, 181], 'val_indices': [20, 14, 169, 144, 196, 105, 67, 182, 36, 39, 97, 57, 64, 58, 79, 90, 188, 194, 155, 129, 102, 192, 27, 5, 124, 116, 80, 184, 152, 163, 46, 156, 114, 147, 115, 70, 19, 2, 51, 42], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 0.9924999999999999}\n",
      "Running fold 4 with 160 training samples and 40 validation samples\n",
      "Fold 4: train indices: [ 52   4 194  64  46], val indices: [123  35  89 183   0]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 4 training loss: 0.03568584471940994\n",
      "y_true (val): [1 0 0 1 0]\n",
      "y_pred: [1 0 0 0 0]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [52, 4, 194, 64, 46, 59, 38, 21, 193, 157, 28, 57, 17, 154, 184, 97, 139, 125, 102, 182, 30, 143, 180, 50, 126, 13, 161, 100, 15, 135, 45, 74, 153, 51, 115, 189, 181, 187, 37, 133, 118, 168, 16, 136, 66, 73, 19, 174, 22, 24, 71, 192, 63, 144, 122, 72, 54, 175, 147, 155, 85, 107, 149, 103, 69, 31, 27, 145, 7, 84, 77, 191, 88, 79, 114, 49, 90, 124, 5, 111, 36, 172, 131, 61, 32, 185, 173, 2, 166, 39, 148, 110, 34, 199, 65, 186, 23, 91, 159, 170, 93, 119, 195, 116, 129, 76, 53, 158, 101, 130, 178, 156, 6, 94, 138, 167, 96, 68, 132, 165, 92, 140, 12, 137, 44, 188, 160, 83, 47, 60, 98, 81, 105, 78, 58, 11, 25, 26, 82, 141, 171, 196, 62, 48, 1, 177, 70, 121, 8, 163, 109, 95, 104, 43, 117, 150, 14, 197, 127, 33], 'val_indices': [123, 35, 89, 183, 0, 80, 75, 134, 10, 87, 120, 40, 151, 67, 86, 99, 152, 42, 20, 176, 162, 169, 41, 190, 56, 9, 142, 146, 112, 108, 3, 128, 198, 106, 55, 29, 18, 164, 113, 179], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 0.9875}\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.97, 'mean_kappa': 0.94, 'mean_auc': 0.994, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [4, 142, 183, 71, 50, 179, 125, 131, 117, 60, 82, 55, 89, 21, 157, 47, 5, 42, 11, 19, 23, 172, 148, 99, 140, 34, 146, 115, 48, 147, 93, 2, 182, 138, 43, 57, 158, 187, 128, 18, 160, 33, 97, 14, 44, 177, 196, 61, 56, 174, 46, 67, 8, 101, 7, 41, 129, 184, 198, 98, 190, 74, 169, 24, 159, 173, 15, 70, 163, 58, 186, 72, 27, 87, 81, 26, 122, 96, 120, 65, 119, 102, 123, 167, 94, 130, 135, 77, 192, 175, 20, 37, 16, 0, 180, 144, 52, 145, 106, 139, 63, 9, 36, 153, 126, 17, 59, 29, 164, 30, 85, 156, 53, 79, 38, 118, 124, 193, 171, 35, 13, 151, 110, 95, 149, 136, 165, 168, 109, 88, 84, 92, 3, 121, 114, 143, 1, 10, 195, 28, 197, 103, 137, 152, 113, 112, 32, 189, 62, 199, 78, 68, 176, 161, 22, 155, 108, 80, 181, 166], 'val_indices': [25, 107, 31, 188, 83, 86, 111, 75, 191, 170, 76, 12, 100, 154, 73, 6, 66, 54, 104, 162, 91, 51, 132, 39, 105, 40, 134, 141, 45, 116, 185, 178, 127, 150, 194, 69, 133, 90, 64, 49], 'accuracy': 1.0, 'kappa': 1.0, 'auc': 1.0}, {'fold_index': 1, 'train_indices': [162, 56, 128, 110, 84, 70, 139, 147, 115, 155, 50, 165, 142, 109, 159, 194, 60, 15, 140, 195, 55, 86, 87, 130, 38, 79, 177, 92, 145, 47, 39, 135, 94, 197, 164, 104, 108, 88, 14, 21, 154, 17, 49, 11, 187, 114, 181, 158, 19, 77, 185, 123, 34, 25, 4, 12, 65, 30, 40, 129, 81, 189, 102, 141, 170, 68, 24, 71, 132, 107, 36, 27, 96, 66, 138, 63, 193, 113, 124, 99, 10, 150, 103, 5, 143, 146, 153, 122, 148, 9, 183, 105, 53, 166, 75, 52, 169, 43, 188, 59, 35, 186, 199, 93, 106, 3, 184, 33, 125, 74, 37, 1, 48, 180, 126, 121, 72, 62, 0, 173, 83, 119, 152, 23, 95, 73, 179, 44, 58, 120, 127, 157, 20, 163, 69, 190, 26, 112, 6, 134, 29, 64, 192, 172, 174, 28, 45, 168, 8, 46, 31, 116, 85, 131, 51, 32, 176, 198, 151, 42], 'val_indices': [175, 156, 7, 191, 76, 117, 54, 16, 2, 80, 41, 118, 78, 90, 100, 160, 149, 161, 171, 18, 82, 182, 101, 61, 91, 167, 144, 133, 196, 67, 22, 57, 137, 136, 98, 111, 89, 13, 178, 97], 'accuracy': 0.95, 'kappa': 0.9, 'auc': 0.995}, {'fold_index': 2, 'train_indices': [3, 109, 165, 70, 15, 172, 19, 5, 38, 146, 77, 11, 147, 198, 92, 18, 174, 2, 176, 168, 118, 199, 63, 100, 158, 17, 134, 86, 105, 24, 34, 175, 61, 166, 125, 97, 39, 108, 78, 79, 80, 31, 46, 180, 60, 113, 127, 87, 186, 144, 124, 67, 13, 136, 74, 65, 115, 167, 123, 72, 191, 182, 82, 23, 110, 40, 119, 183, 148, 128, 143, 85, 142, 107, 189, 30, 130, 145, 103, 96, 164, 151, 98, 64, 101, 43, 81, 49, 75, 69, 89, 106, 66, 162, 154, 161, 122, 188, 121, 10, 20, 91, 52, 111, 137, 57, 93, 178, 102, 138, 55, 47, 133, 42, 12, 196, 99, 177, 44, 169, 37, 193, 157, 1, 190, 0, 26, 141, 155, 173, 28, 27, 16, 32, 7, 195, 131, 197, 14, 156, 185, 36, 95, 71, 51, 160, 194, 117, 56, 68, 126, 41, 59, 135, 129, 4, 53, 90, 94, 179], 'val_indices': [58, 152, 153, 54, 171, 88, 170, 45, 21, 84, 181, 73, 150, 22, 29, 184, 25, 120, 159, 114, 116, 187, 6, 149, 83, 33, 50, 139, 104, 9, 48, 132, 112, 35, 76, 163, 8, 140, 192, 62], 'accuracy': 0.95, 'kappa': 0.9, 'auc': 0.995}, {'fold_index': 3, 'train_indices': [66, 43, 45, 22, 69, 48, 44, 60, 123, 74, 179, 25, 150, 171, 132, 28, 165, 96, 73, 113, 127, 72, 135, 52, 38, 23, 122, 100, 177, 92, 137, 148, 12, 8, 91, 159, 172, 125, 187, 32, 29, 173, 40, 108, 4, 151, 37, 186, 34, 21, 1, 33, 190, 176, 35, 146, 143, 68, 160, 136, 107, 103, 53, 49, 141, 131, 15, 50, 54, 199, 126, 154, 7, 193, 0, 89, 55, 56, 10, 98, 134, 106, 161, 168, 138, 112, 63, 88, 83, 174, 121, 81, 65, 61, 109, 78, 26, 47, 104, 9, 153, 180, 31, 94, 71, 77, 18, 195, 167, 75, 164, 162, 86, 85, 157, 119, 3, 84, 149, 142, 82, 95, 175, 191, 139, 133, 117, 24, 76, 41, 62, 198, 6, 111, 183, 110, 30, 11, 99, 178, 93, 87, 13, 166, 189, 170, 185, 118, 130, 197, 120, 128, 158, 140, 16, 59, 145, 101, 17, 181], 'val_indices': [20, 14, 169, 144, 196, 105, 67, 182, 36, 39, 97, 57, 64, 58, 79, 90, 188, 194, 155, 129, 102, 192, 27, 5, 124, 116, 80, 184, 152, 163, 46, 156, 114, 147, 115, 70, 19, 2, 51, 42], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 0.9924999999999999}, {'fold_index': 4, 'train_indices': [52, 4, 194, 64, 46, 59, 38, 21, 193, 157, 28, 57, 17, 154, 184, 97, 139, 125, 102, 182, 30, 143, 180, 50, 126, 13, 161, 100, 15, 135, 45, 74, 153, 51, 115, 189, 181, 187, 37, 133, 118, 168, 16, 136, 66, 73, 19, 174, 22, 24, 71, 192, 63, 144, 122, 72, 54, 175, 147, 155, 85, 107, 149, 103, 69, 31, 27, 145, 7, 84, 77, 191, 88, 79, 114, 49, 90, 124, 5, 111, 36, 172, 131, 61, 32, 185, 173, 2, 166, 39, 148, 110, 34, 199, 65, 186, 23, 91, 159, 170, 93, 119, 195, 116, 129, 76, 53, 158, 101, 130, 178, 156, 6, 94, 138, 167, 96, 68, 132, 165, 92, 140, 12, 137, 44, 188, 160, 83, 47, 60, 98, 81, 105, 78, 58, 11, 25, 26, 82, 141, 171, 196, 62, 48, 1, 177, 70, 121, 8, 163, 109, 95, 104, 43, 117, 150, 14, 197, 127, 33], 'val_indices': [123, 35, 89, 183, 0, 80, 75, 134, 10, 87, 120, 40, 151, 67, 86, 99, 152, 42, 20, 176, 162, 169, 41, 190, 56, 9, 142, 146, 112, 108, 3, 128, 198, 106, 55, 29, 18, 164, 113, 179], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 0.9875}], 'std_acc': 0.019, 'std_kappa': 0.037, 'std_auc': 0.004}\n",
      "sbj =  51\n",
      "Total trials loaded: 194\n",
      "Shape of X: (194, 64, 3584), Shape of y: (194,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (194, 64, 320, 1), y_train shape: (194,)\n",
      "Running fold 0 with 155 training samples and 39 validation samples\n",
      "Fold 0: train indices: [179 134  84 162  63], val indices: [ 83  73 152  49  76]\n",
      "Training data shape: (155, 64, 320, 1), Validation data shape: (39, 64, 320, 1)\n",
      "Fold 0 training loss: 0.26354673504829407\n",
      "y_true (val): [0 0 1 0 0]\n",
      "y_pred: [1 0 1 1 0]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [179, 134, 84, 162, 63, 55, 95, 37, 20, 0, 79, 156, 1, 4, 47, 87, 19, 58, 56, 157, 61, 71, 77, 111, 103, 181, 145, 115, 144, 62, 72, 48, 43, 172, 14, 78, 57, 23, 159, 112, 90, 82, 167, 192, 2, 28, 114, 18, 141, 122, 182, 27, 42, 177, 96, 185, 163, 155, 81, 107, 26, 173, 180, 188, 128, 97, 67, 190, 74, 24, 101, 22, 184, 36, 106, 126, 147, 110, 92, 138, 168, 129, 169, 17, 50, 46, 38, 178, 52, 113, 119, 7, 8, 15, 186, 118, 33, 29, 137, 13, 5, 187, 11, 93, 35, 189, 153, 175, 94, 10, 117, 171, 32, 158, 150, 191, 30, 34, 59, 70, 135, 80, 100, 161, 120, 86, 9, 104, 123, 154, 65, 60, 174, 68, 166, 142, 108, 170, 149, 143, 89, 146, 41, 16, 3, 124, 44, 164, 116, 53, 176, 99, 88, 165, 105], 'val_indices': [83, 73, 152, 49, 76, 193, 109, 127, 132, 45, 75, 98, 21, 54, 31, 121, 131, 140, 39, 40, 125, 12, 139, 130, 148, 51, 6, 136, 160, 133, 69, 25, 85, 66, 183, 151, 64, 91, 102], 'accuracy': 0.5384615384615384, 'kappa': 0.07631578947368411, 'auc': 0.5447368421052631}\n",
      "New Max Found!\n",
      "Running fold 1 with 155 training samples and 39 validation samples\n",
      "Fold 1: train indices: [ 73 110 102  17  58], val indices: [ 86 180   7 115  18]\n",
      "Training data shape: (155, 64, 320, 1), Validation data shape: (39, 64, 320, 1)\n",
      "Fold 1 training loss: 0.19974908232688904\n",
      "y_true (val): [0 1 0 1 0]\n",
      "y_pred: [1 0 0 1 1]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [73, 110, 102, 17, 58, 85, 105, 160, 112, 37, 46, 162, 156, 123, 33, 44, 122, 95, 138, 20, 192, 191, 63, 186, 163, 59, 69, 167, 6, 96, 101, 168, 53, 88, 183, 133, 177, 118, 51, 128, 166, 97, 10, 119, 161, 71, 39, 27, 65, 24, 152, 178, 140, 149, 34, 175, 48, 35, 30, 77, 111, 68, 127, 45, 5, 12, 146, 126, 164, 99, 64, 143, 179, 87, 151, 153, 41, 40, 172, 47, 125, 36, 70, 170, 8, 0, 4, 132, 145, 28, 190, 29, 83, 188, 15, 26, 76, 11, 120, 155, 106, 66, 25, 23, 182, 75, 121, 100, 60, 50, 84, 137, 55, 171, 117, 144, 129, 124, 107, 174, 148, 89, 104, 9, 103, 185, 81, 141, 82, 136, 56, 62, 139, 187, 108, 93, 79, 157, 49, 14, 19, 150, 72, 181, 52, 42, 130, 114, 113, 31, 43, 134, 1, 74, 3], 'val_indices': [86, 180, 7, 115, 18, 92, 116, 80, 176, 54, 154, 67, 159, 61, 16, 13, 184, 135, 169, 57, 131, 98, 109, 94, 193, 22, 32, 142, 189, 38, 2, 158, 173, 147, 78, 91, 165, 90, 21], 'accuracy': 0.6410256410256411, 'kappa': 0.28157894736842104, 'auc': 0.6789473684210526}\n",
      "New Max Found!\n",
      "Running fold 2 with 155 training samples and 39 validation samples\n",
      "Fold 2: train indices: [  4  65  90  83 158], val indices: [12 70 26 29 45]\n",
      "Training data shape: (155, 64, 320, 1), Validation data shape: (39, 64, 320, 1)\n",
      "Fold 2 training loss: 0.20385167002677917\n",
      "y_true (val): [0 0 0 0 0]\n",
      "y_pred: [0 1 0 0 0]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [4, 65, 90, 83, 158, 27, 75, 31, 91, 188, 71, 151, 166, 120, 150, 183, 35, 14, 28, 124, 143, 99, 165, 153, 142, 135, 37, 98, 177, 191, 55, 145, 137, 170, 168, 169, 92, 41, 116, 173, 100, 97, 43, 138, 7, 76, 54, 36, 163, 33, 131, 49, 187, 126, 148, 42, 30, 51, 162, 136, 139, 159, 16, 32, 147, 118, 189, 172, 157, 121, 39, 23, 190, 10, 44, 127, 123, 88, 111, 133, 0, 141, 171, 149, 19, 155, 146, 95, 25, 79, 2, 122, 101, 58, 13, 18, 160, 134, 73, 72, 77, 119, 11, 93, 21, 113, 48, 161, 176, 17, 85, 89, 104, 82, 80, 154, 38, 60, 117, 20, 178, 103, 57, 64, 112, 63, 107, 182, 78, 66, 86, 132, 94, 9, 105, 128, 109, 108, 114, 102, 144, 8, 24, 53, 81, 174, 185, 67, 84, 56, 1, 6, 62, 34, 46], 'val_indices': [12, 70, 26, 29, 45, 52, 186, 156, 184, 125, 68, 3, 15, 87, 130, 115, 61, 22, 181, 192, 179, 110, 106, 193, 50, 180, 47, 164, 40, 167, 175, 152, 59, 69, 74, 96, 5, 129, 140], 'accuracy': 0.5641025641025641, 'kappa': 0.13333333333333341, 'auc': 0.5894736842105263}\n",
      "Running fold 3 with 155 training samples and 39 validation samples\n",
      "Fold 3: train indices: [108  40 160 132  26], val indices: [193 107  67  46 189]\n",
      "Training data shape: (155, 64, 320, 1), Validation data shape: (39, 64, 320, 1)\n",
      "Fold 3 training loss: 0.10494635999202728\n",
      "y_true (val): [1 1 0 0 1]\n",
      "y_pred: [1 1 0 1 1]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [108, 40, 160, 132, 26, 37, 54, 95, 135, 177, 142, 75, 119, 115, 98, 178, 33, 2, 12, 180, 62, 138, 47, 10, 66, 165, 42, 163, 14, 61, 88, 70, 6, 19, 136, 146, 81, 69, 122, 168, 131, 192, 80, 25, 182, 94, 134, 99, 41, 149, 143, 144, 82, 24, 148, 52, 51, 133, 59, 29, 85, 56, 175, 162, 22, 11, 97, 55, 100, 183, 96, 89, 109, 21, 91, 53, 116, 126, 117, 156, 125, 120, 7, 187, 87, 3, 0, 74, 164, 172, 161, 9, 114, 110, 129, 166, 105, 18, 169, 171, 86, 137, 141, 60, 72, 64, 185, 153, 184, 127, 4, 150, 79, 159, 140, 179, 181, 48, 170, 77, 128, 102, 103, 27, 34, 43, 32, 8, 113, 50, 65, 20, 157, 139, 63, 5, 44, 123, 173, 1, 186, 68, 130, 158, 71, 36, 104, 57, 58, 76, 188, 151, 90, 147, 83], 'val_indices': [193, 107, 67, 46, 189, 35, 73, 174, 93, 17, 176, 154, 152, 15, 23, 49, 112, 30, 38, 124, 190, 16, 191, 45, 145, 31, 106, 84, 39, 118, 167, 92, 155, 111, 101, 28, 13, 78, 121], 'accuracy': 0.717948717948718, 'kappa': 0.43774574049803416, 'auc': 0.7684210526315789}\n",
      "New Max Found!\n",
      "Running fold 4 with 155 training samples and 39 validation samples\n",
      "Fold 4: train indices: [101  15 165  24  72], val indices: [ 29 121  86  20  37]\n",
      "Training data shape: (155, 64, 320, 1), Validation data shape: (39, 64, 320, 1)\n",
      "Fold 4 training loss: 0.1390557587146759\n",
      "y_true (val): [0 1 0 0 0]\n",
      "y_pred: [0 0 1 1 0]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [101, 15, 165, 24, 72, 161, 93, 87, 69, 147, 50, 181, 85, 177, 17, 109, 123, 180, 118, 59, 184, 192, 144, 55, 150, 179, 92, 170, 2, 166, 122, 190, 14, 11, 5, 7, 171, 105, 56, 67, 62, 89, 102, 78, 33, 143, 70, 134, 13, 125, 103, 145, 18, 74, 58, 30, 46, 28, 193, 98, 91, 115, 186, 32, 167, 26, 90, 187, 173, 79, 36, 54, 39, 1, 81, 135, 136, 19, 108, 65, 3, 138, 25, 31, 52, 137, 111, 16, 75, 188, 77, 151, 60, 107, 126, 130, 42, 64, 10, 164, 141, 21, 172, 189, 104, 162, 175, 149, 71, 12, 27, 127, 110, 168, 38, 114, 9, 80, 97, 8, 131, 53, 44, 116, 174, 95, 139, 4, 113, 94, 100, 96, 159, 41, 120, 156, 0, 142, 23, 106, 84, 163, 124, 191, 112, 68, 45, 146, 132, 154, 129, 88, 51, 61, 176], 'val_indices': [29, 121, 86, 20, 37, 49, 178, 63, 47, 133, 148, 76, 153, 48, 35, 119, 152, 117, 99, 73, 183, 34, 158, 83, 82, 182, 22, 128, 185, 140, 169, 66, 40, 6, 155, 43, 160, 57, 157], 'accuracy': 0.6410256410256411, 'kappa': 0.2853403141361257, 'auc': 0.6578947368421053}\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.621, 'mean_kappa': 0.243, 'mean_auc': 0.648, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [179, 134, 84, 162, 63, 55, 95, 37, 20, 0, 79, 156, 1, 4, 47, 87, 19, 58, 56, 157, 61, 71, 77, 111, 103, 181, 145, 115, 144, 62, 72, 48, 43, 172, 14, 78, 57, 23, 159, 112, 90, 82, 167, 192, 2, 28, 114, 18, 141, 122, 182, 27, 42, 177, 96, 185, 163, 155, 81, 107, 26, 173, 180, 188, 128, 97, 67, 190, 74, 24, 101, 22, 184, 36, 106, 126, 147, 110, 92, 138, 168, 129, 169, 17, 50, 46, 38, 178, 52, 113, 119, 7, 8, 15, 186, 118, 33, 29, 137, 13, 5, 187, 11, 93, 35, 189, 153, 175, 94, 10, 117, 171, 32, 158, 150, 191, 30, 34, 59, 70, 135, 80, 100, 161, 120, 86, 9, 104, 123, 154, 65, 60, 174, 68, 166, 142, 108, 170, 149, 143, 89, 146, 41, 16, 3, 124, 44, 164, 116, 53, 176, 99, 88, 165, 105], 'val_indices': [83, 73, 152, 49, 76, 193, 109, 127, 132, 45, 75, 98, 21, 54, 31, 121, 131, 140, 39, 40, 125, 12, 139, 130, 148, 51, 6, 136, 160, 133, 69, 25, 85, 66, 183, 151, 64, 91, 102], 'accuracy': 0.5384615384615384, 'kappa': 0.07631578947368411, 'auc': 0.5447368421052631}, {'fold_index': 1, 'train_indices': [73, 110, 102, 17, 58, 85, 105, 160, 112, 37, 46, 162, 156, 123, 33, 44, 122, 95, 138, 20, 192, 191, 63, 186, 163, 59, 69, 167, 6, 96, 101, 168, 53, 88, 183, 133, 177, 118, 51, 128, 166, 97, 10, 119, 161, 71, 39, 27, 65, 24, 152, 178, 140, 149, 34, 175, 48, 35, 30, 77, 111, 68, 127, 45, 5, 12, 146, 126, 164, 99, 64, 143, 179, 87, 151, 153, 41, 40, 172, 47, 125, 36, 70, 170, 8, 0, 4, 132, 145, 28, 190, 29, 83, 188, 15, 26, 76, 11, 120, 155, 106, 66, 25, 23, 182, 75, 121, 100, 60, 50, 84, 137, 55, 171, 117, 144, 129, 124, 107, 174, 148, 89, 104, 9, 103, 185, 81, 141, 82, 136, 56, 62, 139, 187, 108, 93, 79, 157, 49, 14, 19, 150, 72, 181, 52, 42, 130, 114, 113, 31, 43, 134, 1, 74, 3], 'val_indices': [86, 180, 7, 115, 18, 92, 116, 80, 176, 54, 154, 67, 159, 61, 16, 13, 184, 135, 169, 57, 131, 98, 109, 94, 193, 22, 32, 142, 189, 38, 2, 158, 173, 147, 78, 91, 165, 90, 21], 'accuracy': 0.6410256410256411, 'kappa': 0.28157894736842104, 'auc': 0.6789473684210526}, {'fold_index': 2, 'train_indices': [4, 65, 90, 83, 158, 27, 75, 31, 91, 188, 71, 151, 166, 120, 150, 183, 35, 14, 28, 124, 143, 99, 165, 153, 142, 135, 37, 98, 177, 191, 55, 145, 137, 170, 168, 169, 92, 41, 116, 173, 100, 97, 43, 138, 7, 76, 54, 36, 163, 33, 131, 49, 187, 126, 148, 42, 30, 51, 162, 136, 139, 159, 16, 32, 147, 118, 189, 172, 157, 121, 39, 23, 190, 10, 44, 127, 123, 88, 111, 133, 0, 141, 171, 149, 19, 155, 146, 95, 25, 79, 2, 122, 101, 58, 13, 18, 160, 134, 73, 72, 77, 119, 11, 93, 21, 113, 48, 161, 176, 17, 85, 89, 104, 82, 80, 154, 38, 60, 117, 20, 178, 103, 57, 64, 112, 63, 107, 182, 78, 66, 86, 132, 94, 9, 105, 128, 109, 108, 114, 102, 144, 8, 24, 53, 81, 174, 185, 67, 84, 56, 1, 6, 62, 34, 46], 'val_indices': [12, 70, 26, 29, 45, 52, 186, 156, 184, 125, 68, 3, 15, 87, 130, 115, 61, 22, 181, 192, 179, 110, 106, 193, 50, 180, 47, 164, 40, 167, 175, 152, 59, 69, 74, 96, 5, 129, 140], 'accuracy': 0.5641025641025641, 'kappa': 0.13333333333333341, 'auc': 0.5894736842105263}, {'fold_index': 3, 'train_indices': [108, 40, 160, 132, 26, 37, 54, 95, 135, 177, 142, 75, 119, 115, 98, 178, 33, 2, 12, 180, 62, 138, 47, 10, 66, 165, 42, 163, 14, 61, 88, 70, 6, 19, 136, 146, 81, 69, 122, 168, 131, 192, 80, 25, 182, 94, 134, 99, 41, 149, 143, 144, 82, 24, 148, 52, 51, 133, 59, 29, 85, 56, 175, 162, 22, 11, 97, 55, 100, 183, 96, 89, 109, 21, 91, 53, 116, 126, 117, 156, 125, 120, 7, 187, 87, 3, 0, 74, 164, 172, 161, 9, 114, 110, 129, 166, 105, 18, 169, 171, 86, 137, 141, 60, 72, 64, 185, 153, 184, 127, 4, 150, 79, 159, 140, 179, 181, 48, 170, 77, 128, 102, 103, 27, 34, 43, 32, 8, 113, 50, 65, 20, 157, 139, 63, 5, 44, 123, 173, 1, 186, 68, 130, 158, 71, 36, 104, 57, 58, 76, 188, 151, 90, 147, 83], 'val_indices': [193, 107, 67, 46, 189, 35, 73, 174, 93, 17, 176, 154, 152, 15, 23, 49, 112, 30, 38, 124, 190, 16, 191, 45, 145, 31, 106, 84, 39, 118, 167, 92, 155, 111, 101, 28, 13, 78, 121], 'accuracy': 0.717948717948718, 'kappa': 0.43774574049803416, 'auc': 0.7684210526315789}, {'fold_index': 4, 'train_indices': [101, 15, 165, 24, 72, 161, 93, 87, 69, 147, 50, 181, 85, 177, 17, 109, 123, 180, 118, 59, 184, 192, 144, 55, 150, 179, 92, 170, 2, 166, 122, 190, 14, 11, 5, 7, 171, 105, 56, 67, 62, 89, 102, 78, 33, 143, 70, 134, 13, 125, 103, 145, 18, 74, 58, 30, 46, 28, 193, 98, 91, 115, 186, 32, 167, 26, 90, 187, 173, 79, 36, 54, 39, 1, 81, 135, 136, 19, 108, 65, 3, 138, 25, 31, 52, 137, 111, 16, 75, 188, 77, 151, 60, 107, 126, 130, 42, 64, 10, 164, 141, 21, 172, 189, 104, 162, 175, 149, 71, 12, 27, 127, 110, 168, 38, 114, 9, 80, 97, 8, 131, 53, 44, 116, 174, 95, 139, 4, 113, 94, 100, 96, 159, 41, 120, 156, 0, 142, 23, 106, 84, 163, 124, 191, 112, 68, 45, 146, 132, 154, 129, 88, 51, 61, 176], 'val_indices': [29, 121, 86, 20, 37, 49, 178, 63, 47, 133, 148, 76, 153, 48, 35, 119, 152, 117, 99, 73, 183, 34, 158, 83, 82, 182, 22, 128, 185, 140, 169, 66, 40, 6, 155, 43, 160, 57, 157], 'accuracy': 0.6410256410256411, 'kappa': 0.2853403141361257, 'auc': 0.6578947368421053}], 'std_acc': 0.064, 'std_kappa': 0.127, 'std_auc': 0.077}\n",
      "sbj =  52\n",
      "Total trials loaded: 200\n",
      "Shape of X: (200, 64, 3584), Shape of y: (200,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (200, 64, 320, 1), y_train shape: (200,)\n",
      "Running fold 0 with 160 training samples and 40 validation samples\n",
      "Fold 0: train indices: [  4 142 183  71  50], val indices: [ 25 107  31 188  83]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 0 training loss: 0.010815766640007496\n",
      "y_true (val): [0 1 0 1 0]\n",
      "y_pred: [0 1 0 0 0]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [4, 142, 183, 71, 50, 179, 125, 131, 117, 60, 82, 55, 89, 21, 157, 47, 5, 42, 11, 19, 23, 172, 148, 99, 140, 34, 146, 115, 48, 147, 93, 2, 182, 138, 43, 57, 158, 187, 128, 18, 160, 33, 97, 14, 44, 177, 196, 61, 56, 174, 46, 67, 8, 101, 7, 41, 129, 184, 198, 98, 190, 74, 169, 24, 159, 173, 15, 70, 163, 58, 186, 72, 27, 87, 81, 26, 122, 96, 120, 65, 119, 102, 123, 167, 94, 130, 135, 77, 192, 175, 20, 37, 16, 0, 180, 144, 52, 145, 106, 139, 63, 9, 36, 153, 126, 17, 59, 29, 164, 30, 85, 156, 53, 79, 38, 118, 124, 193, 171, 35, 13, 151, 110, 95, 149, 136, 165, 168, 109, 88, 84, 92, 3, 121, 114, 143, 1, 10, 195, 28, 197, 103, 137, 152, 113, 112, 32, 189, 62, 199, 78, 68, 176, 161, 22, 155, 108, 80, 181, 166], 'val_indices': [25, 107, 31, 188, 83, 86, 111, 75, 191, 170, 76, 12, 100, 154, 73, 6, 66, 54, 104, 162, 91, 51, 132, 39, 105, 40, 134, 141, 45, 116, 185, 178, 127, 150, 194, 69, 133, 90, 64, 49], 'accuracy': 0.7, 'kappa': 0.4, 'auc': 0.7375}\n",
      "New Max Found!\n",
      "Running fold 1 with 160 training samples and 40 validation samples\n",
      "Fold 1: train indices: [162  56 128 110  84], val indices: [175 156   7 191  76]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 1 training loss: 0.021917229518294334\n",
      "y_true (val): [1 1 0 1 0]\n",
      "y_pred: [1 1 0 0 0]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [162, 56, 128, 110, 84, 70, 139, 147, 115, 155, 50, 165, 142, 109, 159, 194, 60, 15, 140, 195, 55, 86, 87, 130, 38, 79, 177, 92, 145, 47, 39, 135, 94, 197, 164, 104, 108, 88, 14, 21, 154, 17, 49, 11, 187, 114, 181, 158, 19, 77, 185, 123, 34, 25, 4, 12, 65, 30, 40, 129, 81, 189, 102, 141, 170, 68, 24, 71, 132, 107, 36, 27, 96, 66, 138, 63, 193, 113, 124, 99, 10, 150, 103, 5, 143, 146, 153, 122, 148, 9, 183, 105, 53, 166, 75, 52, 169, 43, 188, 59, 35, 186, 199, 93, 106, 3, 184, 33, 125, 74, 37, 1, 48, 180, 126, 121, 72, 62, 0, 173, 83, 119, 152, 23, 95, 73, 179, 44, 58, 120, 127, 157, 20, 163, 69, 190, 26, 112, 6, 134, 29, 64, 192, 172, 174, 28, 45, 168, 8, 46, 31, 116, 85, 131, 51, 32, 176, 198, 151, 42], 'val_indices': [175, 156, 7, 191, 76, 117, 54, 16, 2, 80, 41, 118, 78, 90, 100, 160, 149, 161, 171, 18, 82, 182, 101, 61, 91, 167, 144, 133, 196, 67, 22, 57, 137, 136, 98, 111, 89, 13, 178, 97], 'accuracy': 0.6, 'kappa': 0.19999999999999996, 'auc': 0.6599999999999999}\n",
      "Running fold 2 with 160 training samples and 40 validation samples\n",
      "Fold 2: train indices: [  3 109 165  70  15], val indices: [ 58 152 153  54 171]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 2 training loss: 0.025561753660440445\n",
      "y_true (val): [0 1 1 0 1]\n",
      "y_pred: [1 1 1 0 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [3, 109, 165, 70, 15, 172, 19, 5, 38, 146, 77, 11, 147, 198, 92, 18, 174, 2, 176, 168, 118, 199, 63, 100, 158, 17, 134, 86, 105, 24, 34, 175, 61, 166, 125, 97, 39, 108, 78, 79, 80, 31, 46, 180, 60, 113, 127, 87, 186, 144, 124, 67, 13, 136, 74, 65, 115, 167, 123, 72, 191, 182, 82, 23, 110, 40, 119, 183, 148, 128, 143, 85, 142, 107, 189, 30, 130, 145, 103, 96, 164, 151, 98, 64, 101, 43, 81, 49, 75, 69, 89, 106, 66, 162, 154, 161, 122, 188, 121, 10, 20, 91, 52, 111, 137, 57, 93, 178, 102, 138, 55, 47, 133, 42, 12, 196, 99, 177, 44, 169, 37, 193, 157, 1, 190, 0, 26, 141, 155, 173, 28, 27, 16, 32, 7, 195, 131, 197, 14, 156, 185, 36, 95, 71, 51, 160, 194, 117, 56, 68, 126, 41, 59, 135, 129, 4, 53, 90, 94, 179], 'val_indices': [58, 152, 153, 54, 171, 88, 170, 45, 21, 84, 181, 73, 150, 22, 29, 184, 25, 120, 159, 114, 116, 187, 6, 149, 83, 33, 50, 139, 104, 9, 48, 132, 112, 35, 76, 163, 8, 140, 192, 62], 'accuracy': 0.575, 'kappa': 0.15000000000000002, 'auc': 0.6475}\n",
      "Running fold 3 with 160 training samples and 40 validation samples\n",
      "Fold 3: train indices: [66 43 45 22 69], val indices: [ 20  14 169 144 196]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 3 training loss: 0.01863524690270424\n",
      "y_true (val): [0 0 1 1 1]\n",
      "y_pred: [0 0 0 0 1]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [66, 43, 45, 22, 69, 48, 44, 60, 123, 74, 179, 25, 150, 171, 132, 28, 165, 96, 73, 113, 127, 72, 135, 52, 38, 23, 122, 100, 177, 92, 137, 148, 12, 8, 91, 159, 172, 125, 187, 32, 29, 173, 40, 108, 4, 151, 37, 186, 34, 21, 1, 33, 190, 176, 35, 146, 143, 68, 160, 136, 107, 103, 53, 49, 141, 131, 15, 50, 54, 199, 126, 154, 7, 193, 0, 89, 55, 56, 10, 98, 134, 106, 161, 168, 138, 112, 63, 88, 83, 174, 121, 81, 65, 61, 109, 78, 26, 47, 104, 9, 153, 180, 31, 94, 71, 77, 18, 195, 167, 75, 164, 162, 86, 85, 157, 119, 3, 84, 149, 142, 82, 95, 175, 191, 139, 133, 117, 24, 76, 41, 62, 198, 6, 111, 183, 110, 30, 11, 99, 178, 93, 87, 13, 166, 189, 170, 185, 118, 130, 197, 120, 128, 158, 140, 16, 59, 145, 101, 17, 181], 'val_indices': [20, 14, 169, 144, 196, 105, 67, 182, 36, 39, 97, 57, 64, 58, 79, 90, 188, 194, 155, 129, 102, 192, 27, 5, 124, 116, 80, 184, 152, 163, 46, 156, 114, 147, 115, 70, 19, 2, 51, 42], 'accuracy': 0.6, 'kappa': 0.19999999999999996, 'auc': 0.6174999999999999}\n",
      "Running fold 4 with 160 training samples and 40 validation samples\n",
      "Fold 4: train indices: [ 52   4 194  64  46], val indices: [123  35  89 183   0]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 4 training loss: 0.02183978259563446\n",
      "y_true (val): [1 0 0 1 0]\n",
      "y_pred: [1 1 1 1 0]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [52, 4, 194, 64, 46, 59, 38, 21, 193, 157, 28, 57, 17, 154, 184, 97, 139, 125, 102, 182, 30, 143, 180, 50, 126, 13, 161, 100, 15, 135, 45, 74, 153, 51, 115, 189, 181, 187, 37, 133, 118, 168, 16, 136, 66, 73, 19, 174, 22, 24, 71, 192, 63, 144, 122, 72, 54, 175, 147, 155, 85, 107, 149, 103, 69, 31, 27, 145, 7, 84, 77, 191, 88, 79, 114, 49, 90, 124, 5, 111, 36, 172, 131, 61, 32, 185, 173, 2, 166, 39, 148, 110, 34, 199, 65, 186, 23, 91, 159, 170, 93, 119, 195, 116, 129, 76, 53, 158, 101, 130, 178, 156, 6, 94, 138, 167, 96, 68, 132, 165, 92, 140, 12, 137, 44, 188, 160, 83, 47, 60, 98, 81, 105, 78, 58, 11, 25, 26, 82, 141, 171, 196, 62, 48, 1, 177, 70, 121, 8, 163, 109, 95, 104, 43, 117, 150, 14, 197, 127, 33], 'val_indices': [123, 35, 89, 183, 0, 80, 75, 134, 10, 87, 120, 40, 151, 67, 86, 99, 152, 42, 20, 176, 162, 169, 41, 190, 56, 9, 142, 146, 112, 108, 3, 128, 198, 106, 55, 29, 18, 164, 113, 179], 'accuracy': 0.775, 'kappa': 0.55, 'auc': 0.815}\n",
      "New Max Found!\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.65, 'mean_kappa': 0.3, 'mean_auc': 0.695, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [4, 142, 183, 71, 50, 179, 125, 131, 117, 60, 82, 55, 89, 21, 157, 47, 5, 42, 11, 19, 23, 172, 148, 99, 140, 34, 146, 115, 48, 147, 93, 2, 182, 138, 43, 57, 158, 187, 128, 18, 160, 33, 97, 14, 44, 177, 196, 61, 56, 174, 46, 67, 8, 101, 7, 41, 129, 184, 198, 98, 190, 74, 169, 24, 159, 173, 15, 70, 163, 58, 186, 72, 27, 87, 81, 26, 122, 96, 120, 65, 119, 102, 123, 167, 94, 130, 135, 77, 192, 175, 20, 37, 16, 0, 180, 144, 52, 145, 106, 139, 63, 9, 36, 153, 126, 17, 59, 29, 164, 30, 85, 156, 53, 79, 38, 118, 124, 193, 171, 35, 13, 151, 110, 95, 149, 136, 165, 168, 109, 88, 84, 92, 3, 121, 114, 143, 1, 10, 195, 28, 197, 103, 137, 152, 113, 112, 32, 189, 62, 199, 78, 68, 176, 161, 22, 155, 108, 80, 181, 166], 'val_indices': [25, 107, 31, 188, 83, 86, 111, 75, 191, 170, 76, 12, 100, 154, 73, 6, 66, 54, 104, 162, 91, 51, 132, 39, 105, 40, 134, 141, 45, 116, 185, 178, 127, 150, 194, 69, 133, 90, 64, 49], 'accuracy': 0.7, 'kappa': 0.4, 'auc': 0.7375}, {'fold_index': 1, 'train_indices': [162, 56, 128, 110, 84, 70, 139, 147, 115, 155, 50, 165, 142, 109, 159, 194, 60, 15, 140, 195, 55, 86, 87, 130, 38, 79, 177, 92, 145, 47, 39, 135, 94, 197, 164, 104, 108, 88, 14, 21, 154, 17, 49, 11, 187, 114, 181, 158, 19, 77, 185, 123, 34, 25, 4, 12, 65, 30, 40, 129, 81, 189, 102, 141, 170, 68, 24, 71, 132, 107, 36, 27, 96, 66, 138, 63, 193, 113, 124, 99, 10, 150, 103, 5, 143, 146, 153, 122, 148, 9, 183, 105, 53, 166, 75, 52, 169, 43, 188, 59, 35, 186, 199, 93, 106, 3, 184, 33, 125, 74, 37, 1, 48, 180, 126, 121, 72, 62, 0, 173, 83, 119, 152, 23, 95, 73, 179, 44, 58, 120, 127, 157, 20, 163, 69, 190, 26, 112, 6, 134, 29, 64, 192, 172, 174, 28, 45, 168, 8, 46, 31, 116, 85, 131, 51, 32, 176, 198, 151, 42], 'val_indices': [175, 156, 7, 191, 76, 117, 54, 16, 2, 80, 41, 118, 78, 90, 100, 160, 149, 161, 171, 18, 82, 182, 101, 61, 91, 167, 144, 133, 196, 67, 22, 57, 137, 136, 98, 111, 89, 13, 178, 97], 'accuracy': 0.6, 'kappa': 0.19999999999999996, 'auc': 0.6599999999999999}, {'fold_index': 2, 'train_indices': [3, 109, 165, 70, 15, 172, 19, 5, 38, 146, 77, 11, 147, 198, 92, 18, 174, 2, 176, 168, 118, 199, 63, 100, 158, 17, 134, 86, 105, 24, 34, 175, 61, 166, 125, 97, 39, 108, 78, 79, 80, 31, 46, 180, 60, 113, 127, 87, 186, 144, 124, 67, 13, 136, 74, 65, 115, 167, 123, 72, 191, 182, 82, 23, 110, 40, 119, 183, 148, 128, 143, 85, 142, 107, 189, 30, 130, 145, 103, 96, 164, 151, 98, 64, 101, 43, 81, 49, 75, 69, 89, 106, 66, 162, 154, 161, 122, 188, 121, 10, 20, 91, 52, 111, 137, 57, 93, 178, 102, 138, 55, 47, 133, 42, 12, 196, 99, 177, 44, 169, 37, 193, 157, 1, 190, 0, 26, 141, 155, 173, 28, 27, 16, 32, 7, 195, 131, 197, 14, 156, 185, 36, 95, 71, 51, 160, 194, 117, 56, 68, 126, 41, 59, 135, 129, 4, 53, 90, 94, 179], 'val_indices': [58, 152, 153, 54, 171, 88, 170, 45, 21, 84, 181, 73, 150, 22, 29, 184, 25, 120, 159, 114, 116, 187, 6, 149, 83, 33, 50, 139, 104, 9, 48, 132, 112, 35, 76, 163, 8, 140, 192, 62], 'accuracy': 0.575, 'kappa': 0.15000000000000002, 'auc': 0.6475}, {'fold_index': 3, 'train_indices': [66, 43, 45, 22, 69, 48, 44, 60, 123, 74, 179, 25, 150, 171, 132, 28, 165, 96, 73, 113, 127, 72, 135, 52, 38, 23, 122, 100, 177, 92, 137, 148, 12, 8, 91, 159, 172, 125, 187, 32, 29, 173, 40, 108, 4, 151, 37, 186, 34, 21, 1, 33, 190, 176, 35, 146, 143, 68, 160, 136, 107, 103, 53, 49, 141, 131, 15, 50, 54, 199, 126, 154, 7, 193, 0, 89, 55, 56, 10, 98, 134, 106, 161, 168, 138, 112, 63, 88, 83, 174, 121, 81, 65, 61, 109, 78, 26, 47, 104, 9, 153, 180, 31, 94, 71, 77, 18, 195, 167, 75, 164, 162, 86, 85, 157, 119, 3, 84, 149, 142, 82, 95, 175, 191, 139, 133, 117, 24, 76, 41, 62, 198, 6, 111, 183, 110, 30, 11, 99, 178, 93, 87, 13, 166, 189, 170, 185, 118, 130, 197, 120, 128, 158, 140, 16, 59, 145, 101, 17, 181], 'val_indices': [20, 14, 169, 144, 196, 105, 67, 182, 36, 39, 97, 57, 64, 58, 79, 90, 188, 194, 155, 129, 102, 192, 27, 5, 124, 116, 80, 184, 152, 163, 46, 156, 114, 147, 115, 70, 19, 2, 51, 42], 'accuracy': 0.6, 'kappa': 0.19999999999999996, 'auc': 0.6174999999999999}, {'fold_index': 4, 'train_indices': [52, 4, 194, 64, 46, 59, 38, 21, 193, 157, 28, 57, 17, 154, 184, 97, 139, 125, 102, 182, 30, 143, 180, 50, 126, 13, 161, 100, 15, 135, 45, 74, 153, 51, 115, 189, 181, 187, 37, 133, 118, 168, 16, 136, 66, 73, 19, 174, 22, 24, 71, 192, 63, 144, 122, 72, 54, 175, 147, 155, 85, 107, 149, 103, 69, 31, 27, 145, 7, 84, 77, 191, 88, 79, 114, 49, 90, 124, 5, 111, 36, 172, 131, 61, 32, 185, 173, 2, 166, 39, 148, 110, 34, 199, 65, 186, 23, 91, 159, 170, 93, 119, 195, 116, 129, 76, 53, 158, 101, 130, 178, 156, 6, 94, 138, 167, 96, 68, 132, 165, 92, 140, 12, 137, 44, 188, 160, 83, 47, 60, 98, 81, 105, 78, 58, 11, 25, 26, 82, 141, 171, 196, 62, 48, 1, 177, 70, 121, 8, 163, 109, 95, 104, 43, 117, 150, 14, 197, 127, 33], 'val_indices': [123, 35, 89, 183, 0, 80, 75, 134, 10, 87, 120, 40, 151, 67, 86, 99, 152, 42, 20, 176, 162, 169, 41, 190, 56, 9, 142, 146, 112, 108, 3, 128, 198, 106, 55, 29, 18, 164, 113, 179], 'accuracy': 0.775, 'kappa': 0.55, 'auc': 0.815}], 'std_acc': 0.076, 'std_kappa': 0.152, 'std_auc': 0.072}\n"
     ]
    }
   ],
   "source": [
    "from pickle import dump\n",
    "\n",
    "subjects = [47, 48, 50, 51, 52]\n",
    "\n",
    "for sbj in subjects[:]:\n",
    "  print('sbj = ', sbj)\n",
    "  load_args['sbj'] = sbj\n",
    "  results = train(db_name, load_args, cv_args, model_args, compile_args, fit_args, seed)\n",
    "  with open('sbj' + str(load_args['sbj']) + '.txt', 'wb') as f:\n",
    "    dump(results, f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "9f6715a2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T09:16:56.461650Z",
     "iopub.status.busy": "2025-01-20T09:16:56.461050Z",
     "iopub.status.idle": "2025-01-20T09:16:58.776405Z",
     "shell.execute_reply": "2025-01-20T09:16:58.774910Z"
    },
    "id": "V7-P0xjwzXVX",
    "outputId": "270dceef-351d-48d1-f71e-2c3367c7fdac",
    "papermill": {
     "duration": 2.511863,
     "end_time": "2025-01-20T09:16:58.779484",
     "exception": false,
     "start_time": "2025-01-20T09:16:56.267621",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "  adding: sbj47.h5 (deflated 75%)\r\n",
      "  adding: sbj48.h5 (deflated 75%)\r\n",
      "  adding: sbj50.h5 (deflated 75%)\r\n",
      "  adding: sbj51.h5 (deflated 75%)\r\n",
      "  adding: sbj52.h5 (deflated 75%)\r\n",
      "  adding: sbj47.txt (deflated 40%)\r\n",
      "  adding: sbj48.txt (deflated 42%)\r\n",
      "  adding: sbj50.txt (deflated 42%)\r\n",
      "  adding: sbj51.txt (deflated 40%)\r\n",
      "  adding: sbj52.txt (deflated 41%)\r\n"
     ]
    }
   ],
   "source": [
    "!zip Models_64ch_EEGNet.zip ./*.h5 \n",
    "!zip Results_64ch_EEGNet.zip ./*.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "655fc999",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T09:16:59.160295Z",
     "iopub.status.busy": "2025-01-20T09:16:59.159785Z",
     "iopub.status.idle": "2025-01-20T09:16:59.165175Z",
     "shell.execute_reply": "2025-01-20T09:16:59.164124Z"
    },
    "papermill": {
     "duration": 0.198701,
     "end_time": "2025-01-20T09:16:59.167182",
     "exception": false,
     "start_time": "2025-01-20T09:16:58.968481",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#import pickle as pkl\n",
    "\n",
    "#with open(file= '/kaggle/working/sbj14.txt', mode = 'rb' ) as f:\n",
    "#    results_64ch_ShallowConvNet = pkl.load(f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "faf45dbb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T09:16:59.545955Z",
     "iopub.status.busy": "2025-01-20T09:16:59.544932Z",
     "iopub.status.idle": "2025-01-20T09:16:59.551498Z",
     "shell.execute_reply": "2025-01-20T09:16:59.550350Z"
    },
    "papermill": {
     "duration": 0.19792,
     "end_time": "2025-01-20T09:16:59.553661",
     "exception": false,
     "start_time": "2025-01-20T09:16:59.355741",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#results_64ch_ShallowConvNet"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "3360088d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T09:16:59.930548Z",
     "iopub.status.busy": "2025-01-20T09:16:59.930133Z",
     "iopub.status.idle": "2025-01-20T09:16:59.935259Z",
     "shell.execute_reply": "2025-01-20T09:16:59.934089Z"
    },
    "papermill": {
     "duration": 0.196816,
     "end_time": "2025-01-20T09:16:59.937356",
     "exception": false,
     "start_time": "2025-01-20T09:16:59.740540",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#with open(file= '/kaggle/working/sbj2.txt', mode = 'rb' ) as f:\n",
    " #   results_64ch_ShallowConvNet = pkl.load(f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "231a0474",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T09:17:00.324231Z",
     "iopub.status.busy": "2025-01-20T09:17:00.323778Z",
     "iopub.status.idle": "2025-01-20T09:17:00.329331Z",
     "shell.execute_reply": "2025-01-20T09:17:00.327975Z"
    },
    "papermill": {
     "duration": 0.205089,
     "end_time": "2025-01-20T09:17:00.331468",
     "exception": false,
     "start_time": "2025-01-20T09:17:00.126379",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#results_64ch_ShallowConvNet"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 1645904,
     "sourceId": 2702213,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 1269900,
     "sourceId": 2702226,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 2984453,
     "sourceId": 5137200,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 3008205,
     "sourceId": 5175158,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30786,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 19153.190586,
   "end_time": "2025-01-20T09:17:03.241257",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-01-20T03:57:50.050671",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
