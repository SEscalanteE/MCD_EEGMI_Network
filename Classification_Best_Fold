{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "1afe077b",
   "metadata": {
    "id": "x9LNzEYERaH2",
    "papermill": {
     "duration": 0.005236,
     "end_time": "2025-01-20T03:56:38.361762",
     "exception": false,
     "start_time": "2025-01-20T03:56:38.356526",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Download Packages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "0ef0a294",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T03:56:38.372266Z",
     "iopub.status.busy": "2025-01-20T03:56:38.371771Z",
     "iopub.status.idle": "2025-01-20T03:56:39.574409Z",
     "shell.execute_reply": "2025-01-20T03:56:39.573200Z"
    },
    "papermill": {
     "duration": 1.210855,
     "end_time": "2025-01-20T03:56:39.577007",
     "exception": false,
     "start_time": "2025-01-20T03:56:38.366152",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/bin/bash: nvidia-smi: command not found\r\n"
     ]
    }
   ],
   "source": [
    "!nvidia-smi -L"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "d6427f0a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T03:56:39.587280Z",
     "iopub.status.busy": "2025-01-20T03:56:39.586864Z",
     "iopub.status.idle": "2025-01-20T03:58:09.501366Z",
     "shell.execute_reply": "2025-01-20T03:58:09.499557Z"
    },
    "id": "K0oS6IH7VTZX",
    "papermill": {
     "duration": 89.923963,
     "end_time": "2025-01-20T03:58:09.505287",
     "exception": false,
     "start_time": "2025-01-20T03:56:39.581324",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "%%capture\n",
    "!pip install -U git+https://github.com/UN-GCPDS/python-gcpds.databases #Package for database reading.\n",
    "!pip install mne #The MNE Package is installed\n",
    "FILEID = \"1lo0MjWLvsyne2CgTA6VZ2HGY9SKxiwZ7\"\n",
    "!wget --load-cookies /tmp/cookies.txt \"https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id='$FILEID -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\\1\\n/p')&id=\"$FILEID -O MI_EEG_ClassMeth.zip && rm -rf /tmp/cookies.txt\n",
    "!unzip MI_EEG_ClassMeth.zip #Package with useful functions for motor imagery classification based in EEG.\n",
    "!pip install -U git+https://github.com/UN-GCPDS/python-gcpds.EEG_Tensorflow_models.git\n",
    "!dir"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "69b5bab7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T03:58:09.521370Z",
     "iopub.status.busy": "2025-01-20T03:58:09.520953Z",
     "iopub.status.idle": "2025-01-20T03:59:35.341552Z",
     "shell.execute_reply": "2025-01-20T03:59:35.339659Z"
    },
    "papermill": {
     "duration": 85.831438,
     "end_time": "2025-01-20T03:59:35.344488",
     "exception": false,
     "start_time": "2025-01-20T03:58:09.513050",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\r\n",
      "\r\n",
      "\r\n",
      "E: Unable to locate package libcudnn8\r\n",
      "Collecting tensorflow==2.8.2\r\n",
      "  Downloading tensorflow-2.8.2-cp310-cp310-manylinux2010_x86_64.whl.metadata (2.9 kB)\r\n",
      "Requirement already satisfied: absl-py>=0.4.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.4.0)\r\n",
      "Requirement already satisfied: astunparse>=1.6.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.6.3)\r\n",
      "Requirement already satisfied: flatbuffers>=1.12 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (24.3.25)\r\n",
      "Requirement already satisfied: gast>=0.2.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (0.5.4)\r\n",
      "Requirement already satisfied: google-pasta>=0.1.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (0.2.0)\r\n",
      "Requirement already satisfied: h5py>=2.9.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (3.11.0)\r\n",
      "Collecting keras-preprocessing>=1.1.1 (from tensorflow==2.8.2)\r\n",
      "  Downloading Keras_Preprocessing-1.1.2-py2.py3-none-any.whl.metadata (1.9 kB)\r\n",
      "Requirement already satisfied: libclang>=9.0.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (18.1.1)\r\n",
      "Requirement already satisfied: numpy>=1.20 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.26.4)\r\n",
      "Requirement already satisfied: opt-einsum>=2.3.2 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (3.3.0)\r\n",
      "Collecting protobuf<3.20,>=3.9.2 (from tensorflow==2.8.2)\r\n",
      "  Downloading protobuf-3.19.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (787 bytes)\r\n",
      "Requirement already satisfied: setuptools in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (70.0.0)\r\n",
      "Requirement already satisfied: six>=1.12.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.16.0)\r\n",
      "Requirement already satisfied: termcolor>=1.1.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (2.4.0)\r\n",
      "Requirement already satisfied: typing-extensions>=3.6.6 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (4.12.2)\r\n",
      "Requirement already satisfied: wrapt>=1.11.0 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.16.0)\r\n",
      "Collecting tensorboard<2.9,>=2.8 (from tensorflow==2.8.2)\r\n",
      "  Downloading tensorboard-2.8.0-py3-none-any.whl.metadata (1.9 kB)\r\n",
      "Collecting tensorflow-estimator<2.9,>=2.8 (from tensorflow==2.8.2)\r\n",
      "  Downloading tensorflow_estimator-2.8.0-py2.py3-none-any.whl.metadata (1.3 kB)\r\n",
      "Collecting keras<2.9,>=2.8.0rc0 (from tensorflow==2.8.2)\r\n",
      "  Downloading keras-2.8.0-py2.py3-none-any.whl.metadata (1.3 kB)\r\n",
      "Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (0.37.0)\r\n",
      "Requirement already satisfied: grpcio<2.0,>=1.24.3 in /opt/conda/lib/python3.10/site-packages (from tensorflow==2.8.2) (1.64.1)\r\n",
      "Requirement already satisfied: wheel<1.0,>=0.23.0 in /opt/conda/lib/python3.10/site-packages (from astunparse>=1.6.0->tensorflow==2.8.2) (0.43.0)\r\n",
      "Requirement already satisfied: google-auth<3,>=1.6.3 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8.2) (2.30.0)\r\n",
      "Collecting google-auth-oauthlib<0.5,>=0.4.1 (from tensorboard<2.9,>=2.8->tensorflow==2.8.2)\r\n",
      "  Downloading google_auth_oauthlib-0.4.6-py2.py3-none-any.whl.metadata (2.7 kB)\r\n",
      "Requirement already satisfied: markdown>=2.6.8 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8.2) (3.6)\r\n",
      "Requirement already satisfied: requests<3,>=2.21.0 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8.2) (2.32.3)\r\n",
      "Collecting tensorboard-data-server<0.7.0,>=0.6.0 (from tensorboard<2.9,>=2.8->tensorflow==2.8.2)\r\n",
      "  Downloading tensorboard_data_server-0.6.1-py3-none-manylinux2010_x86_64.whl.metadata (1.1 kB)\r\n",
      "Collecting tensorboard-plugin-wit>=1.6.0 (from tensorboard<2.9,>=2.8->tensorflow==2.8.2)\r\n",
      "  Downloading tensorboard_plugin_wit-1.8.1-py3-none-any.whl.metadata (873 bytes)\r\n",
      "Requirement already satisfied: werkzeug>=0.11.15 in /opt/conda/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8.2) (3.0.4)\r\n",
      "Requirement already satisfied: cachetools<6.0,>=2.0.0 in /opt/conda/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (4.2.4)\r\n",
      "Requirement already satisfied: pyasn1-modules>=0.2.1 in /opt/conda/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (0.4.0)\r\n",
      "Requirement already satisfied: rsa<5,>=3.1.4 in /opt/conda/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (4.9)\r\n",
      "Requirement already satisfied: requests-oauthlib>=0.7.0 in /opt/conda/lib/python3.10/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (2.0.0)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (3.3.2)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (3.7)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (1.26.18)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (2024.8.30)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.1.1 in /opt/conda/lib/python3.10/site-packages (from werkzeug>=0.11.15->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (2.1.5)\r\n",
      "Requirement already satisfied: pyasn1<0.7.0,>=0.4.6 in /opt/conda/lib/python3.10/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (0.6.0)\r\n",
      "Requirement already satisfied: oauthlib>=3.0.0 in /opt/conda/lib/python3.10/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard<2.9,>=2.8->tensorflow==2.8.2) (3.2.2)\r\n",
      "Downloading tensorflow-2.8.2-cp310-cp310-manylinux2010_x86_64.whl (498.0 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m498.0/498.0 MB\u001b[0m \u001b[31m3.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading keras-2.8.0-py2.py3-none-any.whl (1.4 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.4/1.4 MB\u001b[0m \u001b[31m41.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading Keras_Preprocessing-1.1.2-py2.py3-none-any.whl (42 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m42.6/42.6 kB\u001b[0m \u001b[31m1.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading protobuf-3.19.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.1 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.1/1.1 MB\u001b[0m \u001b[31m27.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading tensorboard-2.8.0-py3-none-any.whl (5.8 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m5.8/5.8 MB\u001b[0m \u001b[31m73.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading tensorflow_estimator-2.8.0-py2.py3-none-any.whl (462 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m462.3/462.3 kB\u001b[0m \u001b[31m18.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading google_auth_oauthlib-0.4.6-py2.py3-none-any.whl (18 kB)\r\n",
      "Downloading tensorboard_data_server-0.6.1-py3-none-manylinux2010_x86_64.whl (4.9 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.9/4.9 MB\u001b[0m \u001b[31m71.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading tensorboard_plugin_wit-1.8.1-py3-none-any.whl (781 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m781.3/781.3 kB\u001b[0m \u001b[31m28.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hInstalling collected packages: tensorflow-estimator, tensorboard-plugin-wit, keras, tensorboard-data-server, protobuf, keras-preprocessing, google-auth-oauthlib, tensorboard, tensorflow\r\n",
      "  Attempting uninstall: tensorflow-estimator\r\n",
      "    Found existing installation: tensorflow-estimator 2.15.0\r\n",
      "    Uninstalling tensorflow-estimator-2.15.0:\r\n",
      "      Successfully uninstalled tensorflow-estimator-2.15.0\r\n",
      "  Attempting uninstall: keras\r\n",
      "    Found existing installation: keras 3.3.3\r\n",
      "    Uninstalling keras-3.3.3:\r\n",
      "      Successfully uninstalled keras-3.3.3\r\n",
      "  Attempting uninstall: tensorboard-data-server\r\n",
      "    Found existing installation: tensorboard-data-server 0.7.2\r\n",
      "    Uninstalling tensorboard-data-server-0.7.2:\r\n",
      "      Successfully uninstalled tensorboard-data-server-0.7.2\r\n",
      "  Attempting uninstall: protobuf\r\n",
      "    Found existing installation: protobuf 3.20.3\r\n",
      "    Uninstalling protobuf-3.20.3:\r\n",
      "      Successfully uninstalled protobuf-3.20.3\r\n",
      "  Attempting uninstall: google-auth-oauthlib\r\n",
      "    Found existing installation: google-auth-oauthlib 1.2.0\r\n",
      "    Uninstalling google-auth-oauthlib-1.2.0:\r\n",
      "      Successfully uninstalled google-auth-oauthlib-1.2.0\r\n",
      "  Attempting uninstall: tensorboard\r\n",
      "    Found existing installation: tensorboard 2.16.2\r\n",
      "    Uninstalling tensorboard-2.16.2:\r\n",
      "      Successfully uninstalled tensorboard-2.16.2\r\n",
      "  Attempting uninstall: tensorflow\r\n",
      "    Found existing installation: tensorflow 2.16.1\r\n",
      "    Uninstalling tensorflow-2.16.1:\r\n",
      "      Successfully uninstalled tensorflow-2.16.1\r\n",
      "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\r\n",
      "apache-beam 2.46.0 requires cloudpickle~=2.2.1, but you have cloudpickle 3.0.0 which is incompatible.\r\n",
      "apache-beam 2.46.0 requires dill<0.3.2,>=0.3.1.1, but you have dill 0.3.8 which is incompatible.\r\n",
      "apache-beam 2.46.0 requires numpy<1.25.0,>=1.14.3, but you have numpy 1.26.4 which is incompatible.\r\n",
      "apache-beam 2.46.0 requires pyarrow<10.0.0,>=3.0.0, but you have pyarrow 17.0.0 which is incompatible.\r\n",
      "google-ai-generativelanguage 0.6.10 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-aiplatform 0.6.0a1 requires google-api-core[grpc]<2.0.0dev,>=1.22.2, but you have google-api-core 2.11.1 which is incompatible.\r\n",
      "google-cloud-automl 1.0.1 requires google-api-core[grpc]<2.0.0dev,>=1.14.0, but you have google-api-core 2.11.1 which is incompatible.\r\n",
      "google-cloud-language 2.14.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-spanner 3.47.0 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-videointelligence 2.13.5 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "kfp 2.5.0 requires google-cloud-storage<3,>=2.2.1, but you have google-cloud-storage 1.44.0 which is incompatible.\r\n",
      "onnx 1.17.0 requires protobuf>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorboardx 2.6.2.2 requires protobuf>=3.20, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorflow-datasets 4.9.6 requires protobuf>=3.20, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorflow-decision-forests 1.9.1 requires tensorflow~=2.16.1, but you have tensorflow 2.8.2 which is incompatible.\r\n",
      "tensorflow-serving-api 2.16.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorflow-serving-api 2.16.1 requires tensorflow<3,>=2.16.1, but you have tensorflow 2.8.2 which is incompatible.\r\n",
      "tensorflow-text 2.16.1 requires tensorflow<2.17,>=2.16.1; platform_machine != \"arm64\" or platform_system != \"Darwin\", but you have tensorflow 2.8.2 which is incompatible.\r\n",
      "tf-keras 2.16.0 requires tensorflow<2.17,>=2.16, but you have tensorflow 2.8.2 which is incompatible.\u001b[0m\u001b[31m\r\n",
      "\u001b[0mSuccessfully installed google-auth-oauthlib-0.4.6 keras-2.8.0 keras-preprocessing-1.1.2 protobuf-3.19.6 tensorboard-2.8.0 tensorboard-data-server-0.6.1 tensorboard-plugin-wit-1.8.1 tensorflow-2.8.2 tensorflow-estimator-2.8.0\r\n"
     ]
    }
   ],
   "source": [
    "!apt-get install --allow-change-held-packages libcudnn8=8.1.0.77-1+cuda11.2 -y\n",
    "!pip install tensorflow==2.8.2"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cb3512f4",
   "metadata": {
    "papermill": {
     "duration": 0.022747,
     "end_time": "2025-01-20T03:59:35.384190",
     "exception": false,
     "start_time": "2025-01-20T03:59:35.361443",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Functions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "afae6223",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T03:59:35.444553Z",
     "iopub.status.busy": "2025-01-20T03:59:35.444126Z",
     "iopub.status.idle": "2025-01-20T03:59:49.529083Z",
     "shell.execute_reply": "2025-01-20T03:59:49.527832Z"
    },
    "id": "yE1sbHYQVbBq",
    "papermill": {
     "duration": 14.122154,
     "end_time": "2025-01-20T03:59:49.531873",
     "exception": false,
     "start_time": "2025-01-20T03:59:35.409719",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [],
   "source": [
    "from gcpds.databases.BCI_Competition_IV import Dataset_2a\n",
    "from typing import Sequence, Tuple\n",
    "from MI_EEG_ClassMeth.FeatExtraction import TimeFrequencyRpr\n",
    "import numpy as np\n",
    "from scipy.signal import resample\n",
    "\n",
    "def load_BCICIV2a(db: Dataset_2a,\n",
    "               sbj: int,\n",
    "               mode: str,\n",
    "               fs: float, \n",
    "               f_bank: np.ndarray, \n",
    "               vwt: np.ndarray, \n",
    "               new_fs: float) -> np.ndarray:\n",
    "\n",
    "  tf_repr = TimeFrequencyRpr(sfreq = fs, f_bank = f_bank, vwt = vwt)\n",
    "\n",
    "  db.load_subject(sbj, mode = mode)\n",
    "    \n",
    "  X, y = db.get_data() #Load all classes, all channels {EEG, EOG}, reject bad trials\n",
    "\n",
    "  X = X[:,:-3,:] # pick EEG channels\n",
    "  X = X*1e6 #uV\n",
    "  X = np.squeeze(tf_repr.transform(X))\n",
    "  #Resampling\n",
    "  if new_fs == fs:\n",
    "    print('No resampling, since new sampling rate same.')\n",
    "  else:\n",
    "    print(\"Resampling from {:f} to {:f} Hz.\".format(fs, new_fs))\n",
    "    X = resample(X, int((X.shape[-1]/fs)*new_fs), axis = -1)\n",
    "    \n",
    "  return X, y\n",
    "\n",
    "\n",
    "from gcpds.databases import GIGA_MI_ME\n",
    "\n",
    "def load_GIGA_MI_ME(db: GIGA_MI_ME,\n",
    "              sbj: int,\n",
    "              eeg_ch_names: Sequence[str],\n",
    "              fs: float, \n",
    "              f_bank: np.ndarray, \n",
    "              vwt: np.ndarray, \n",
    "              new_fs: float) -> Tuple[np.ndarray, np.ndarray]:\n",
    "\n",
    "    index_eeg_chs = db.format_channels_selectors(channels=eeg_ch_names) - 1\n",
    "\n",
    "    tf_repr = TimeFrequencyRpr(sfreq=fs, f_bank=f_bank, vwt=vwt)\n",
    "\n",
    "    # Load subject data\n",
    "    db.load_subject(sbj)\n",
    "    X, y = db.get_data(classes=['left hand mi', 'right hand mi'])\n",
    "    \n",
    "    # Debugging total trials\n",
    "    print(f\"Total trials loaded: {X.shape[0]}\")\n",
    "    print(f\"Shape of X: {X.shape}, Shape of y: {y.shape}\")\n",
    "\n",
    "    # Spatial rearrangement\n",
    "    X = X[:, index_eeg_chs, :]  \n",
    "    X = np.squeeze(tf_repr.transform(X))\n",
    "\n",
    "    # Resampling\n",
    "    if new_fs == fs:\n",
    "        print('No resampling, since new sampling rate is the same.')\n",
    "    else:\n",
    "        print(f\"Resampling from {fs} to {new_fs} Hz.\")\n",
    "        X = resample(X, int((X.shape[-1] / fs) * new_fs), axis=-1)\n",
    "    \n",
    "    return X, y\n",
    "\n",
    "\n",
    "\n",
    "def load_DB(db_name, **load_args):\n",
    "  if db_name == 'BCICIV2a':\n",
    "    X_train, y_train = load_BCICIV2a(**load_args, mode = 'training')\n",
    "    X_test, y_test = load_BCICIV2a(**load_args, mode = 'evaluation')\n",
    "\n",
    "    X_train = np.concatenate([X_train, X_test], axis = 0)\n",
    "    y_train = np.concatenate([y_train, y_test], axis = 0)\n",
    "\n",
    "  elif db_name == 'GIGA_MI_ME':\n",
    "    X_train, y_train = load_GIGA_MI_ME(**load_args)\n",
    "    \n",
    "  else:\n",
    "    raise ValueError('No valid database name')\n",
    "\n",
    "  return X_train, y_train\n",
    "\n",
    "\n",
    "from EEG_Tensorflow_models.Models import DeepConvNet, ShallowConvNet, EEGNet, DMTL_BCI, TCNet_fusion, PST_attention\n",
    "\n",
    "\n",
    "def get_model(model_name, nb_classes):\n",
    "  if model_name == 'DeepConvNet':\n",
    "    model = DeepConvNet\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      dropoutRate = 0.5, version='2018')\n",
    "    \n",
    "  elif model_name == 'ShallowConvNet':\n",
    "    model = ShallowConvNet\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      dropoutRate = 0.5,\n",
    "                      version = '2018')\n",
    "    \n",
    "  elif model_name == 'EEGNet':\n",
    "    model = EEGNet\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      dropoutRate = 0.5,\n",
    "                      kernLength = 32,\n",
    "                      F1 = 8,\n",
    "                      D = 2,\n",
    "                      F2 = 16,\n",
    "                      norm_rate = 0.25, \n",
    "                      dropoutType = 'Dropout')\n",
    "    \n",
    "  elif model_name == 'DMTL_BCI':\n",
    "    model = DMTL_BCI\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      dropoutRate = 0.5,\n",
    "                      l1 = 0,\n",
    "                      l2 = 0)\n",
    "    \n",
    "  elif model_name == 'TCNet_fusion':\n",
    "    model = TCNet_fusion\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      layers = 2,\n",
    "                      kernel_s = 4,\n",
    "                      filt = 12,\n",
    "                      dropout = 0.3,\n",
    "                      activation = 'relu',\n",
    "                      F1 = 24,\n",
    "                      D = 2,\n",
    "                      kernLength = 32,\n",
    "                      N_residuals = 2)\n",
    "    \n",
    "  elif model_name == 'PST_attention':\n",
    "    model = PST_attention\n",
    "    model_params = dict(nb_classes = nb_classes,\n",
    "                      dropoutRate = 0.5,\n",
    "                      last_layer = 'Dense')\n",
    "    \n",
    "  else:\n",
    "    raise ValueError('No valid model name')\n",
    "    \n",
    "  return model, model_params\n",
    "\n",
    "from tensorflow.random import set_seed\n",
    "from tensorflow.keras.backend import clear_session\n",
    "from tensorflow.keras.optimizers import Adam\n",
    "from sklearn.metrics import accuracy_score, cohen_kappa_score, roc_auc_score,\\\n",
    "                            f1_score, recall_score, precision_score\n",
    "\n",
    "def train(db_name, load_args, cv_args, model_args, compile_args, fit_args, seed):\n",
    "    X_train, y_train = load_DB(db_name, **load_args)\n",
    "    X_train = X_train[..., np.newaxis]  # Add channel dimension\n",
    "    print(f\"X_train shape: {X_train.shape}, y_train shape: {y_train.shape}\")\n",
    "    \n",
    "    cv_results = {'params': [],\n",
    "                  'mean_acc': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_kappa': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_auc': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_f1_left': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_f1_right': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_recall_left': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_recall_right': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_precision_left': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'mean_precision_right': np.zeros(cv_args['cv'].get_n_splits()),\n",
    "                  'all_folds': []}\n",
    "    \n",
    "    k = 0\n",
    "    max_acc = -np.inf\n",
    "\n",
    "    # Loop through folds\n",
    "    for train_index, val_index in cv_args['cv'].split(X_train, y_train):\n",
    "        print(f\"Running fold {k} with {len(train_index)} training samples and {len(val_index)} validation samples\")\n",
    "        print(f\"Fold {k}: train indices: {train_index[:5]}, val indices: {val_index[:5]}\")  # Print first indices\n",
    "        \n",
    "        X, X_val = X_train[train_index], X_train[val_index]\n",
    "        y, y_val = y_train[train_index], y_train[val_index]\n",
    "        \n",
    "        if model_args['autoencoder']:\n",
    "            y = [X, y]\n",
    "        \n",
    "        print(f\"Training data shape: {X.shape}, Validation data shape: {X_val.shape}\")\n",
    "        \n",
    "        batch_size, C, T = X.shape[:-1]\n",
    "        clear_session()\n",
    "        set_seed(seed)\n",
    "\n",
    "        model_cll, model_params = get_model(model_args['model_name'], model_args['nb_classes'])\n",
    "        model = model_cll(**model_params, Chans=64, Samples=T)\n",
    "        model.compile(loss=compile_args['loss'], optimizer=Adam(compile_args['init_lr']))\n",
    "\n",
    "        history = model.fit(X, y, batch_size=batch_size, **fit_args)\n",
    "        print(f\"Fold {k} training loss: {history.history['loss'][-1]}\")  # Print final loss\n",
    "\n",
    "        if model_args['autoencoder']:\n",
    "            y_prob = model.predict(X_val)[-1]\n",
    "        else:\n",
    "            y_prob = model.predict(X_val)\n",
    "        y_pred = np.argmax(y_prob, axis=1)\n",
    "\n",
    "        print(f\"y_true (val): {y_val[:5]}\")\n",
    "        print(f\"y_pred: {y_pred[:5]}\")\n",
    "        \n",
    "        # Calculate metrics\n",
    "        acc = accuracy_score(y_val, y_pred)\n",
    "        kappa = cohen_kappa_score(y_val, y_pred)\n",
    "        auc = roc_auc_score(y_val, y_prob[:, 1], average='macro') if model_args['nb_classes'] == 2 else None\n",
    "        \n",
    "        # Save metrics for this fold\n",
    "        fold_result = {\n",
    "            'fold_index': k,\n",
    "            'train_indices': train_index.tolist(),\n",
    "            'val_indices': val_index.tolist(),\n",
    "            'accuracy': acc,\n",
    "            'kappa': kappa,\n",
    "            'auc': auc\n",
    "        }\n",
    "        print(f\"Appending results for fold {k}: {fold_result}\")\n",
    "        cv_results['all_folds'].append(fold_result)\n",
    "\n",
    "        # Update overall fold metrics\n",
    "        cv_results['mean_acc'][k] = acc\n",
    "        cv_results['mean_kappa'][k] = kappa\n",
    "        if auc is not None:\n",
    "            cv_results['mean_auc'][k] = auc\n",
    "        \n",
    "        # Save the best model weights\n",
    "        if acc > max_acc:\n",
    "            print('New Max Found!')\n",
    "            max_acc = acc\n",
    "            model.save_weights(f'sbj{load_args[\"sbj\"]}.h5')\n",
    "\n",
    "        k += 1\n",
    "    \n",
    "    # Calculate mean and std metrics\n",
    "    cv_results['std_acc'] = round(cv_results['mean_acc'].std(), 3)\n",
    "    cv_results['mean_acc'] = round(cv_results['mean_acc'].mean(), 3)\n",
    "    cv_results['std_kappa'] = round(cv_results['mean_kappa'].std(), 3)\n",
    "    cv_results['mean_kappa'] = round(cv_results['mean_kappa'].mean(), 3)\n",
    "    cv_results['std_auc'] = round(cv_results['mean_auc'].std(), 3)\n",
    "    cv_results['mean_auc'] = round(cv_results['mean_auc'].mean(), 3)\n",
    "    \n",
    "    print(f\"Final cross-validation results: {cv_results}\")\n",
    "    return cv_results\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "81fdca78",
   "metadata": {
    "id": "uBAeW6J5S68g",
    "papermill": {
     "duration": 0.014607,
     "end_time": "2025-01-20T03:59:49.561767",
     "exception": false,
     "start_time": "2025-01-20T03:59:49.547160",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Config"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "0251f82a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T03:59:49.592900Z",
     "iopub.status.busy": "2025-01-20T03:59:49.592032Z",
     "iopub.status.idle": "2025-01-20T03:59:49.598309Z",
     "shell.execute_reply": "2025-01-20T03:59:49.597148Z"
    },
    "id": "2I3IQnNSS9-a",
    "papermill": {
     "duration": 0.024317,
     "end_time": "2025-01-20T03:59:49.600501",
     "exception": false,
     "start_time": "2025-01-20T03:59:49.576184",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Marcos, use these two variables to run the state of the art. First, for BCICIV2a run all the models.\n",
    "# Remeber that this network DMTL_BCI is an autoencoder. Set the nb_classses parameter depending of the database.\n",
    "# set autoencoder based on the model\n",
    "# We need to run all these tests again. Do not forget to add the recall, preci, and f1 for each class (bci 4, giga 2)\n",
    "db_name = 'GIGA_MI_ME'\n",
    "model_args = dict(model_name = 'EEGNet',\n",
    "                  nb_classes = 2,\n",
    "                  autoencoder = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "4c661145",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T03:59:49.632631Z",
     "iopub.status.busy": "2025-01-20T03:59:49.632206Z",
     "iopub.status.idle": "2025-01-20T03:59:49.649140Z",
     "shell.execute_reply": "2025-01-20T03:59:49.647862Z"
    },
    "id": "tqMhUFoBIc3B",
    "outputId": "1405fd59-1374-4d5d-8e3a-5e7a45c79bba",
    "papermill": {
     "duration": 0.036469,
     "end_time": "2025-01-20T03:59:49.652332",
     "exception": false,
     "start_time": "2025-01-20T03:59:49.615863",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from tensorflow.keras.callbacks import ReduceLROnPlateau, TerminateOnNaN\n",
    "import numpy as np\n",
    "from tensorflow.keras.losses import SparseCategoricalCrossentropy, MeanSquaredError\n",
    "from sklearn.model_selection import StratifiedShuffleSplit\n",
    "\n",
    "if db_name == 'BCICIV2a':\n",
    "  db = Dataset_2a('/kaggle/input/dataset-2a')\n",
    "  fs = db.metadata['sampling_rate']\n",
    "  load_args = dict(db = db,\n",
    "                 fs = fs,\n",
    "                 f_bank = np.asarray([[4., 40.]]),\n",
    "                 vwt = np.asarray([[2.5, 6]]),\n",
    "                 new_fs = 128.)\n",
    "  subjects = np.arange(db.metadata['subjects']) + 1\n",
    "  \n",
    "elif db_name == 'GIGA_MI_ME':\n",
    "  db = GIGA_MI_ME('/kaggle/input/giga-science-gcpds/GIGA_MI_ME')\n",
    "  fs = db.metadata['sampling_rate']\n",
    "\n",
    "  eeg_ch_names = ['Fp1','Fpz','Fp2',\n",
    "                     'AF7','AF3','AFz','AF4','AF8',\n",
    "                    'F7','F5','F3','F1','Fz','F2','F4','F6','F8',\n",
    "                   'FT7','FC5','FC3','FC1','FCz','FC2','FC4','FC6','FT8',\n",
    "                    'T7','C5','C3','C1','Cz','C2','C4','C6','T8',\n",
    "                   'TP7','CP5','CP3','CP1','CPz','CP2','CP4','CP6','TP8',\n",
    "                    'P9','P7','P5','P3','P1','Pz','P2','P4','P6','P8','P10',\n",
    "                    'PO7','PO3','POz','PO4','PO8',\n",
    "                    'O1','Oz','O2',\n",
    "                    'Iz']\n",
    "\n",
    "  # eeg_ch_names = ['Fp1','Fp2',\n",
    "  #                  'AF3','AF4',\n",
    "  #                  'F7','F3','Fz','F4','F8',\n",
    "  #                  'FC5','FC1','FC2','FC6',\n",
    "  #                  'T7','C3','Cz','C4','T8',\n",
    "  #                  'CP5','CP1','CP2','CP6',\n",
    "  #                  'P7','P3','Pz','P4','P8',\n",
    "  #                  'PO3','PO4',\n",
    "  #                  'O1','Oz','O2']\n",
    "\n",
    "  # eeg_ch_names = ['Fp1','Fp2',\n",
    "  #                 'F7','F3','F4','F8',\n",
    "  #                 'T7','C3','C4','T8',\n",
    "  #                 'P7','P3','P4','P8',\n",
    "  #                 'O1','O2']\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "  # eeg_ch_names = ['Fp1','Fp2',\n",
    "  #              'T7','C3','C4','T8',\n",
    "  #              'O1','O2']\n",
    "    \n",
    "\n",
    "\n",
    "  load_args = dict(db = db,\n",
    "                  eeg_ch_names = eeg_ch_names,\n",
    "                  fs = fs,\n",
    "                  f_bank = np.asarray([[4., 40.]]),\n",
    "                  vwt = np.asarray([[2.5, 5]]),\n",
    "                  new_fs = 128.)\n",
    "  subjects = np.arange(db.metadata['subjects']) + 1\n",
    "  subjects = np.delete(subjects, [28,33])\n",
    "  \n",
    "else:\n",
    "  raise ValueError('No valid database name')\n",
    "\n",
    "verbose = 0\n",
    "reduce_lr_on_plateau = ReduceLROnPlateau(monitor = 'loss', factor = 0.1, patience = 30, verbose = verbose, mode = 'min', min_delta = 0.01, min_lr = 0)\n",
    "terminate_on_nan = TerminateOnNaN()\n",
    "callbacks = [reduce_lr_on_plateau, terminate_on_nan]\n",
    "seed = 23\n",
    "\n",
    "cv_args = dict(cv = StratifiedShuffleSplit(n_splits = 5, test_size = 0.2, random_state = seed))\n",
    "\n",
    "compile_args = dict(loss = SparseCategoricalCrossentropy(), #['mse' , SparseCategoricalCrossentropy()]\n",
    "                    init_lr = 1e-2)\n",
    "                      \n",
    "fit_args = dict(epochs = 500,\n",
    "                verbose = verbose,\n",
    "                callbacks = callbacks)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e741dd7d",
   "metadata": {
    "id": "ukhXifxzTaj9",
    "papermill": {
     "duration": 0.022828,
     "end_time": "2025-01-20T03:59:49.698786",
     "exception": false,
     "start_time": "2025-01-20T03:59:49.675958",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Main"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "fa38f2a8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T03:59:49.745107Z",
     "iopub.status.busy": "2025-01-20T03:59:49.744696Z",
     "iopub.status.idle": "2025-01-20T12:03:34.611213Z",
     "shell.execute_reply": "2025-01-20T12:03:34.607901Z"
    },
    "id": "Ymqd_W21y3NK",
    "outputId": "5ca97a2f-f57c-46ee-8f53-f00181ccea90",
    "papermill": {
     "duration": 29024.895435,
     "end_time": "2025-01-20T12:03:34.615818",
     "exception": false,
     "start_time": "2025-01-20T03:59:49.720383",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "sbj =  22\n",
      "Total trials loaded: 200\n",
      "Shape of X: (200, 64, 3584), Shape of y: (200,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (200, 64, 320, 1), y_train shape: (200,)\n",
      "Running fold 0 with 160 training samples and 40 validation samples\n",
      "Fold 0: train indices: [  4 142 183  71  50], val indices: [ 25 107  31 188  83]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 0 training loss: 0.036980170756578445\n",
      "y_true (val): [0 1 0 1 0]\n",
      "y_pred: [0 0 1 1 0]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [4, 142, 183, 71, 50, 179, 125, 131, 117, 60, 82, 55, 89, 21, 157, 47, 5, 42, 11, 19, 23, 172, 148, 99, 140, 34, 146, 115, 48, 147, 93, 2, 182, 138, 43, 57, 158, 187, 128, 18, 160, 33, 97, 14, 44, 177, 196, 61, 56, 174, 46, 67, 8, 101, 7, 41, 129, 184, 198, 98, 190, 74, 169, 24, 159, 173, 15, 70, 163, 58, 186, 72, 27, 87, 81, 26, 122, 96, 120, 65, 119, 102, 123, 167, 94, 130, 135, 77, 192, 175, 20, 37, 16, 0, 180, 144, 52, 145, 106, 139, 63, 9, 36, 153, 126, 17, 59, 29, 164, 30, 85, 156, 53, 79, 38, 118, 124, 193, 171, 35, 13, 151, 110, 95, 149, 136, 165, 168, 109, 88, 84, 92, 3, 121, 114, 143, 1, 10, 195, 28, 197, 103, 137, 152, 113, 112, 32, 189, 62, 199, 78, 68, 176, 161, 22, 155, 108, 80, 181, 166], 'val_indices': [25, 107, 31, 188, 83, 86, 111, 75, 191, 170, 76, 12, 100, 154, 73, 6, 66, 54, 104, 162, 91, 51, 132, 39, 105, 40, 134, 141, 45, 116, 185, 178, 127, 150, 194, 69, 133, 90, 64, 49], 'accuracy': 0.725, 'kappa': 0.44999999999999996, 'auc': 0.825}\n",
      "New Max Found!\n",
      "Running fold 1 with 160 training samples and 40 validation samples\n",
      "Fold 1: train indices: [162  56 128 110  84], val indices: [175 156   7 191  76]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 1 training loss: 0.04143712669610977\n",
      "y_true (val): [1 1 0 1 0]\n",
      "y_pred: [1 1 0 1 0]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [162, 56, 128, 110, 84, 70, 139, 147, 115, 155, 50, 165, 142, 109, 159, 194, 60, 15, 140, 195, 55, 86, 87, 130, 38, 79, 177, 92, 145, 47, 39, 135, 94, 197, 164, 104, 108, 88, 14, 21, 154, 17, 49, 11, 187, 114, 181, 158, 19, 77, 185, 123, 34, 25, 4, 12, 65, 30, 40, 129, 81, 189, 102, 141, 170, 68, 24, 71, 132, 107, 36, 27, 96, 66, 138, 63, 193, 113, 124, 99, 10, 150, 103, 5, 143, 146, 153, 122, 148, 9, 183, 105, 53, 166, 75, 52, 169, 43, 188, 59, 35, 186, 199, 93, 106, 3, 184, 33, 125, 74, 37, 1, 48, 180, 126, 121, 72, 62, 0, 173, 83, 119, 152, 23, 95, 73, 179, 44, 58, 120, 127, 157, 20, 163, 69, 190, 26, 112, 6, 134, 29, 64, 192, 172, 174, 28, 45, 168, 8, 46, 31, 116, 85, 131, 51, 32, 176, 198, 151, 42], 'val_indices': [175, 156, 7, 191, 76, 117, 54, 16, 2, 80, 41, 118, 78, 90, 100, 160, 149, 161, 171, 18, 82, 182, 101, 61, 91, 167, 144, 133, 196, 67, 22, 57, 137, 136, 98, 111, 89, 13, 178, 97], 'accuracy': 0.85, 'kappa': 0.7, 'auc': 0.87}\n",
      "New Max Found!\n",
      "Running fold 2 with 160 training samples and 40 validation samples\n",
      "Fold 2: train indices: [  3 109 165  70  15], val indices: [ 58 152 153  54 171]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 2 training loss: 0.030624210834503174\n",
      "y_true (val): [0 1 1 0 1]\n",
      "y_pred: [0 1 1 0 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [3, 109, 165, 70, 15, 172, 19, 5, 38, 146, 77, 11, 147, 198, 92, 18, 174, 2, 176, 168, 118, 199, 63, 100, 158, 17, 134, 86, 105, 24, 34, 175, 61, 166, 125, 97, 39, 108, 78, 79, 80, 31, 46, 180, 60, 113, 127, 87, 186, 144, 124, 67, 13, 136, 74, 65, 115, 167, 123, 72, 191, 182, 82, 23, 110, 40, 119, 183, 148, 128, 143, 85, 142, 107, 189, 30, 130, 145, 103, 96, 164, 151, 98, 64, 101, 43, 81, 49, 75, 69, 89, 106, 66, 162, 154, 161, 122, 188, 121, 10, 20, 91, 52, 111, 137, 57, 93, 178, 102, 138, 55, 47, 133, 42, 12, 196, 99, 177, 44, 169, 37, 193, 157, 1, 190, 0, 26, 141, 155, 173, 28, 27, 16, 32, 7, 195, 131, 197, 14, 156, 185, 36, 95, 71, 51, 160, 194, 117, 56, 68, 126, 41, 59, 135, 129, 4, 53, 90, 94, 179], 'val_indices': [58, 152, 153, 54, 171, 88, 170, 45, 21, 84, 181, 73, 150, 22, 29, 184, 25, 120, 159, 114, 116, 187, 6, 149, 83, 33, 50, 139, 104, 9, 48, 132, 112, 35, 76, 163, 8, 140, 192, 62], 'accuracy': 0.675, 'kappa': 0.35, 'auc': 0.765}\n",
      "Running fold 3 with 160 training samples and 40 validation samples\n",
      "Fold 3: train indices: [66 43 45 22 69], val indices: [ 20  14 169 144 196]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 3 training loss: 0.09306774288415909\n",
      "y_true (val): [0 0 1 1 1]\n",
      "y_pred: [0 0 1 1 1]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [66, 43, 45, 22, 69, 48, 44, 60, 123, 74, 179, 25, 150, 171, 132, 28, 165, 96, 73, 113, 127, 72, 135, 52, 38, 23, 122, 100, 177, 92, 137, 148, 12, 8, 91, 159, 172, 125, 187, 32, 29, 173, 40, 108, 4, 151, 37, 186, 34, 21, 1, 33, 190, 176, 35, 146, 143, 68, 160, 136, 107, 103, 53, 49, 141, 131, 15, 50, 54, 199, 126, 154, 7, 193, 0, 89, 55, 56, 10, 98, 134, 106, 161, 168, 138, 112, 63, 88, 83, 174, 121, 81, 65, 61, 109, 78, 26, 47, 104, 9, 153, 180, 31, 94, 71, 77, 18, 195, 167, 75, 164, 162, 86, 85, 157, 119, 3, 84, 149, 142, 82, 95, 175, 191, 139, 133, 117, 24, 76, 41, 62, 198, 6, 111, 183, 110, 30, 11, 99, 178, 93, 87, 13, 166, 189, 170, 185, 118, 130, 197, 120, 128, 158, 140, 16, 59, 145, 101, 17, 181], 'val_indices': [20, 14, 169, 144, 196, 105, 67, 182, 36, 39, 97, 57, 64, 58, 79, 90, 188, 194, 155, 129, 102, 192, 27, 5, 124, 116, 80, 184, 152, 163, 46, 156, 114, 147, 115, 70, 19, 2, 51, 42], 'accuracy': 0.85, 'kappa': 0.7, 'auc': 0.9225}\n",
      "Running fold 4 with 160 training samples and 40 validation samples\n",
      "Fold 4: train indices: [ 52   4 194  64  46], val indices: [123  35  89 183   0]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 4 training loss: 0.1073724776506424\n",
      "y_true (val): [1 0 0 1 0]\n",
      "y_pred: [0 0 1 1 0]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [52, 4, 194, 64, 46, 59, 38, 21, 193, 157, 28, 57, 17, 154, 184, 97, 139, 125, 102, 182, 30, 143, 180, 50, 126, 13, 161, 100, 15, 135, 45, 74, 153, 51, 115, 189, 181, 187, 37, 133, 118, 168, 16, 136, 66, 73, 19, 174, 22, 24, 71, 192, 63, 144, 122, 72, 54, 175, 147, 155, 85, 107, 149, 103, 69, 31, 27, 145, 7, 84, 77, 191, 88, 79, 114, 49, 90, 124, 5, 111, 36, 172, 131, 61, 32, 185, 173, 2, 166, 39, 148, 110, 34, 199, 65, 186, 23, 91, 159, 170, 93, 119, 195, 116, 129, 76, 53, 158, 101, 130, 178, 156, 6, 94, 138, 167, 96, 68, 132, 165, 92, 140, 12, 137, 44, 188, 160, 83, 47, 60, 98, 81, 105, 78, 58, 11, 25, 26, 82, 141, 171, 196, 62, 48, 1, 177, 70, 121, 8, 163, 109, 95, 104, 43, 117, 150, 14, 197, 127, 33], 'val_indices': [123, 35, 89, 183, 0, 80, 75, 134, 10, 87, 120, 40, 151, 67, 86, 99, 152, 42, 20, 176, 162, 169, 41, 190, 56, 9, 142, 146, 112, 108, 3, 128, 198, 106, 55, 29, 18, 164, 113, 179], 'accuracy': 0.75, 'kappa': 0.5, 'auc': 0.8775}\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.77, 'mean_kappa': 0.54, 'mean_auc': 0.852, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [4, 142, 183, 71, 50, 179, 125, 131, 117, 60, 82, 55, 89, 21, 157, 47, 5, 42, 11, 19, 23, 172, 148, 99, 140, 34, 146, 115, 48, 147, 93, 2, 182, 138, 43, 57, 158, 187, 128, 18, 160, 33, 97, 14, 44, 177, 196, 61, 56, 174, 46, 67, 8, 101, 7, 41, 129, 184, 198, 98, 190, 74, 169, 24, 159, 173, 15, 70, 163, 58, 186, 72, 27, 87, 81, 26, 122, 96, 120, 65, 119, 102, 123, 167, 94, 130, 135, 77, 192, 175, 20, 37, 16, 0, 180, 144, 52, 145, 106, 139, 63, 9, 36, 153, 126, 17, 59, 29, 164, 30, 85, 156, 53, 79, 38, 118, 124, 193, 171, 35, 13, 151, 110, 95, 149, 136, 165, 168, 109, 88, 84, 92, 3, 121, 114, 143, 1, 10, 195, 28, 197, 103, 137, 152, 113, 112, 32, 189, 62, 199, 78, 68, 176, 161, 22, 155, 108, 80, 181, 166], 'val_indices': [25, 107, 31, 188, 83, 86, 111, 75, 191, 170, 76, 12, 100, 154, 73, 6, 66, 54, 104, 162, 91, 51, 132, 39, 105, 40, 134, 141, 45, 116, 185, 178, 127, 150, 194, 69, 133, 90, 64, 49], 'accuracy': 0.725, 'kappa': 0.44999999999999996, 'auc': 0.825}, {'fold_index': 1, 'train_indices': [162, 56, 128, 110, 84, 70, 139, 147, 115, 155, 50, 165, 142, 109, 159, 194, 60, 15, 140, 195, 55, 86, 87, 130, 38, 79, 177, 92, 145, 47, 39, 135, 94, 197, 164, 104, 108, 88, 14, 21, 154, 17, 49, 11, 187, 114, 181, 158, 19, 77, 185, 123, 34, 25, 4, 12, 65, 30, 40, 129, 81, 189, 102, 141, 170, 68, 24, 71, 132, 107, 36, 27, 96, 66, 138, 63, 193, 113, 124, 99, 10, 150, 103, 5, 143, 146, 153, 122, 148, 9, 183, 105, 53, 166, 75, 52, 169, 43, 188, 59, 35, 186, 199, 93, 106, 3, 184, 33, 125, 74, 37, 1, 48, 180, 126, 121, 72, 62, 0, 173, 83, 119, 152, 23, 95, 73, 179, 44, 58, 120, 127, 157, 20, 163, 69, 190, 26, 112, 6, 134, 29, 64, 192, 172, 174, 28, 45, 168, 8, 46, 31, 116, 85, 131, 51, 32, 176, 198, 151, 42], 'val_indices': [175, 156, 7, 191, 76, 117, 54, 16, 2, 80, 41, 118, 78, 90, 100, 160, 149, 161, 171, 18, 82, 182, 101, 61, 91, 167, 144, 133, 196, 67, 22, 57, 137, 136, 98, 111, 89, 13, 178, 97], 'accuracy': 0.85, 'kappa': 0.7, 'auc': 0.87}, {'fold_index': 2, 'train_indices': [3, 109, 165, 70, 15, 172, 19, 5, 38, 146, 77, 11, 147, 198, 92, 18, 174, 2, 176, 168, 118, 199, 63, 100, 158, 17, 134, 86, 105, 24, 34, 175, 61, 166, 125, 97, 39, 108, 78, 79, 80, 31, 46, 180, 60, 113, 127, 87, 186, 144, 124, 67, 13, 136, 74, 65, 115, 167, 123, 72, 191, 182, 82, 23, 110, 40, 119, 183, 148, 128, 143, 85, 142, 107, 189, 30, 130, 145, 103, 96, 164, 151, 98, 64, 101, 43, 81, 49, 75, 69, 89, 106, 66, 162, 154, 161, 122, 188, 121, 10, 20, 91, 52, 111, 137, 57, 93, 178, 102, 138, 55, 47, 133, 42, 12, 196, 99, 177, 44, 169, 37, 193, 157, 1, 190, 0, 26, 141, 155, 173, 28, 27, 16, 32, 7, 195, 131, 197, 14, 156, 185, 36, 95, 71, 51, 160, 194, 117, 56, 68, 126, 41, 59, 135, 129, 4, 53, 90, 94, 179], 'val_indices': [58, 152, 153, 54, 171, 88, 170, 45, 21, 84, 181, 73, 150, 22, 29, 184, 25, 120, 159, 114, 116, 187, 6, 149, 83, 33, 50, 139, 104, 9, 48, 132, 112, 35, 76, 163, 8, 140, 192, 62], 'accuracy': 0.675, 'kappa': 0.35, 'auc': 0.765}, {'fold_index': 3, 'train_indices': [66, 43, 45, 22, 69, 48, 44, 60, 123, 74, 179, 25, 150, 171, 132, 28, 165, 96, 73, 113, 127, 72, 135, 52, 38, 23, 122, 100, 177, 92, 137, 148, 12, 8, 91, 159, 172, 125, 187, 32, 29, 173, 40, 108, 4, 151, 37, 186, 34, 21, 1, 33, 190, 176, 35, 146, 143, 68, 160, 136, 107, 103, 53, 49, 141, 131, 15, 50, 54, 199, 126, 154, 7, 193, 0, 89, 55, 56, 10, 98, 134, 106, 161, 168, 138, 112, 63, 88, 83, 174, 121, 81, 65, 61, 109, 78, 26, 47, 104, 9, 153, 180, 31, 94, 71, 77, 18, 195, 167, 75, 164, 162, 86, 85, 157, 119, 3, 84, 149, 142, 82, 95, 175, 191, 139, 133, 117, 24, 76, 41, 62, 198, 6, 111, 183, 110, 30, 11, 99, 178, 93, 87, 13, 166, 189, 170, 185, 118, 130, 197, 120, 128, 158, 140, 16, 59, 145, 101, 17, 181], 'val_indices': [20, 14, 169, 144, 196, 105, 67, 182, 36, 39, 97, 57, 64, 58, 79, 90, 188, 194, 155, 129, 102, 192, 27, 5, 124, 116, 80, 184, 152, 163, 46, 156, 114, 147, 115, 70, 19, 2, 51, 42], 'accuracy': 0.85, 'kappa': 0.7, 'auc': 0.9225}, {'fold_index': 4, 'train_indices': [52, 4, 194, 64, 46, 59, 38, 21, 193, 157, 28, 57, 17, 154, 184, 97, 139, 125, 102, 182, 30, 143, 180, 50, 126, 13, 161, 100, 15, 135, 45, 74, 153, 51, 115, 189, 181, 187, 37, 133, 118, 168, 16, 136, 66, 73, 19, 174, 22, 24, 71, 192, 63, 144, 122, 72, 54, 175, 147, 155, 85, 107, 149, 103, 69, 31, 27, 145, 7, 84, 77, 191, 88, 79, 114, 49, 90, 124, 5, 111, 36, 172, 131, 61, 32, 185, 173, 2, 166, 39, 148, 110, 34, 199, 65, 186, 23, 91, 159, 170, 93, 119, 195, 116, 129, 76, 53, 158, 101, 130, 178, 156, 6, 94, 138, 167, 96, 68, 132, 165, 92, 140, 12, 137, 44, 188, 160, 83, 47, 60, 98, 81, 105, 78, 58, 11, 25, 26, 82, 141, 171, 196, 62, 48, 1, 177, 70, 121, 8, 163, 109, 95, 104, 43, 117, 150, 14, 197, 127, 33], 'val_indices': [123, 35, 89, 183, 0, 80, 75, 134, 10, 87, 120, 40, 151, 67, 86, 99, 152, 42, 20, 176, 162, 169, 41, 190, 56, 9, 142, 146, 112, 108, 3, 128, 198, 106, 55, 29, 18, 164, 113, 179], 'accuracy': 0.75, 'kappa': 0.5, 'auc': 0.8775}], 'std_acc': 0.07, 'std_kappa': 0.139, 'std_auc': 0.053}\n",
      "sbj =  23\n",
      "Total trials loaded: 197\n",
      "Shape of X: (197, 64, 3584), Shape of y: (197,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (197, 64, 320, 1), y_train shape: (197,)\n",
      "Running fold 0 with 157 training samples and 40 validation samples\n",
      "Fold 0: train indices: [113 134  84 164  63], val indices: [ 83  73 176  49  76]\n",
      "Training data shape: (157, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 0 training loss: 0.02021985687315464\n",
      "y_true (val): [0 0 1 0 0]\n",
      "y_pred: [1 0 1 1 0]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [113, 134, 84, 164, 63, 55, 95, 37, 20, 0, 79, 138, 1, 4, 47, 87, 19, 58, 56, 158, 61, 71, 77, 111, 115, 101, 143, 180, 103, 62, 72, 48, 43, 179, 14, 78, 57, 23, 147, 186, 90, 82, 163, 187, 2, 28, 171, 18, 141, 104, 185, 27, 42, 189, 96, 169, 172, 156, 81, 107, 26, 175, 174, 191, 128, 97, 67, 193, 74, 24, 188, 22, 181, 36, 106, 126, 161, 110, 92, 149, 105, 100, 168, 17, 50, 46, 38, 145, 52, 194, 122, 7, 8, 15, 99, 157, 118, 33, 29, 137, 13, 5, 184, 11, 93, 35, 192, 165, 177, 94, 10, 117, 173, 32, 167, 195, 119, 30, 34, 59, 70, 135, 80, 182, 159, 120, 86, 9, 170, 123, 154, 65, 60, 155, 68, 178, 142, 108, 190, 150, 144, 89, 146, 41, 16, 3, 124, 129, 44, 166, 116, 53, 153, 112, 88, 162, 114], 'val_indices': [83, 73, 176, 49, 76, 130, 160, 183, 98, 45, 75, 109, 21, 54, 31, 121, 132, 140, 39, 40, 131, 12, 139, 102, 148, 51, 6, 136, 127, 152, 133, 69, 25, 85, 66, 125, 151, 64, 91, 196], 'accuracy': 0.925, 'kappa': 0.85, 'auc': 0.99}\n",
      "New Max Found!\n",
      "Running fold 1 with 157 training samples and 40 validation samples\n",
      "Fold 1: train indices: [151 168  51 186 137], val indices: [147 131  92 176 187]\n",
      "Training data shape: (157, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 1 training loss: 0.018749341368675232\n",
      "y_true (val): [1 1 0 1 1]\n",
      "y_pred: [1 1 0 1 1]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [151, 168, 51, 186, 137, 106, 148, 85, 178, 156, 172, 20, 17, 130, 46, 41, 73, 37, 101, 44, 182, 24, 113, 58, 120, 185, 144, 99, 68, 119, 59, 69, 6, 125, 190, 53, 88, 181, 133, 112, 97, 95, 63, 124, 1, 10, 163, 138, 96, 65, 39, 27, 188, 179, 146, 183, 175, 108, 34, 191, 48, 74, 30, 71, 77, 184, 110, 45, 5, 35, 12, 143, 160, 111, 117, 33, 64, 103, 123, 87, 171, 166, 122, 141, 40, 167, 47, 105, 36, 70, 114, 8, 0, 4, 132, 145, 28, 162, 29, 149, 83, 104, 15, 26, 76, 11, 127, 107, 170, 66, 25, 23, 129, 75, 155, 140, 60, 50, 84, 150, 55, 161, 121, 153, 157, 189, 102, 81, 194, 89, 195, 9, 126, 82, 136, 56, 62, 177, 100, 164, 93, 79, 193, 49, 14, 19, 139, 72, 128, 52, 42, 118, 174, 152, 31, 43, 3], 'val_indices': [147, 131, 92, 176, 187, 165, 135, 90, 142, 98, 115, 54, 7, 18, 196, 109, 80, 116, 67, 86, 16, 61, 192, 13, 159, 180, 32, 57, 158, 38, 21, 94, 134, 22, 91, 2, 173, 169, 154, 78], 'accuracy': 0.925, 'kappa': 0.85, 'auc': 0.9875}\n",
      "Running fold 2 with 157 training samples and 40 validation samples\n",
      "Fold 2: train indices: [ 72 177 113  86 167], val indices: [ 45 147 186  12 168]\n",
      "Training data shape: (157, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 2 training loss: 0.027859436348080635\n",
      "y_true (val): [0 1 1 0 1]\n",
      "y_pred: [0 1 1 0 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [72, 177, 113, 86, 167, 23, 125, 20, 49, 164, 64, 115, 41, 56, 97, 178, 6, 121, 52, 165, 191, 132, 87, 19, 181, 0, 70, 188, 13, 109, 142, 46, 71, 75, 78, 43, 159, 17, 63, 127, 90, 139, 60, 100, 117, 68, 25, 123, 135, 32, 1, 171, 4, 27, 158, 89, 104, 144, 128, 136, 108, 37, 22, 129, 119, 99, 16, 193, 192, 194, 38, 111, 140, 30, 11, 24, 10, 34, 33, 91, 39, 179, 44, 174, 156, 154, 163, 166, 107, 67, 59, 69, 55, 126, 96, 65, 170, 152, 2, 88, 120, 53, 79, 116, 15, 133, 73, 155, 54, 124, 146, 31, 101, 36, 122, 143, 153, 134, 189, 7, 106, 76, 81, 172, 77, 66, 185, 84, 195, 183, 180, 51, 160, 141, 95, 58, 35, 26, 105, 162, 145, 175, 80, 149, 98, 93, 131, 173, 42, 14, 9, 82, 182, 28, 187, 184, 103], 'val_indices': [45, 147, 186, 12, 168, 61, 83, 138, 94, 130, 29, 47, 3, 62, 85, 176, 190, 112, 114, 18, 102, 92, 21, 5, 169, 161, 148, 137, 118, 74, 157, 48, 8, 57, 110, 50, 150, 196, 40, 151], 'accuracy': 0.95, 'kappa': 0.9, 'auc': 1.0}\n",
      "New Max Found!\n",
      "Running fold 3 with 157 training samples and 40 validation samples\n",
      "Fold 3: train indices: [30 81 22 37 32], val indices: [122 180  94  51 132]\n",
      "Training data shape: (157, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 3 training loss: 0.010249219834804535\n",
      "y_true (val): [1 1 0 0 1]\n",
      "y_pred: [1 1 1 1 1]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [30, 81, 22, 37, 32, 105, 9, 29, 18, 170, 151, 82, 31, 149, 26, 15, 147, 83, 92, 178, 195, 11, 50, 12, 176, 54, 148, 124, 73, 3, 102, 177, 25, 60, 159, 86, 173, 16, 119, 140, 72, 1, 138, 7, 136, 98, 196, 4, 117, 152, 108, 181, 44, 17, 134, 172, 169, 75, 121, 71, 41, 193, 35, 61, 55, 123, 155, 165, 95, 156, 91, 85, 38, 74, 49, 89, 101, 184, 107, 188, 130, 106, 28, 40, 68, 179, 90, 65, 34, 141, 0, 84, 93, 185, 43, 118, 111, 104, 77, 78, 69, 45, 145, 160, 47, 183, 168, 62, 24, 139, 96, 6, 164, 110, 48, 66, 143, 194, 109, 146, 13, 56, 52, 53, 128, 23, 115, 137, 175, 63, 126, 190, 120, 129, 33, 88, 166, 21, 8, 59, 187, 157, 116, 162, 144, 174, 125, 163, 131, 133, 99, 76, 10, 171, 158, 87, 192], 'val_indices': [122, 180, 94, 51, 132, 150, 191, 14, 153, 154, 36, 142, 113, 79, 39, 182, 5, 80, 114, 189, 58, 186, 27, 57, 135, 19, 103, 64, 70, 20, 46, 42, 2, 97, 167, 67, 100, 127, 112, 161], 'accuracy': 0.875, 'kappa': 0.75, 'auc': 0.9750000000000001}\n",
      "Running fold 4 with 157 training samples and 40 validation samples\n",
      "Fold 4: train indices: [37 47 48 68 55], val indices: [  5  40  42 138 130]\n",
      "Training data shape: (157, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 4 training loss: 0.024217655882239342\n",
      "y_true (val): [0 0 0 1 1]\n",
      "y_pred: [0 0 0 1 1]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [37, 47, 48, 68, 55, 74, 84, 177, 135, 188, 23, 109, 94, 61, 114, 184, 59, 72, 77, 143, 194, 182, 98, 153, 30, 155, 35, 14, 85, 10, 134, 147, 193, 149, 190, 169, 38, 15, 160, 179, 187, 133, 176, 52, 99, 128, 161, 129, 16, 115, 97, 21, 120, 51, 34, 6, 141, 92, 76, 191, 139, 172, 58, 93, 174, 73, 87, 112, 88, 171, 108, 36, 136, 60, 86, 142, 28, 148, 27, 159, 104, 8, 125, 145, 131, 53, 18, 157, 110, 175, 181, 7, 20, 113, 105, 163, 44, 116, 80, 102, 25, 12, 13, 67, 54, 195, 127, 189, 24, 124, 82, 63, 57, 31, 123, 11, 185, 4, 96, 49, 71, 64, 46, 119, 186, 39, 173, 103, 9, 83, 101, 100, 168, 75, 0, 95, 117, 3, 196, 50, 154, 180, 69, 22, 146, 192, 66, 165, 152, 89, 26, 166, 107, 45, 183, 70, 156], 'val_indices': [5, 40, 42, 138, 130, 126, 158, 17, 170, 178, 140, 79, 137, 164, 90, 1, 151, 33, 78, 132, 122, 62, 118, 144, 29, 2, 32, 43, 81, 41, 150, 167, 162, 121, 65, 106, 91, 19, 111, 56], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 0.9924999999999999}\n",
      "New Max Found!\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.93, 'mean_kappa': 0.86, 'mean_auc': 0.989, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [113, 134, 84, 164, 63, 55, 95, 37, 20, 0, 79, 138, 1, 4, 47, 87, 19, 58, 56, 158, 61, 71, 77, 111, 115, 101, 143, 180, 103, 62, 72, 48, 43, 179, 14, 78, 57, 23, 147, 186, 90, 82, 163, 187, 2, 28, 171, 18, 141, 104, 185, 27, 42, 189, 96, 169, 172, 156, 81, 107, 26, 175, 174, 191, 128, 97, 67, 193, 74, 24, 188, 22, 181, 36, 106, 126, 161, 110, 92, 149, 105, 100, 168, 17, 50, 46, 38, 145, 52, 194, 122, 7, 8, 15, 99, 157, 118, 33, 29, 137, 13, 5, 184, 11, 93, 35, 192, 165, 177, 94, 10, 117, 173, 32, 167, 195, 119, 30, 34, 59, 70, 135, 80, 182, 159, 120, 86, 9, 170, 123, 154, 65, 60, 155, 68, 178, 142, 108, 190, 150, 144, 89, 146, 41, 16, 3, 124, 129, 44, 166, 116, 53, 153, 112, 88, 162, 114], 'val_indices': [83, 73, 176, 49, 76, 130, 160, 183, 98, 45, 75, 109, 21, 54, 31, 121, 132, 140, 39, 40, 131, 12, 139, 102, 148, 51, 6, 136, 127, 152, 133, 69, 25, 85, 66, 125, 151, 64, 91, 196], 'accuracy': 0.925, 'kappa': 0.85, 'auc': 0.99}, {'fold_index': 1, 'train_indices': [151, 168, 51, 186, 137, 106, 148, 85, 178, 156, 172, 20, 17, 130, 46, 41, 73, 37, 101, 44, 182, 24, 113, 58, 120, 185, 144, 99, 68, 119, 59, 69, 6, 125, 190, 53, 88, 181, 133, 112, 97, 95, 63, 124, 1, 10, 163, 138, 96, 65, 39, 27, 188, 179, 146, 183, 175, 108, 34, 191, 48, 74, 30, 71, 77, 184, 110, 45, 5, 35, 12, 143, 160, 111, 117, 33, 64, 103, 123, 87, 171, 166, 122, 141, 40, 167, 47, 105, 36, 70, 114, 8, 0, 4, 132, 145, 28, 162, 29, 149, 83, 104, 15, 26, 76, 11, 127, 107, 170, 66, 25, 23, 129, 75, 155, 140, 60, 50, 84, 150, 55, 161, 121, 153, 157, 189, 102, 81, 194, 89, 195, 9, 126, 82, 136, 56, 62, 177, 100, 164, 93, 79, 193, 49, 14, 19, 139, 72, 128, 52, 42, 118, 174, 152, 31, 43, 3], 'val_indices': [147, 131, 92, 176, 187, 165, 135, 90, 142, 98, 115, 54, 7, 18, 196, 109, 80, 116, 67, 86, 16, 61, 192, 13, 159, 180, 32, 57, 158, 38, 21, 94, 134, 22, 91, 2, 173, 169, 154, 78], 'accuracy': 0.925, 'kappa': 0.85, 'auc': 0.9875}, {'fold_index': 2, 'train_indices': [72, 177, 113, 86, 167, 23, 125, 20, 49, 164, 64, 115, 41, 56, 97, 178, 6, 121, 52, 165, 191, 132, 87, 19, 181, 0, 70, 188, 13, 109, 142, 46, 71, 75, 78, 43, 159, 17, 63, 127, 90, 139, 60, 100, 117, 68, 25, 123, 135, 32, 1, 171, 4, 27, 158, 89, 104, 144, 128, 136, 108, 37, 22, 129, 119, 99, 16, 193, 192, 194, 38, 111, 140, 30, 11, 24, 10, 34, 33, 91, 39, 179, 44, 174, 156, 154, 163, 166, 107, 67, 59, 69, 55, 126, 96, 65, 170, 152, 2, 88, 120, 53, 79, 116, 15, 133, 73, 155, 54, 124, 146, 31, 101, 36, 122, 143, 153, 134, 189, 7, 106, 76, 81, 172, 77, 66, 185, 84, 195, 183, 180, 51, 160, 141, 95, 58, 35, 26, 105, 162, 145, 175, 80, 149, 98, 93, 131, 173, 42, 14, 9, 82, 182, 28, 187, 184, 103], 'val_indices': [45, 147, 186, 12, 168, 61, 83, 138, 94, 130, 29, 47, 3, 62, 85, 176, 190, 112, 114, 18, 102, 92, 21, 5, 169, 161, 148, 137, 118, 74, 157, 48, 8, 57, 110, 50, 150, 196, 40, 151], 'accuracy': 0.95, 'kappa': 0.9, 'auc': 1.0}, {'fold_index': 3, 'train_indices': [30, 81, 22, 37, 32, 105, 9, 29, 18, 170, 151, 82, 31, 149, 26, 15, 147, 83, 92, 178, 195, 11, 50, 12, 176, 54, 148, 124, 73, 3, 102, 177, 25, 60, 159, 86, 173, 16, 119, 140, 72, 1, 138, 7, 136, 98, 196, 4, 117, 152, 108, 181, 44, 17, 134, 172, 169, 75, 121, 71, 41, 193, 35, 61, 55, 123, 155, 165, 95, 156, 91, 85, 38, 74, 49, 89, 101, 184, 107, 188, 130, 106, 28, 40, 68, 179, 90, 65, 34, 141, 0, 84, 93, 185, 43, 118, 111, 104, 77, 78, 69, 45, 145, 160, 47, 183, 168, 62, 24, 139, 96, 6, 164, 110, 48, 66, 143, 194, 109, 146, 13, 56, 52, 53, 128, 23, 115, 137, 175, 63, 126, 190, 120, 129, 33, 88, 166, 21, 8, 59, 187, 157, 116, 162, 144, 174, 125, 163, 131, 133, 99, 76, 10, 171, 158, 87, 192], 'val_indices': [122, 180, 94, 51, 132, 150, 191, 14, 153, 154, 36, 142, 113, 79, 39, 182, 5, 80, 114, 189, 58, 186, 27, 57, 135, 19, 103, 64, 70, 20, 46, 42, 2, 97, 167, 67, 100, 127, 112, 161], 'accuracy': 0.875, 'kappa': 0.75, 'auc': 0.9750000000000001}, {'fold_index': 4, 'train_indices': [37, 47, 48, 68, 55, 74, 84, 177, 135, 188, 23, 109, 94, 61, 114, 184, 59, 72, 77, 143, 194, 182, 98, 153, 30, 155, 35, 14, 85, 10, 134, 147, 193, 149, 190, 169, 38, 15, 160, 179, 187, 133, 176, 52, 99, 128, 161, 129, 16, 115, 97, 21, 120, 51, 34, 6, 141, 92, 76, 191, 139, 172, 58, 93, 174, 73, 87, 112, 88, 171, 108, 36, 136, 60, 86, 142, 28, 148, 27, 159, 104, 8, 125, 145, 131, 53, 18, 157, 110, 175, 181, 7, 20, 113, 105, 163, 44, 116, 80, 102, 25, 12, 13, 67, 54, 195, 127, 189, 24, 124, 82, 63, 57, 31, 123, 11, 185, 4, 96, 49, 71, 64, 46, 119, 186, 39, 173, 103, 9, 83, 101, 100, 168, 75, 0, 95, 117, 3, 196, 50, 154, 180, 69, 22, 146, 192, 66, 165, 152, 89, 26, 166, 107, 45, 183, 70, 156], 'val_indices': [5, 40, 42, 138, 130, 126, 158, 17, 170, 178, 140, 79, 137, 164, 90, 1, 151, 33, 78, 132, 122, 62, 118, 144, 29, 2, 32, 43, 81, 41, 150, 167, 162, 121, 65, 106, 91, 19, 111, 56], 'accuracy': 0.975, 'kappa': 0.95, 'auc': 0.9924999999999999}], 'std_acc': 0.033, 'std_kappa': 0.066, 'std_auc': 0.008}\n",
      "sbj =  24\n",
      "Total trials loaded: 199\n",
      "Shape of X: (199, 64, 3584), Shape of y: (199,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (199, 64, 320, 1), y_train shape: (199,)\n",
      "Running fold 0 with 159 training samples and 40 validation samples\n",
      "Fold 0: train indices: [168 178  79  37 170], val indices: [ 31 161 177 133  76]\n",
      "Training data shape: (159, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 0 training loss: 0.03613583371043205\n",
      "y_true (val): [0 1 1 1 0]\n",
      "y_pred: [1 1 0 0 1]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [168, 178, 79, 37, 170, 84, 72, 20, 14, 4, 1, 130, 135, 109, 102, 182, 55, 166, 71, 108, 92, 47, 77, 179, 127, 114, 56, 58, 87, 115, 125, 21, 19, 185, 193, 0, 61, 104, 180, 23, 63, 2, 57, 96, 82, 171, 175, 78, 70, 28, 136, 18, 174, 159, 142, 162, 27, 181, 42, 197, 97, 62, 26, 117, 48, 43, 112, 81, 113, 98, 67, 86, 74, 24, 144, 22, 165, 36, 194, 139, 119, 145, 93, 191, 176, 106, 101, 123, 17, 50, 46, 38, 196, 190, 52, 156, 167, 157, 7, 8, 15, 100, 163, 9, 33, 29, 129, 13, 5, 183, 11, 94, 35, 187, 150, 160, 111, 95, 10, 107, 143, 32, 146, 116, 121, 105, 30, 34, 59, 80, 148, 124, 169, 65, 60, 186, 68, 138, 120, 118, 195, 189, 158, 89, 147, 41, 16, 3, 172, 188, 44, 173, 154, 53, 151, 192, 88, 164, 155], 'val_indices': [31, 161, 177, 133, 76, 75, 103, 12, 83, 110, 6, 66, 99, 85, 73, 54, 152, 149, 122, 39, 40, 184, 45, 140, 141, 137, 25, 51, 132, 128, 134, 153, 198, 131, 90, 64, 49, 126, 91, 69], 'accuracy': 0.725, 'kappa': 0.44999999999999996, 'auc': 0.8075}\n",
      "New Max Found!\n",
      "Running fold 1 with 159 training samples and 40 validation samples\n",
      "Fold 1: train indices: [ 17 127  87 123 111], val indices: [ 99  95  57  92 135]\n",
      "Training data shape: (159, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 1 training loss: 0.03247952461242676\n",
      "y_true (val): [1 0 0 0 1]\n",
      "y_pred: [1 0 0 0 0]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [17, 127, 87, 123, 111, 73, 1, 126, 151, 164, 59, 68, 139, 20, 129, 81, 58, 193, 3, 69, 147, 51, 44, 165, 46, 172, 37, 169, 144, 119, 48, 65, 195, 171, 185, 24, 6, 30, 96, 180, 53, 89, 161, 101, 156, 187, 153, 150, 128, 192, 122, 10, 109, 74, 97, 154, 39, 27, 63, 84, 173, 186, 115, 168, 34, 71, 85, 176, 134, 45, 5, 35, 12, 182, 41, 191, 108, 145, 33, 64, 149, 102, 88, 142, 130, 107, 133, 175, 40, 121, 104, 47, 118, 36, 70, 167, 8, 131, 0, 4, 184, 188, 28, 146, 29, 178, 76, 105, 15, 26, 77, 11, 106, 197, 120, 66, 25, 23, 157, 75, 158, 190, 60, 50, 79, 140, 55, 43, 113, 114, 138, 82, 100, 93, 183, 9, 163, 83, 152, 56, 62, 196, 141, 125, 94, 98, 103, 49, 14, 19, 179, 72, 112, 52, 42, 137, 162, 124, 31], 'val_indices': [99, 95, 57, 92, 135, 90, 136, 18, 7, 148, 155, 116, 132, 91, 189, 174, 159, 78, 143, 110, 54, 117, 170, 166, 80, 2, 67, 177, 86, 16, 61, 194, 13, 181, 22, 32, 198, 160, 38, 21], 'accuracy': 0.825, 'kappa': 0.65, 'auc': 0.8574999999999999}\n",
      "New Max Found!\n",
      "Running fold 2 with 159 training samples and 40 validation samples\n",
      "Fold 2: train indices: [ 94  85  87 178 144], val indices: [ 33 151 152  83 170]\n",
      "Training data shape: (159, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 2 training loss: 0.025276564061641693\n",
      "y_true (val): [0 1 1 0 1]\n",
      "y_pred: [0 1 1 1 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [94, 85, 87, 178, 144, 163, 24, 135, 187, 36, 89, 190, 32, 157, 177, 174, 173, 181, 117, 58, 120, 26, 105, 184, 91, 98, 69, 65, 1, 3, 68, 84, 107, 124, 38, 77, 81, 164, 44, 42, 93, 179, 70, 43, 142, 39, 101, 153, 171, 75, 197, 114, 145, 140, 112, 166, 122, 66, 34, 110, 51, 60, 121, 74, 56, 185, 116, 143, 118, 82, 99, 165, 167, 90, 182, 106, 154, 46, 141, 175, 97, 72, 49, 52, 78, 22, 17, 80, 137, 0, 161, 189, 160, 156, 172, 108, 95, 71, 67, 96, 127, 136, 79, 53, 129, 146, 40, 4, 123, 20, 30, 102, 55, 176, 64, 159, 35, 192, 125, 31, 104, 86, 92, 126, 195, 133, 193, 16, 128, 73, 14, 19, 2, 7, 194, 168, 196, 23, 155, 198, 15, 28, 37, 13, 188, 109, 150, 25, 10, 147, 130, 63, 100, 134, 11, 59, 41, 27, 132], 'val_indices': [33, 151, 152, 83, 170, 5, 169, 21, 12, 29, 180, 6, 149, 9, 48, 183, 54, 119, 158, 113, 115, 186, 8, 148, 61, 50, 88, 138, 103, 45, 47, 131, 111, 76, 62, 162, 18, 139, 191, 57], 'accuracy': 0.725, 'kappa': 0.44999999999999996, 'auc': 0.8524999999999999}\n",
      "Running fold 3 with 159 training samples and 40 validation samples\n",
      "Fold 3: train indices: [ 63  71  75 107  94], val indices: [123 181  96  27 133]\n",
      "Training data shape: (159, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 3 training loss: 0.04185977205634117\n",
      "y_true (val): [1 1 0 0 1]\n",
      "y_pred: [0 0 0 0 0]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [63, 71, 75, 107, 94, 22, 73, 138, 100, 117, 15, 112, 196, 119, 59, 190, 45, 31, 61, 146, 30, 38, 99, 188, 160, 105, 54, 103, 8, 92, 47, 137, 52, 89, 171, 186, 65, 87, 29, 62, 40, 116, 16, 134, 26, 118, 102, 173, 1, 145, 97, 142, 35, 132, 184, 4, 198, 172, 82, 106, 9, 17, 135, 72, 110, 66, 12, 34, 149, 189, 150, 21, 129, 53, 48, 50, 83, 81, 74, 120, 157, 152, 156, 131, 130, 86, 85, 60, 178, 109, 77, 44, 18, 158, 0, 25, 41, 174, 37, 127, 147, 98, 93, 13, 56, 55, 148, 170, 91, 164, 180, 3, 24, 161, 153, 11, 6, 192, 108, 49, 88, 144, 122, 195, 141, 169, 84, 76, 95, 32, 197, 78, 194, 139, 176, 175, 23, 33, 167, 7, 69, 28, 163, 111, 124, 182, 159, 121, 125, 179, 177, 166, 126, 43, 10, 140, 185, 68, 165], 'val_indices': [123, 181, 96, 27, 133, 151, 193, 14, 154, 155, 36, 143, 114, 79, 39, 183, 5, 80, 115, 191, 46, 187, 57, 58, 136, 90, 104, 64, 70, 19, 20, 2, 51, 42, 168, 67, 101, 128, 113, 162], 'accuracy': 0.675, 'kappa': 0.35, 'auc': 0.6875}\n",
      "Running fold 4 with 159 training samples and 40 validation samples\n",
      "Fold 4: train indices: [144  37 124 181  93], val indices: [ 56 163   5  40 133]\n",
      "Training data shape: (159, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 4 training loss: 0.017935283482074738\n",
      "y_true (val): [0 1 0 0 1]\n",
      "y_pred: [0 1 1 0 0]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [144, 37, 124, 181, 93, 137, 103, 61, 59, 105, 196, 39, 95, 23, 170, 64, 164, 160, 121, 143, 10, 184, 35, 14, 82, 116, 69, 97, 157, 175, 107, 52, 177, 149, 114, 85, 109, 67, 167, 189, 47, 76, 173, 113, 38, 15, 48, 6, 30, 117, 150, 178, 108, 80, 155, 147, 190, 195, 16, 132, 161, 98, 21, 34, 51, 55, 77, 58, 192, 94, 191, 74, 88, 130, 89, 148, 153, 176, 36, 128, 60, 118, 87, 102, 28, 120, 27, 182, 194, 8, 162, 125, 115, 53, 96, 129, 166, 135, 197, 75, 7, 101, 0, 136, 169, 140, 44, 104, 86, 100, 25, 188, 12, 13, 68, 54, 154, 174, 46, 24, 111, 83, 63, 57, 31, 180, 11, 72, 4, 49, 3, 84, 186, 142, 134, 20, 9, 73, 156, 18, 185, 50, 198, 183, 70, 22, 106, 146, 66, 187, 126, 90, 26, 110, 172, 45, 158, 71, 99], 'val_indices': [56, 163, 5, 40, 133, 145, 17, 1, 19, 42, 65, 131, 32, 159, 41, 171, 79, 141, 112, 62, 152, 92, 91, 179, 165, 168, 33, 151, 193, 127, 78, 29, 43, 139, 122, 138, 119, 2, 81, 123], 'accuracy': 0.725, 'kappa': 0.44999999999999996, 'auc': 0.7975}\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.735, 'mean_kappa': 0.47, 'mean_auc': 0.801, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [168, 178, 79, 37, 170, 84, 72, 20, 14, 4, 1, 130, 135, 109, 102, 182, 55, 166, 71, 108, 92, 47, 77, 179, 127, 114, 56, 58, 87, 115, 125, 21, 19, 185, 193, 0, 61, 104, 180, 23, 63, 2, 57, 96, 82, 171, 175, 78, 70, 28, 136, 18, 174, 159, 142, 162, 27, 181, 42, 197, 97, 62, 26, 117, 48, 43, 112, 81, 113, 98, 67, 86, 74, 24, 144, 22, 165, 36, 194, 139, 119, 145, 93, 191, 176, 106, 101, 123, 17, 50, 46, 38, 196, 190, 52, 156, 167, 157, 7, 8, 15, 100, 163, 9, 33, 29, 129, 13, 5, 183, 11, 94, 35, 187, 150, 160, 111, 95, 10, 107, 143, 32, 146, 116, 121, 105, 30, 34, 59, 80, 148, 124, 169, 65, 60, 186, 68, 138, 120, 118, 195, 189, 158, 89, 147, 41, 16, 3, 172, 188, 44, 173, 154, 53, 151, 192, 88, 164, 155], 'val_indices': [31, 161, 177, 133, 76, 75, 103, 12, 83, 110, 6, 66, 99, 85, 73, 54, 152, 149, 122, 39, 40, 184, 45, 140, 141, 137, 25, 51, 132, 128, 134, 153, 198, 131, 90, 64, 49, 126, 91, 69], 'accuracy': 0.725, 'kappa': 0.44999999999999996, 'auc': 0.8075}, {'fold_index': 1, 'train_indices': [17, 127, 87, 123, 111, 73, 1, 126, 151, 164, 59, 68, 139, 20, 129, 81, 58, 193, 3, 69, 147, 51, 44, 165, 46, 172, 37, 169, 144, 119, 48, 65, 195, 171, 185, 24, 6, 30, 96, 180, 53, 89, 161, 101, 156, 187, 153, 150, 128, 192, 122, 10, 109, 74, 97, 154, 39, 27, 63, 84, 173, 186, 115, 168, 34, 71, 85, 176, 134, 45, 5, 35, 12, 182, 41, 191, 108, 145, 33, 64, 149, 102, 88, 142, 130, 107, 133, 175, 40, 121, 104, 47, 118, 36, 70, 167, 8, 131, 0, 4, 184, 188, 28, 146, 29, 178, 76, 105, 15, 26, 77, 11, 106, 197, 120, 66, 25, 23, 157, 75, 158, 190, 60, 50, 79, 140, 55, 43, 113, 114, 138, 82, 100, 93, 183, 9, 163, 83, 152, 56, 62, 196, 141, 125, 94, 98, 103, 49, 14, 19, 179, 72, 112, 52, 42, 137, 162, 124, 31], 'val_indices': [99, 95, 57, 92, 135, 90, 136, 18, 7, 148, 155, 116, 132, 91, 189, 174, 159, 78, 143, 110, 54, 117, 170, 166, 80, 2, 67, 177, 86, 16, 61, 194, 13, 181, 22, 32, 198, 160, 38, 21], 'accuracy': 0.825, 'kappa': 0.65, 'auc': 0.8574999999999999}, {'fold_index': 2, 'train_indices': [94, 85, 87, 178, 144, 163, 24, 135, 187, 36, 89, 190, 32, 157, 177, 174, 173, 181, 117, 58, 120, 26, 105, 184, 91, 98, 69, 65, 1, 3, 68, 84, 107, 124, 38, 77, 81, 164, 44, 42, 93, 179, 70, 43, 142, 39, 101, 153, 171, 75, 197, 114, 145, 140, 112, 166, 122, 66, 34, 110, 51, 60, 121, 74, 56, 185, 116, 143, 118, 82, 99, 165, 167, 90, 182, 106, 154, 46, 141, 175, 97, 72, 49, 52, 78, 22, 17, 80, 137, 0, 161, 189, 160, 156, 172, 108, 95, 71, 67, 96, 127, 136, 79, 53, 129, 146, 40, 4, 123, 20, 30, 102, 55, 176, 64, 159, 35, 192, 125, 31, 104, 86, 92, 126, 195, 133, 193, 16, 128, 73, 14, 19, 2, 7, 194, 168, 196, 23, 155, 198, 15, 28, 37, 13, 188, 109, 150, 25, 10, 147, 130, 63, 100, 134, 11, 59, 41, 27, 132], 'val_indices': [33, 151, 152, 83, 170, 5, 169, 21, 12, 29, 180, 6, 149, 9, 48, 183, 54, 119, 158, 113, 115, 186, 8, 148, 61, 50, 88, 138, 103, 45, 47, 131, 111, 76, 62, 162, 18, 139, 191, 57], 'accuracy': 0.725, 'kappa': 0.44999999999999996, 'auc': 0.8524999999999999}, {'fold_index': 3, 'train_indices': [63, 71, 75, 107, 94, 22, 73, 138, 100, 117, 15, 112, 196, 119, 59, 190, 45, 31, 61, 146, 30, 38, 99, 188, 160, 105, 54, 103, 8, 92, 47, 137, 52, 89, 171, 186, 65, 87, 29, 62, 40, 116, 16, 134, 26, 118, 102, 173, 1, 145, 97, 142, 35, 132, 184, 4, 198, 172, 82, 106, 9, 17, 135, 72, 110, 66, 12, 34, 149, 189, 150, 21, 129, 53, 48, 50, 83, 81, 74, 120, 157, 152, 156, 131, 130, 86, 85, 60, 178, 109, 77, 44, 18, 158, 0, 25, 41, 174, 37, 127, 147, 98, 93, 13, 56, 55, 148, 170, 91, 164, 180, 3, 24, 161, 153, 11, 6, 192, 108, 49, 88, 144, 122, 195, 141, 169, 84, 76, 95, 32, 197, 78, 194, 139, 176, 175, 23, 33, 167, 7, 69, 28, 163, 111, 124, 182, 159, 121, 125, 179, 177, 166, 126, 43, 10, 140, 185, 68, 165], 'val_indices': [123, 181, 96, 27, 133, 151, 193, 14, 154, 155, 36, 143, 114, 79, 39, 183, 5, 80, 115, 191, 46, 187, 57, 58, 136, 90, 104, 64, 70, 19, 20, 2, 51, 42, 168, 67, 101, 128, 113, 162], 'accuracy': 0.675, 'kappa': 0.35, 'auc': 0.6875}, {'fold_index': 4, 'train_indices': [144, 37, 124, 181, 93, 137, 103, 61, 59, 105, 196, 39, 95, 23, 170, 64, 164, 160, 121, 143, 10, 184, 35, 14, 82, 116, 69, 97, 157, 175, 107, 52, 177, 149, 114, 85, 109, 67, 167, 189, 47, 76, 173, 113, 38, 15, 48, 6, 30, 117, 150, 178, 108, 80, 155, 147, 190, 195, 16, 132, 161, 98, 21, 34, 51, 55, 77, 58, 192, 94, 191, 74, 88, 130, 89, 148, 153, 176, 36, 128, 60, 118, 87, 102, 28, 120, 27, 182, 194, 8, 162, 125, 115, 53, 96, 129, 166, 135, 197, 75, 7, 101, 0, 136, 169, 140, 44, 104, 86, 100, 25, 188, 12, 13, 68, 54, 154, 174, 46, 24, 111, 83, 63, 57, 31, 180, 11, 72, 4, 49, 3, 84, 186, 142, 134, 20, 9, 73, 156, 18, 185, 50, 198, 183, 70, 22, 106, 146, 66, 187, 126, 90, 26, 110, 172, 45, 158, 71, 99], 'val_indices': [56, 163, 5, 40, 133, 145, 17, 1, 19, 42, 65, 131, 32, 159, 41, 171, 79, 141, 112, 62, 152, 92, 91, 179, 165, 168, 33, 151, 193, 127, 78, 29, 43, 139, 122, 138, 119, 2, 81, 123], 'accuracy': 0.725, 'kappa': 0.44999999999999996, 'auc': 0.7975}], 'std_acc': 0.049, 'std_kappa': 0.098, 'std_auc': 0.061}\n",
      "sbj =  25\n",
      "Total trials loaded: 196\n",
      "Shape of X: (196, 64, 3584), Shape of y: (196,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (196, 64, 320, 1), y_train shape: (196,)\n",
      "Running fold 0 with 156 training samples and 40 validation samples\n",
      "Fold 0: train indices: [112 127  84 109  63], val indices: [ 83  73 175  66  76]\n",
      "Training data shape: (156, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 0 training loss: 0.05240112543106079\n",
      "y_true (val): [0 0 1 0 0]\n",
      "y_pred: [1 0 1 1 0]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [112, 127, 84, 109, 63, 55, 94, 37, 20, 0, 79, 154, 1, 4, 47, 87, 19, 58, 56, 157, 61, 71, 77, 136, 102, 191, 142, 148, 161, 62, 72, 174, 43, 178, 14, 78, 57, 23, 143, 111, 90, 82, 162, 134, 2, 28, 113, 18, 140, 141, 146, 27, 42, 128, 95, 168, 164, 125, 81, 106, 26, 110, 185, 190, 177, 96, 67, 192, 74, 24, 165, 22, 194, 36, 156, 133, 160, 184, 91, 137, 104, 99, 100, 17, 50, 46, 38, 144, 52, 187, 121, 7, 8, 15, 167, 117, 33, 29, 149, 13, 5, 189, 11, 92, 35, 172, 169, 166, 93, 10, 123, 180, 32, 155, 152, 118, 30, 34, 59, 70, 183, 80, 181, 158, 119, 86, 9, 103, 122, 153, 65, 60, 116, 68, 105, 186, 173, 171, 163, 176, 89, 145, 41, 16, 3, 115, 179, 44, 193, 107, 53, 170, 98, 88, 114, 188], 'val_indices': [83, 73, 175, 66, 76, 129, 159, 182, 97, 12, 69, 108, 48, 54, 31, 120, 131, 139, 25, 40, 130, 49, 138, 101, 147, 6, 45, 135, 126, 151, 132, 64, 51, 21, 75, 124, 150, 85, 39, 195], 'accuracy': 0.85, 'kappa': 0.7, 'auc': 0.91}\n",
      "New Max Found!\n",
      "Running fold 1 with 156 training samples and 40 validation samples\n",
      "Fold 1: train indices: [122 167  51 192 181], val indices: [146 130  89 175 186]\n",
      "Training data shape: (156, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 1 training loss: 0.12456293404102325\n",
      "y_true (val): [1 1 0 1 1]\n",
      "y_pred: [1 1 0 1 1]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [122, 167, 51, 192, 181, 185, 147, 79, 148, 155, 171, 20, 17, 129, 46, 50, 72, 37, 100, 44, 188, 62, 154, 56, 119, 116, 143, 98, 84, 118, 69, 25, 6, 120, 189, 52, 60, 180, 132, 113, 109, 94, 187, 123, 1, 10, 162, 4, 95, 65, 39, 27, 92, 159, 163, 182, 174, 106, 34, 152, 48, 184, 30, 76, 183, 128, 45, 5, 85, 12, 107, 151, 110, 82, 75, 74, 102, 165, 96, 170, 127, 140, 156, 40, 166, 58, 104, 36, 68, 117, 8, 0, 28, 131, 144, 73, 161, 29, 126, 41, 112, 15, 26, 63, 11, 177, 136, 169, 24, 77, 23, 137, 88, 190, 139, 59, 35, 66, 149, 87, 160, 178, 125, 121, 103, 64, 193, 135, 70, 194, 9, 145, 81, 142, 55, 53, 176, 99, 101, 33, 83, 105, 49, 14, 19, 138, 71, 150, 47, 42, 111, 173, 124, 31, 43, 3], 'val_indices': [146, 130, 89, 175, 186, 164, 134, 90, 141, 97, 114, 54, 7, 18, 195, 108, 80, 115, 67, 86, 16, 61, 191, 13, 158, 179, 32, 57, 157, 38, 21, 93, 133, 22, 91, 2, 172, 168, 153, 78], 'accuracy': 0.7, 'kappa': 0.4, 'auc': 0.87}\n",
      "Running fold 2 with 156 training samples and 40 validation samples\n",
      "Fold 2: train indices: [ 72 112 155  95 123], val indices: [ 29 146 185  12 167]\n",
      "Training data shape: (156, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 2 training loss: 0.10371618717908859\n",
      "y_true (val): [0 1 1 0 1]\n",
      "y_pred: [0 1 1 0 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [72, 112, 155, 95, 123, 23, 131, 20, 49, 124, 64, 166, 41, 56, 96, 177, 6, 120, 52, 164, 127, 143, 86, 19, 180, 0, 70, 187, 13, 133, 176, 46, 71, 75, 78, 43, 153, 17, 63, 126, 89, 116, 60, 163, 142, 68, 25, 122, 134, 32, 1, 193, 4, 27, 172, 88, 145, 152, 103, 139, 107, 37, 22, 140, 141, 98, 16, 178, 132, 183, 38, 188, 190, 30, 11, 24, 10, 34, 33, 90, 39, 108, 44, 173, 102, 181, 114, 165, 99, 67, 59, 69, 55, 125, 84, 65, 162, 169, 2, 87, 119, 53, 79, 192, 15, 161, 73, 104, 186, 144, 151, 31, 106, 36, 121, 170, 115, 128, 171, 7, 105, 76, 81, 77, 66, 148, 83, 110, 154, 179, 51, 159, 135, 94, 58, 35, 26, 118, 191, 184, 174, 80, 157, 182, 93, 194, 130, 42, 14, 9, 82, 158, 28, 97, 100, 138], 'val_indices': [29, 146, 185, 12, 167, 61, 62, 137, 45, 129, 54, 47, 3, 8, 85, 175, 189, 111, 113, 18, 101, 92, 21, 5, 168, 160, 147, 136, 117, 74, 156, 48, 91, 57, 109, 50, 149, 195, 40, 150], 'accuracy': 0.85, 'kappa': 0.7, 'auc': 0.9375}\n",
      "Running fold 3 with 156 training samples and 40 validation samples\n",
      "Fold 3: train indices: [137  69  22  37  32], val indices: [121 179  93  51 131]\n",
      "Training data shape: (156, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 3 training loss: 0.08515843003988266\n",
      "y_true (val): [1 1 0 0 1]\n",
      "y_pred: [1 1 0 0 1]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [137, 69, 22, 37, 32, 180, 9, 62, 55, 114, 157, 4, 81, 195, 26, 15, 174, 82, 18, 167, 164, 95, 12, 78, 178, 34, 125, 124, 88, 60, 169, 186, 25, 91, 108, 56, 107, 16, 173, 147, 30, 1, 128, 21, 135, 120, 146, 63, 116, 170, 119, 127, 43, 17, 133, 171, 101, 74, 193, 89, 92, 168, 72, 59, 50, 115, 140, 123, 75, 143, 73, 84, 31, 90, 48, 47, 136, 191, 109, 148, 129, 154, 28, 3, 68, 145, 7, 85, 45, 106, 0, 40, 52, 192, 83, 159, 100, 184, 76, 77, 53, 38, 144, 176, 41, 150, 163, 11, 24, 138, 23, 6, 132, 156, 86, 65, 142, 194, 139, 110, 13, 54, 35, 44, 172, 33, 175, 104, 130, 61, 97, 122, 118, 105, 87, 29, 165, 94, 8, 49, 162, 189, 155, 117, 177, 98, 183, 158, 187, 182, 71, 10, 151, 161, 66, 103], 'val_indices': [121, 179, 93, 51, 131, 149, 190, 14, 152, 153, 36, 141, 112, 79, 39, 181, 5, 80, 113, 188, 58, 185, 27, 57, 134, 19, 102, 64, 70, 20, 46, 42, 2, 96, 166, 67, 99, 126, 111, 160], 'accuracy': 0.825, 'kappa': 0.65, 'auc': 0.9624999999999999}\n",
      "Running fold 4 with 156 training samples and 40 validation samples\n",
      "Fold 4: train indices: [106  68  55  24 191], val indices: [131  17 177  43  40]\n",
      "Training data shape: (156, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 4 training loss: 0.20132242143154144\n",
      "y_true (val): [1 0 1 0 0]\n",
      "y_pred: [1 1 1 0 1]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [106, 68, 55, 24, 191, 80, 138, 64, 103, 67, 126, 87, 100, 174, 72, 10, 180, 165, 7, 152, 109, 21, 104, 74, 49, 25, 35, 45, 135, 48, 127, 159, 194, 190, 71, 123, 6, 61, 144, 50, 51, 139, 143, 183, 122, 70, 185, 26, 175, 69, 168, 119, 148, 38, 178, 128, 28, 53, 116, 96, 36, 86, 115, 101, 82, 147, 14, 91, 173, 95, 141, 52, 124, 57, 153, 134, 39, 3, 118, 170, 186, 63, 75, 151, 188, 182, 166, 145, 60, 98, 58, 16, 34, 93, 31, 158, 113, 132, 4, 184, 84, 22, 27, 73, 97, 59, 111, 44, 77, 13, 23, 54, 47, 189, 112, 37, 156, 167, 0, 94, 172, 195, 140, 171, 99, 162, 107, 154, 102, 20, 18, 155, 9, 187, 76, 105, 114, 83, 15, 179, 142, 85, 176, 46, 92, 133, 30, 146, 66, 181, 88, 164, 160, 11, 8, 12], 'val_indices': [131, 17, 177, 43, 40, 192, 5, 33, 89, 121, 1, 29, 161, 79, 163, 120, 2, 32, 130, 108, 157, 65, 117, 90, 193, 169, 56, 150, 78, 137, 62, 125, 19, 136, 42, 41, 149, 110, 81, 129], 'accuracy': 0.65, 'kappa': 0.30000000000000004, 'auc': 0.7374999999999999}\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.775, 'mean_kappa': 0.55, 'mean_auc': 0.884, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [112, 127, 84, 109, 63, 55, 94, 37, 20, 0, 79, 154, 1, 4, 47, 87, 19, 58, 56, 157, 61, 71, 77, 136, 102, 191, 142, 148, 161, 62, 72, 174, 43, 178, 14, 78, 57, 23, 143, 111, 90, 82, 162, 134, 2, 28, 113, 18, 140, 141, 146, 27, 42, 128, 95, 168, 164, 125, 81, 106, 26, 110, 185, 190, 177, 96, 67, 192, 74, 24, 165, 22, 194, 36, 156, 133, 160, 184, 91, 137, 104, 99, 100, 17, 50, 46, 38, 144, 52, 187, 121, 7, 8, 15, 167, 117, 33, 29, 149, 13, 5, 189, 11, 92, 35, 172, 169, 166, 93, 10, 123, 180, 32, 155, 152, 118, 30, 34, 59, 70, 183, 80, 181, 158, 119, 86, 9, 103, 122, 153, 65, 60, 116, 68, 105, 186, 173, 171, 163, 176, 89, 145, 41, 16, 3, 115, 179, 44, 193, 107, 53, 170, 98, 88, 114, 188], 'val_indices': [83, 73, 175, 66, 76, 129, 159, 182, 97, 12, 69, 108, 48, 54, 31, 120, 131, 139, 25, 40, 130, 49, 138, 101, 147, 6, 45, 135, 126, 151, 132, 64, 51, 21, 75, 124, 150, 85, 39, 195], 'accuracy': 0.85, 'kappa': 0.7, 'auc': 0.91}, {'fold_index': 1, 'train_indices': [122, 167, 51, 192, 181, 185, 147, 79, 148, 155, 171, 20, 17, 129, 46, 50, 72, 37, 100, 44, 188, 62, 154, 56, 119, 116, 143, 98, 84, 118, 69, 25, 6, 120, 189, 52, 60, 180, 132, 113, 109, 94, 187, 123, 1, 10, 162, 4, 95, 65, 39, 27, 92, 159, 163, 182, 174, 106, 34, 152, 48, 184, 30, 76, 183, 128, 45, 5, 85, 12, 107, 151, 110, 82, 75, 74, 102, 165, 96, 170, 127, 140, 156, 40, 166, 58, 104, 36, 68, 117, 8, 0, 28, 131, 144, 73, 161, 29, 126, 41, 112, 15, 26, 63, 11, 177, 136, 169, 24, 77, 23, 137, 88, 190, 139, 59, 35, 66, 149, 87, 160, 178, 125, 121, 103, 64, 193, 135, 70, 194, 9, 145, 81, 142, 55, 53, 176, 99, 101, 33, 83, 105, 49, 14, 19, 138, 71, 150, 47, 42, 111, 173, 124, 31, 43, 3], 'val_indices': [146, 130, 89, 175, 186, 164, 134, 90, 141, 97, 114, 54, 7, 18, 195, 108, 80, 115, 67, 86, 16, 61, 191, 13, 158, 179, 32, 57, 157, 38, 21, 93, 133, 22, 91, 2, 172, 168, 153, 78], 'accuracy': 0.7, 'kappa': 0.4, 'auc': 0.87}, {'fold_index': 2, 'train_indices': [72, 112, 155, 95, 123, 23, 131, 20, 49, 124, 64, 166, 41, 56, 96, 177, 6, 120, 52, 164, 127, 143, 86, 19, 180, 0, 70, 187, 13, 133, 176, 46, 71, 75, 78, 43, 153, 17, 63, 126, 89, 116, 60, 163, 142, 68, 25, 122, 134, 32, 1, 193, 4, 27, 172, 88, 145, 152, 103, 139, 107, 37, 22, 140, 141, 98, 16, 178, 132, 183, 38, 188, 190, 30, 11, 24, 10, 34, 33, 90, 39, 108, 44, 173, 102, 181, 114, 165, 99, 67, 59, 69, 55, 125, 84, 65, 162, 169, 2, 87, 119, 53, 79, 192, 15, 161, 73, 104, 186, 144, 151, 31, 106, 36, 121, 170, 115, 128, 171, 7, 105, 76, 81, 77, 66, 148, 83, 110, 154, 179, 51, 159, 135, 94, 58, 35, 26, 118, 191, 184, 174, 80, 157, 182, 93, 194, 130, 42, 14, 9, 82, 158, 28, 97, 100, 138], 'val_indices': [29, 146, 185, 12, 167, 61, 62, 137, 45, 129, 54, 47, 3, 8, 85, 175, 189, 111, 113, 18, 101, 92, 21, 5, 168, 160, 147, 136, 117, 74, 156, 48, 91, 57, 109, 50, 149, 195, 40, 150], 'accuracy': 0.85, 'kappa': 0.7, 'auc': 0.9375}, {'fold_index': 3, 'train_indices': [137, 69, 22, 37, 32, 180, 9, 62, 55, 114, 157, 4, 81, 195, 26, 15, 174, 82, 18, 167, 164, 95, 12, 78, 178, 34, 125, 124, 88, 60, 169, 186, 25, 91, 108, 56, 107, 16, 173, 147, 30, 1, 128, 21, 135, 120, 146, 63, 116, 170, 119, 127, 43, 17, 133, 171, 101, 74, 193, 89, 92, 168, 72, 59, 50, 115, 140, 123, 75, 143, 73, 84, 31, 90, 48, 47, 136, 191, 109, 148, 129, 154, 28, 3, 68, 145, 7, 85, 45, 106, 0, 40, 52, 192, 83, 159, 100, 184, 76, 77, 53, 38, 144, 176, 41, 150, 163, 11, 24, 138, 23, 6, 132, 156, 86, 65, 142, 194, 139, 110, 13, 54, 35, 44, 172, 33, 175, 104, 130, 61, 97, 122, 118, 105, 87, 29, 165, 94, 8, 49, 162, 189, 155, 117, 177, 98, 183, 158, 187, 182, 71, 10, 151, 161, 66, 103], 'val_indices': [121, 179, 93, 51, 131, 149, 190, 14, 152, 153, 36, 141, 112, 79, 39, 181, 5, 80, 113, 188, 58, 185, 27, 57, 134, 19, 102, 64, 70, 20, 46, 42, 2, 96, 166, 67, 99, 126, 111, 160], 'accuracy': 0.825, 'kappa': 0.65, 'auc': 0.9624999999999999}, {'fold_index': 4, 'train_indices': [106, 68, 55, 24, 191, 80, 138, 64, 103, 67, 126, 87, 100, 174, 72, 10, 180, 165, 7, 152, 109, 21, 104, 74, 49, 25, 35, 45, 135, 48, 127, 159, 194, 190, 71, 123, 6, 61, 144, 50, 51, 139, 143, 183, 122, 70, 185, 26, 175, 69, 168, 119, 148, 38, 178, 128, 28, 53, 116, 96, 36, 86, 115, 101, 82, 147, 14, 91, 173, 95, 141, 52, 124, 57, 153, 134, 39, 3, 118, 170, 186, 63, 75, 151, 188, 182, 166, 145, 60, 98, 58, 16, 34, 93, 31, 158, 113, 132, 4, 184, 84, 22, 27, 73, 97, 59, 111, 44, 77, 13, 23, 54, 47, 189, 112, 37, 156, 167, 0, 94, 172, 195, 140, 171, 99, 162, 107, 154, 102, 20, 18, 155, 9, 187, 76, 105, 114, 83, 15, 179, 142, 85, 176, 46, 92, 133, 30, 146, 66, 181, 88, 164, 160, 11, 8, 12], 'val_indices': [131, 17, 177, 43, 40, 192, 5, 33, 89, 121, 1, 29, 161, 79, 163, 120, 2, 32, 130, 108, 157, 65, 117, 90, 193, 169, 56, 150, 78, 137, 62, 125, 19, 136, 42, 41, 149, 110, 81, 129], 'accuracy': 0.65, 'kappa': 0.30000000000000004, 'auc': 0.7374999999999999}], 'std_acc': 0.084, 'std_kappa': 0.167, 'std_auc': 0.079}\n",
      "sbj =  26\n",
      "Total trials loaded: 200\n",
      "Shape of X: (200, 64, 3584), Shape of y: (200,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (200, 64, 320, 1), y_train shape: (200,)\n",
      "Running fold 0 with 160 training samples and 40 validation samples\n",
      "Fold 0: train indices: [  4 142 183  71  50], val indices: [ 25 107  31 188  83]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 0 training loss: 0.027612144127488136\n",
      "y_true (val): [0 1 0 1 0]\n",
      "y_pred: [0 1 1 1 0]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [4, 142, 183, 71, 50, 179, 125, 131, 117, 60, 82, 55, 89, 21, 157, 47, 5, 42, 11, 19, 23, 172, 148, 99, 140, 34, 146, 115, 48, 147, 93, 2, 182, 138, 43, 57, 158, 187, 128, 18, 160, 33, 97, 14, 44, 177, 196, 61, 56, 174, 46, 67, 8, 101, 7, 41, 129, 184, 198, 98, 190, 74, 169, 24, 159, 173, 15, 70, 163, 58, 186, 72, 27, 87, 81, 26, 122, 96, 120, 65, 119, 102, 123, 167, 94, 130, 135, 77, 192, 175, 20, 37, 16, 0, 180, 144, 52, 145, 106, 139, 63, 9, 36, 153, 126, 17, 59, 29, 164, 30, 85, 156, 53, 79, 38, 118, 124, 193, 171, 35, 13, 151, 110, 95, 149, 136, 165, 168, 109, 88, 84, 92, 3, 121, 114, 143, 1, 10, 195, 28, 197, 103, 137, 152, 113, 112, 32, 189, 62, 199, 78, 68, 176, 161, 22, 155, 108, 80, 181, 166], 'val_indices': [25, 107, 31, 188, 83, 86, 111, 75, 191, 170, 76, 12, 100, 154, 73, 6, 66, 54, 104, 162, 91, 51, 132, 39, 105, 40, 134, 141, 45, 116, 185, 178, 127, 150, 194, 69, 133, 90, 64, 49], 'accuracy': 0.9, 'kappa': 0.8, 'auc': 0.9275}\n",
      "New Max Found!\n",
      "Running fold 1 with 160 training samples and 40 validation samples\n",
      "Fold 1: train indices: [162  56 128 110  84], val indices: [175 156   7 191  76]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 1 training loss: 0.04100470989942551\n",
      "y_true (val): [1 1 0 1 0]\n",
      "y_pred: [1 1 0 1 0]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [162, 56, 128, 110, 84, 70, 139, 147, 115, 155, 50, 165, 142, 109, 159, 194, 60, 15, 140, 195, 55, 86, 87, 130, 38, 79, 177, 92, 145, 47, 39, 135, 94, 197, 164, 104, 108, 88, 14, 21, 154, 17, 49, 11, 187, 114, 181, 158, 19, 77, 185, 123, 34, 25, 4, 12, 65, 30, 40, 129, 81, 189, 102, 141, 170, 68, 24, 71, 132, 107, 36, 27, 96, 66, 138, 63, 193, 113, 124, 99, 10, 150, 103, 5, 143, 146, 153, 122, 148, 9, 183, 105, 53, 166, 75, 52, 169, 43, 188, 59, 35, 186, 199, 93, 106, 3, 184, 33, 125, 74, 37, 1, 48, 180, 126, 121, 72, 62, 0, 173, 83, 119, 152, 23, 95, 73, 179, 44, 58, 120, 127, 157, 20, 163, 69, 190, 26, 112, 6, 134, 29, 64, 192, 172, 174, 28, 45, 168, 8, 46, 31, 116, 85, 131, 51, 32, 176, 198, 151, 42], 'val_indices': [175, 156, 7, 191, 76, 117, 54, 16, 2, 80, 41, 118, 78, 90, 100, 160, 149, 161, 171, 18, 82, 182, 101, 61, 91, 167, 144, 133, 196, 67, 22, 57, 137, 136, 98, 111, 89, 13, 178, 97], 'accuracy': 0.95, 'kappa': 0.9, 'auc': 0.965}\n",
      "New Max Found!\n",
      "Running fold 2 with 160 training samples and 40 validation samples\n",
      "Fold 2: train indices: [  3 109 165  70  15], val indices: [ 58 152 153  54 171]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 2 training loss: 0.04562640190124512\n",
      "y_true (val): [0 1 1 0 1]\n",
      "y_pred: [0 1 1 0 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [3, 109, 165, 70, 15, 172, 19, 5, 38, 146, 77, 11, 147, 198, 92, 18, 174, 2, 176, 168, 118, 199, 63, 100, 158, 17, 134, 86, 105, 24, 34, 175, 61, 166, 125, 97, 39, 108, 78, 79, 80, 31, 46, 180, 60, 113, 127, 87, 186, 144, 124, 67, 13, 136, 74, 65, 115, 167, 123, 72, 191, 182, 82, 23, 110, 40, 119, 183, 148, 128, 143, 85, 142, 107, 189, 30, 130, 145, 103, 96, 164, 151, 98, 64, 101, 43, 81, 49, 75, 69, 89, 106, 66, 162, 154, 161, 122, 188, 121, 10, 20, 91, 52, 111, 137, 57, 93, 178, 102, 138, 55, 47, 133, 42, 12, 196, 99, 177, 44, 169, 37, 193, 157, 1, 190, 0, 26, 141, 155, 173, 28, 27, 16, 32, 7, 195, 131, 197, 14, 156, 185, 36, 95, 71, 51, 160, 194, 117, 56, 68, 126, 41, 59, 135, 129, 4, 53, 90, 94, 179], 'val_indices': [58, 152, 153, 54, 171, 88, 170, 45, 21, 84, 181, 73, 150, 22, 29, 184, 25, 120, 159, 114, 116, 187, 6, 149, 83, 33, 50, 139, 104, 9, 48, 132, 112, 35, 76, 163, 8, 140, 192, 62], 'accuracy': 0.875, 'kappa': 0.75, 'auc': 0.9275000000000001}\n",
      "Running fold 3 with 160 training samples and 40 validation samples\n",
      "Fold 3: train indices: [66 43 45 22 69], val indices: [ 20  14 169 144 196]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 3 training loss: 0.04459051042795181\n",
      "y_true (val): [0 0 1 1 1]\n",
      "y_pred: [1 0 1 1 1]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [66, 43, 45, 22, 69, 48, 44, 60, 123, 74, 179, 25, 150, 171, 132, 28, 165, 96, 73, 113, 127, 72, 135, 52, 38, 23, 122, 100, 177, 92, 137, 148, 12, 8, 91, 159, 172, 125, 187, 32, 29, 173, 40, 108, 4, 151, 37, 186, 34, 21, 1, 33, 190, 176, 35, 146, 143, 68, 160, 136, 107, 103, 53, 49, 141, 131, 15, 50, 54, 199, 126, 154, 7, 193, 0, 89, 55, 56, 10, 98, 134, 106, 161, 168, 138, 112, 63, 88, 83, 174, 121, 81, 65, 61, 109, 78, 26, 47, 104, 9, 153, 180, 31, 94, 71, 77, 18, 195, 167, 75, 164, 162, 86, 85, 157, 119, 3, 84, 149, 142, 82, 95, 175, 191, 139, 133, 117, 24, 76, 41, 62, 198, 6, 111, 183, 110, 30, 11, 99, 178, 93, 87, 13, 166, 189, 170, 185, 118, 130, 197, 120, 128, 158, 140, 16, 59, 145, 101, 17, 181], 'val_indices': [20, 14, 169, 144, 196, 105, 67, 182, 36, 39, 97, 57, 64, 58, 79, 90, 188, 194, 155, 129, 102, 192, 27, 5, 124, 116, 80, 184, 152, 163, 46, 156, 114, 147, 115, 70, 19, 2, 51, 42], 'accuracy': 0.825, 'kappa': 0.65, 'auc': 0.9025}\n",
      "Running fold 4 with 160 training samples and 40 validation samples\n",
      "Fold 4: train indices: [ 52   4 194  64  46], val indices: [123  35  89 183   0]\n",
      "Training data shape: (160, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 4 training loss: 0.01608225330710411\n",
      "y_true (val): [1 0 0 1 0]\n",
      "y_pred: [1 0 0 1 0]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [52, 4, 194, 64, 46, 59, 38, 21, 193, 157, 28, 57, 17, 154, 184, 97, 139, 125, 102, 182, 30, 143, 180, 50, 126, 13, 161, 100, 15, 135, 45, 74, 153, 51, 115, 189, 181, 187, 37, 133, 118, 168, 16, 136, 66, 73, 19, 174, 22, 24, 71, 192, 63, 144, 122, 72, 54, 175, 147, 155, 85, 107, 149, 103, 69, 31, 27, 145, 7, 84, 77, 191, 88, 79, 114, 49, 90, 124, 5, 111, 36, 172, 131, 61, 32, 185, 173, 2, 166, 39, 148, 110, 34, 199, 65, 186, 23, 91, 159, 170, 93, 119, 195, 116, 129, 76, 53, 158, 101, 130, 178, 156, 6, 94, 138, 167, 96, 68, 132, 165, 92, 140, 12, 137, 44, 188, 160, 83, 47, 60, 98, 81, 105, 78, 58, 11, 25, 26, 82, 141, 171, 196, 62, 48, 1, 177, 70, 121, 8, 163, 109, 95, 104, 43, 117, 150, 14, 197, 127, 33], 'val_indices': [123, 35, 89, 183, 0, 80, 75, 134, 10, 87, 120, 40, 151, 67, 86, 99, 152, 42, 20, 176, 162, 169, 41, 190, 56, 9, 142, 146, 112, 108, 3, 128, 198, 106, 55, 29, 18, 164, 113, 179], 'accuracy': 0.925, 'kappa': 0.85, 'auc': 0.9875}\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.895, 'mean_kappa': 0.79, 'mean_auc': 0.942, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [4, 142, 183, 71, 50, 179, 125, 131, 117, 60, 82, 55, 89, 21, 157, 47, 5, 42, 11, 19, 23, 172, 148, 99, 140, 34, 146, 115, 48, 147, 93, 2, 182, 138, 43, 57, 158, 187, 128, 18, 160, 33, 97, 14, 44, 177, 196, 61, 56, 174, 46, 67, 8, 101, 7, 41, 129, 184, 198, 98, 190, 74, 169, 24, 159, 173, 15, 70, 163, 58, 186, 72, 27, 87, 81, 26, 122, 96, 120, 65, 119, 102, 123, 167, 94, 130, 135, 77, 192, 175, 20, 37, 16, 0, 180, 144, 52, 145, 106, 139, 63, 9, 36, 153, 126, 17, 59, 29, 164, 30, 85, 156, 53, 79, 38, 118, 124, 193, 171, 35, 13, 151, 110, 95, 149, 136, 165, 168, 109, 88, 84, 92, 3, 121, 114, 143, 1, 10, 195, 28, 197, 103, 137, 152, 113, 112, 32, 189, 62, 199, 78, 68, 176, 161, 22, 155, 108, 80, 181, 166], 'val_indices': [25, 107, 31, 188, 83, 86, 111, 75, 191, 170, 76, 12, 100, 154, 73, 6, 66, 54, 104, 162, 91, 51, 132, 39, 105, 40, 134, 141, 45, 116, 185, 178, 127, 150, 194, 69, 133, 90, 64, 49], 'accuracy': 0.9, 'kappa': 0.8, 'auc': 0.9275}, {'fold_index': 1, 'train_indices': [162, 56, 128, 110, 84, 70, 139, 147, 115, 155, 50, 165, 142, 109, 159, 194, 60, 15, 140, 195, 55, 86, 87, 130, 38, 79, 177, 92, 145, 47, 39, 135, 94, 197, 164, 104, 108, 88, 14, 21, 154, 17, 49, 11, 187, 114, 181, 158, 19, 77, 185, 123, 34, 25, 4, 12, 65, 30, 40, 129, 81, 189, 102, 141, 170, 68, 24, 71, 132, 107, 36, 27, 96, 66, 138, 63, 193, 113, 124, 99, 10, 150, 103, 5, 143, 146, 153, 122, 148, 9, 183, 105, 53, 166, 75, 52, 169, 43, 188, 59, 35, 186, 199, 93, 106, 3, 184, 33, 125, 74, 37, 1, 48, 180, 126, 121, 72, 62, 0, 173, 83, 119, 152, 23, 95, 73, 179, 44, 58, 120, 127, 157, 20, 163, 69, 190, 26, 112, 6, 134, 29, 64, 192, 172, 174, 28, 45, 168, 8, 46, 31, 116, 85, 131, 51, 32, 176, 198, 151, 42], 'val_indices': [175, 156, 7, 191, 76, 117, 54, 16, 2, 80, 41, 118, 78, 90, 100, 160, 149, 161, 171, 18, 82, 182, 101, 61, 91, 167, 144, 133, 196, 67, 22, 57, 137, 136, 98, 111, 89, 13, 178, 97], 'accuracy': 0.95, 'kappa': 0.9, 'auc': 0.965}, {'fold_index': 2, 'train_indices': [3, 109, 165, 70, 15, 172, 19, 5, 38, 146, 77, 11, 147, 198, 92, 18, 174, 2, 176, 168, 118, 199, 63, 100, 158, 17, 134, 86, 105, 24, 34, 175, 61, 166, 125, 97, 39, 108, 78, 79, 80, 31, 46, 180, 60, 113, 127, 87, 186, 144, 124, 67, 13, 136, 74, 65, 115, 167, 123, 72, 191, 182, 82, 23, 110, 40, 119, 183, 148, 128, 143, 85, 142, 107, 189, 30, 130, 145, 103, 96, 164, 151, 98, 64, 101, 43, 81, 49, 75, 69, 89, 106, 66, 162, 154, 161, 122, 188, 121, 10, 20, 91, 52, 111, 137, 57, 93, 178, 102, 138, 55, 47, 133, 42, 12, 196, 99, 177, 44, 169, 37, 193, 157, 1, 190, 0, 26, 141, 155, 173, 28, 27, 16, 32, 7, 195, 131, 197, 14, 156, 185, 36, 95, 71, 51, 160, 194, 117, 56, 68, 126, 41, 59, 135, 129, 4, 53, 90, 94, 179], 'val_indices': [58, 152, 153, 54, 171, 88, 170, 45, 21, 84, 181, 73, 150, 22, 29, 184, 25, 120, 159, 114, 116, 187, 6, 149, 83, 33, 50, 139, 104, 9, 48, 132, 112, 35, 76, 163, 8, 140, 192, 62], 'accuracy': 0.875, 'kappa': 0.75, 'auc': 0.9275000000000001}, {'fold_index': 3, 'train_indices': [66, 43, 45, 22, 69, 48, 44, 60, 123, 74, 179, 25, 150, 171, 132, 28, 165, 96, 73, 113, 127, 72, 135, 52, 38, 23, 122, 100, 177, 92, 137, 148, 12, 8, 91, 159, 172, 125, 187, 32, 29, 173, 40, 108, 4, 151, 37, 186, 34, 21, 1, 33, 190, 176, 35, 146, 143, 68, 160, 136, 107, 103, 53, 49, 141, 131, 15, 50, 54, 199, 126, 154, 7, 193, 0, 89, 55, 56, 10, 98, 134, 106, 161, 168, 138, 112, 63, 88, 83, 174, 121, 81, 65, 61, 109, 78, 26, 47, 104, 9, 153, 180, 31, 94, 71, 77, 18, 195, 167, 75, 164, 162, 86, 85, 157, 119, 3, 84, 149, 142, 82, 95, 175, 191, 139, 133, 117, 24, 76, 41, 62, 198, 6, 111, 183, 110, 30, 11, 99, 178, 93, 87, 13, 166, 189, 170, 185, 118, 130, 197, 120, 128, 158, 140, 16, 59, 145, 101, 17, 181], 'val_indices': [20, 14, 169, 144, 196, 105, 67, 182, 36, 39, 97, 57, 64, 58, 79, 90, 188, 194, 155, 129, 102, 192, 27, 5, 124, 116, 80, 184, 152, 163, 46, 156, 114, 147, 115, 70, 19, 2, 51, 42], 'accuracy': 0.825, 'kappa': 0.65, 'auc': 0.9025}, {'fold_index': 4, 'train_indices': [52, 4, 194, 64, 46, 59, 38, 21, 193, 157, 28, 57, 17, 154, 184, 97, 139, 125, 102, 182, 30, 143, 180, 50, 126, 13, 161, 100, 15, 135, 45, 74, 153, 51, 115, 189, 181, 187, 37, 133, 118, 168, 16, 136, 66, 73, 19, 174, 22, 24, 71, 192, 63, 144, 122, 72, 54, 175, 147, 155, 85, 107, 149, 103, 69, 31, 27, 145, 7, 84, 77, 191, 88, 79, 114, 49, 90, 124, 5, 111, 36, 172, 131, 61, 32, 185, 173, 2, 166, 39, 148, 110, 34, 199, 65, 186, 23, 91, 159, 170, 93, 119, 195, 116, 129, 76, 53, 158, 101, 130, 178, 156, 6, 94, 138, 167, 96, 68, 132, 165, 92, 140, 12, 137, 44, 188, 160, 83, 47, 60, 98, 81, 105, 78, 58, 11, 25, 26, 82, 141, 171, 196, 62, 48, 1, 177, 70, 121, 8, 163, 109, 95, 104, 43, 117, 150, 14, 197, 127, 33], 'val_indices': [123, 35, 89, 183, 0, 80, 75, 134, 10, 87, 120, 40, 151, 67, 86, 99, 152, 42, 20, 176, 162, 169, 41, 190, 56, 9, 142, 146, 112, 108, 3, 128, 198, 106, 55, 29, 18, 164, 113, 179], 'accuracy': 0.925, 'kappa': 0.85, 'auc': 0.9875}], 'std_acc': 0.043, 'std_kappa': 0.086, 'std_auc': 0.03}\n",
      "sbj =  27\n",
      "Total trials loaded: 185\n",
      "Shape of X: (185, 64, 3584), Shape of y: (185,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (185, 64, 320, 1), y_train shape: (185,)\n",
      "Running fold 0 with 148 training samples and 37 validation samples\n",
      "Fold 0: train indices: [ 55  56 115   5  27], val indices: [ 21  54 100  12  73]\n",
      "Training data shape: (148, 64, 320, 1), Validation data shape: (37, 64, 320, 1)\n",
      "Fold 0 training loss: 0.09288516640663147\n",
      "y_true (val): [0 0 1 0 0]\n",
      "y_pred: [0 0 1 1 1]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [55, 56, 115, 5, 27, 128, 91, 68, 170, 48, 137, 146, 23, 18, 179, 165, 156, 53, 125, 152, 96, 138, 28, 140, 177, 67, 84, 11, 58, 79, 33, 141, 10, 171, 16, 36, 13, 47, 38, 132, 183, 50, 61, 117, 104, 135, 88, 0, 173, 87, 134, 175, 119, 60, 105, 29, 153, 148, 19, 92, 59, 34, 42, 74, 181, 80, 26, 114, 82, 150, 62, 108, 176, 136, 163, 65, 107, 94, 168, 160, 24, 9, 71, 44, 30, 182, 113, 20, 4, 41, 90, 109, 102, 17, 166, 2, 78, 161, 85, 35, 75, 95, 97, 52, 22, 172, 103, 81, 147, 110, 32, 14, 164, 15, 106, 72, 120, 158, 8, 86, 129, 98, 167, 57, 159, 1, 126, 7, 99, 178, 169, 111, 149, 157, 43, 145, 101, 37, 3, 180, 63, 144, 162, 46, 133, 154, 70, 155], 'val_indices': [21, 54, 100, 12, 73, 6, 121, 127, 124, 40, 143, 142, 45, 118, 89, 83, 131, 116, 51, 123, 184, 69, 174, 77, 49, 25, 39, 93, 64, 31, 122, 151, 66, 130, 76, 112, 139], 'accuracy': 0.5135135135135135, 'kappa': 0.02346041055718473, 'auc': 0.5233918128654971}\n",
      "New Max Found!\n",
      "Running fold 1 with 148 training samples and 37 validation samples\n",
      "Fold 1: train indices: [ 91 148 102 162 156], val indices: [173  38 130  75 140]\n",
      "Training data shape: (148, 64, 320, 1), Validation data shape: (37, 64, 320, 1)\n",
      "Fold 1 training loss: 0.031280696392059326\n",
      "y_true (val): [1 0 1 0 1]\n",
      "y_pred: [0 0 1 1 0]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [91, 148, 102, 162, 156, 43, 35, 17, 167, 0, 79, 68, 42, 134, 64, 117, 70, 166, 2, 183, 133, 57, 14, 51, 157, 115, 154, 119, 27, 128, 181, 135, 152, 83, 137, 132, 52, 95, 48, 81, 11, 65, 37, 4, 44, 25, 182, 30, 34, 80, 139, 103, 69, 67, 31, 165, 88, 151, 23, 168, 114, 18, 169, 110, 15, 178, 116, 8, 174, 111, 94, 46, 12, 86, 55, 105, 72, 123, 161, 26, 101, 149, 146, 96, 87, 99, 39, 127, 49, 62, 136, 163, 172, 5, 20, 93, 150, 155, 153, 159, 100, 10, 184, 179, 19, 60, 53, 22, 122, 41, 63, 143, 171, 66, 74, 180, 164, 98, 73, 121, 170, 112, 126, 47, 138, 97, 92, 1, 6, 158, 108, 16, 45, 118, 9, 141, 24, 29, 85, 58, 125, 77, 175, 56, 124, 71, 28, 89], 'val_indices': [173, 38, 130, 75, 140, 144, 7, 131, 160, 145, 177, 113, 176, 129, 120, 82, 61, 106, 32, 107, 109, 142, 78, 90, 36, 21, 13, 3, 40, 54, 84, 50, 33, 104, 76, 147, 59], 'accuracy': 0.43243243243243246, 'kappa': -0.13762811127379204, 'auc': 0.4444444444444444}\n",
      "Running fold 2 with 148 training samples and 37 validation samples\n",
      "Fold 2: train indices: [121  75 144 174  29], val indices: [ 84   8 130  20  79]\n",
      "Training data shape: (148, 64, 320, 1), Validation data shape: (37, 64, 320, 1)\n",
      "Fold 2 training loss: 0.017729973420500755\n",
      "y_true (val): [0 0 1 0 0]\n",
      "y_pred: [1 1 0 0 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [121, 75, 144, 174, 29, 56, 88, 129, 43, 118, 30, 10, 78, 12, 74, 48, 85, 126, 16, 167, 57, 150, 139, 96, 112, 24, 65, 115, 157, 111, 47, 148, 14, 140, 23, 182, 153, 83, 26, 31, 67, 45, 5, 39, 158, 159, 90, 149, 151, 28, 7, 59, 76, 58, 60, 73, 143, 92, 120, 147, 37, 163, 169, 175, 42, 160, 32, 91, 64, 55, 113, 173, 146, 49, 54, 53, 102, 183, 19, 93, 104, 2, 176, 152, 98, 6, 184, 178, 62, 99, 61, 103, 18, 110, 162, 106, 11, 41, 22, 117, 179, 81, 181, 164, 108, 154, 172, 97, 116, 109, 131, 100, 89, 123, 68, 156, 38, 69, 168, 70, 34, 136, 36, 66, 40, 3, 86, 125, 25, 51, 161, 50, 180, 170, 133, 9, 155, 72, 122, 101, 46, 0, 141, 95, 107, 77, 80, 82], 'val_indices': [84, 8, 130, 20, 79, 145, 134, 27, 171, 87, 114, 165, 94, 13, 105, 135, 35, 44, 21, 127, 137, 132, 52, 166, 128, 177, 119, 1, 17, 138, 33, 63, 4, 124, 142, 15, 71], 'accuracy': 0.4594594594594595, 'kappa': -0.07871720116618075, 'auc': 0.49415204678362573}\n",
      "Running fold 3 with 148 training samples and 37 validation samples\n",
      "Fold 3: train indices: [171 121 115  12 143], val indices: [ 96 101  69 127  36]\n",
      "Training data shape: (148, 64, 320, 1), Validation data shape: (37, 64, 320, 1)\n",
      "Fold 3 training loss: 0.01288598496466875\n",
      "y_true (val): [1 1 0 1 0]\n",
      "y_pred: [1 1 1 1 1]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [171, 121, 115, 12, 143, 154, 141, 102, 99, 105, 7, 83, 78, 165, 48, 23, 116, 161, 13, 15, 29, 80, 158, 172, 72, 50, 76, 178, 137, 151, 156, 95, 182, 55, 113, 53, 41, 104, 122, 5, 57, 114, 9, 28, 125, 22, 173, 168, 175, 135, 111, 183, 145, 46, 59, 123, 98, 106, 74, 61, 93, 51, 18, 85, 11, 163, 176, 94, 132, 60, 131, 129, 153, 138, 0, 170, 39, 167, 180, 124, 47, 20, 19, 27, 71, 45, 25, 149, 66, 56, 63, 97, 139, 26, 117, 164, 33, 89, 103, 1, 169, 86, 14, 24, 62, 21, 142, 17, 126, 148, 155, 107, 73, 75, 40, 112, 49, 100, 92, 119, 64, 120, 91, 43, 177, 90, 2, 160, 147, 54, 35, 77, 84, 87, 133, 58, 79, 118, 159, 3, 34, 150, 4, 44, 152, 8, 174, 42], 'val_indices': [96, 101, 69, 127, 36, 68, 82, 38, 37, 166, 146, 162, 31, 130, 136, 157, 179, 70, 88, 181, 184, 65, 108, 109, 30, 67, 16, 6, 81, 140, 10, 128, 52, 32, 144, 134, 110], 'accuracy': 0.6756756756756757, 'kappa': 0.34705882352941175, 'auc': 0.5672514619883041}\n",
      "New Max Found!\n",
      "Running fold 4 with 148 training samples and 37 validation samples\n",
      "Fold 4: train indices: [ 72   8  83  35 127], val indices: [ 67  62 179  30  65]\n",
      "Training data shape: (148, 64, 320, 1), Validation data shape: (37, 64, 320, 1)\n",
      "Fold 4 training loss: 0.019720107316970825\n",
      "y_true (val): [0 0 1 0 0]\n",
      "y_pred: [0 1 0 0 1]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [72, 8, 83, 35, 127, 121, 27, 90, 57, 174, 86, 102, 152, 28, 9, 114, 132, 1, 141, 157, 170, 68, 58, 37, 23, 134, 34, 180, 12, 143, 140, 167, 139, 75, 73, 55, 80, 31, 45, 183, 51, 149, 46, 44, 93, 22, 66, 47, 162, 136, 150, 11, 17, 88, 168, 10, 36, 69, 147, 52, 133, 82, 115, 163, 155, 4, 60, 116, 81, 105, 137, 161, 63, 78, 153, 142, 184, 87, 122, 160, 138, 125, 123, 148, 181, 29, 135, 85, 19, 171, 151, 117, 103, 43, 119, 173, 71, 48, 128, 3, 126, 33, 154, 54, 50, 111, 15, 100, 104, 172, 24, 101, 64, 74, 96, 16, 70, 182, 25, 177, 94, 42, 158, 79, 129, 110, 26, 166, 61, 165, 5, 176, 108, 113, 7, 97, 53, 120, 159, 59, 112, 146, 106, 18, 32, 41, 0, 91], 'val_indices': [67, 62, 179, 30, 65, 130, 107, 38, 169, 6, 84, 40, 77, 56, 124, 144, 92, 2, 109, 98, 118, 13, 89, 14, 39, 175, 145, 164, 20, 49, 131, 99, 21, 178, 76, 95, 156], 'accuracy': 0.5675675675675675, 'kappa': 0.13953488372093015, 'auc': 0.6842105263157895}\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.53, 'mean_kappa': 0.059, 'mean_auc': 0.543, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [55, 56, 115, 5, 27, 128, 91, 68, 170, 48, 137, 146, 23, 18, 179, 165, 156, 53, 125, 152, 96, 138, 28, 140, 177, 67, 84, 11, 58, 79, 33, 141, 10, 171, 16, 36, 13, 47, 38, 132, 183, 50, 61, 117, 104, 135, 88, 0, 173, 87, 134, 175, 119, 60, 105, 29, 153, 148, 19, 92, 59, 34, 42, 74, 181, 80, 26, 114, 82, 150, 62, 108, 176, 136, 163, 65, 107, 94, 168, 160, 24, 9, 71, 44, 30, 182, 113, 20, 4, 41, 90, 109, 102, 17, 166, 2, 78, 161, 85, 35, 75, 95, 97, 52, 22, 172, 103, 81, 147, 110, 32, 14, 164, 15, 106, 72, 120, 158, 8, 86, 129, 98, 167, 57, 159, 1, 126, 7, 99, 178, 169, 111, 149, 157, 43, 145, 101, 37, 3, 180, 63, 144, 162, 46, 133, 154, 70, 155], 'val_indices': [21, 54, 100, 12, 73, 6, 121, 127, 124, 40, 143, 142, 45, 118, 89, 83, 131, 116, 51, 123, 184, 69, 174, 77, 49, 25, 39, 93, 64, 31, 122, 151, 66, 130, 76, 112, 139], 'accuracy': 0.5135135135135135, 'kappa': 0.02346041055718473, 'auc': 0.5233918128654971}, {'fold_index': 1, 'train_indices': [91, 148, 102, 162, 156, 43, 35, 17, 167, 0, 79, 68, 42, 134, 64, 117, 70, 166, 2, 183, 133, 57, 14, 51, 157, 115, 154, 119, 27, 128, 181, 135, 152, 83, 137, 132, 52, 95, 48, 81, 11, 65, 37, 4, 44, 25, 182, 30, 34, 80, 139, 103, 69, 67, 31, 165, 88, 151, 23, 168, 114, 18, 169, 110, 15, 178, 116, 8, 174, 111, 94, 46, 12, 86, 55, 105, 72, 123, 161, 26, 101, 149, 146, 96, 87, 99, 39, 127, 49, 62, 136, 163, 172, 5, 20, 93, 150, 155, 153, 159, 100, 10, 184, 179, 19, 60, 53, 22, 122, 41, 63, 143, 171, 66, 74, 180, 164, 98, 73, 121, 170, 112, 126, 47, 138, 97, 92, 1, 6, 158, 108, 16, 45, 118, 9, 141, 24, 29, 85, 58, 125, 77, 175, 56, 124, 71, 28, 89], 'val_indices': [173, 38, 130, 75, 140, 144, 7, 131, 160, 145, 177, 113, 176, 129, 120, 82, 61, 106, 32, 107, 109, 142, 78, 90, 36, 21, 13, 3, 40, 54, 84, 50, 33, 104, 76, 147, 59], 'accuracy': 0.43243243243243246, 'kappa': -0.13762811127379204, 'auc': 0.4444444444444444}, {'fold_index': 2, 'train_indices': [121, 75, 144, 174, 29, 56, 88, 129, 43, 118, 30, 10, 78, 12, 74, 48, 85, 126, 16, 167, 57, 150, 139, 96, 112, 24, 65, 115, 157, 111, 47, 148, 14, 140, 23, 182, 153, 83, 26, 31, 67, 45, 5, 39, 158, 159, 90, 149, 151, 28, 7, 59, 76, 58, 60, 73, 143, 92, 120, 147, 37, 163, 169, 175, 42, 160, 32, 91, 64, 55, 113, 173, 146, 49, 54, 53, 102, 183, 19, 93, 104, 2, 176, 152, 98, 6, 184, 178, 62, 99, 61, 103, 18, 110, 162, 106, 11, 41, 22, 117, 179, 81, 181, 164, 108, 154, 172, 97, 116, 109, 131, 100, 89, 123, 68, 156, 38, 69, 168, 70, 34, 136, 36, 66, 40, 3, 86, 125, 25, 51, 161, 50, 180, 170, 133, 9, 155, 72, 122, 101, 46, 0, 141, 95, 107, 77, 80, 82], 'val_indices': [84, 8, 130, 20, 79, 145, 134, 27, 171, 87, 114, 165, 94, 13, 105, 135, 35, 44, 21, 127, 137, 132, 52, 166, 128, 177, 119, 1, 17, 138, 33, 63, 4, 124, 142, 15, 71], 'accuracy': 0.4594594594594595, 'kappa': -0.07871720116618075, 'auc': 0.49415204678362573}, {'fold_index': 3, 'train_indices': [171, 121, 115, 12, 143, 154, 141, 102, 99, 105, 7, 83, 78, 165, 48, 23, 116, 161, 13, 15, 29, 80, 158, 172, 72, 50, 76, 178, 137, 151, 156, 95, 182, 55, 113, 53, 41, 104, 122, 5, 57, 114, 9, 28, 125, 22, 173, 168, 175, 135, 111, 183, 145, 46, 59, 123, 98, 106, 74, 61, 93, 51, 18, 85, 11, 163, 176, 94, 132, 60, 131, 129, 153, 138, 0, 170, 39, 167, 180, 124, 47, 20, 19, 27, 71, 45, 25, 149, 66, 56, 63, 97, 139, 26, 117, 164, 33, 89, 103, 1, 169, 86, 14, 24, 62, 21, 142, 17, 126, 148, 155, 107, 73, 75, 40, 112, 49, 100, 92, 119, 64, 120, 91, 43, 177, 90, 2, 160, 147, 54, 35, 77, 84, 87, 133, 58, 79, 118, 159, 3, 34, 150, 4, 44, 152, 8, 174, 42], 'val_indices': [96, 101, 69, 127, 36, 68, 82, 38, 37, 166, 146, 162, 31, 130, 136, 157, 179, 70, 88, 181, 184, 65, 108, 109, 30, 67, 16, 6, 81, 140, 10, 128, 52, 32, 144, 134, 110], 'accuracy': 0.6756756756756757, 'kappa': 0.34705882352941175, 'auc': 0.5672514619883041}, {'fold_index': 4, 'train_indices': [72, 8, 83, 35, 127, 121, 27, 90, 57, 174, 86, 102, 152, 28, 9, 114, 132, 1, 141, 157, 170, 68, 58, 37, 23, 134, 34, 180, 12, 143, 140, 167, 139, 75, 73, 55, 80, 31, 45, 183, 51, 149, 46, 44, 93, 22, 66, 47, 162, 136, 150, 11, 17, 88, 168, 10, 36, 69, 147, 52, 133, 82, 115, 163, 155, 4, 60, 116, 81, 105, 137, 161, 63, 78, 153, 142, 184, 87, 122, 160, 138, 125, 123, 148, 181, 29, 135, 85, 19, 171, 151, 117, 103, 43, 119, 173, 71, 48, 128, 3, 126, 33, 154, 54, 50, 111, 15, 100, 104, 172, 24, 101, 64, 74, 96, 16, 70, 182, 25, 177, 94, 42, 158, 79, 129, 110, 26, 166, 61, 165, 5, 176, 108, 113, 7, 97, 53, 120, 159, 59, 112, 146, 106, 18, 32, 41, 0, 91], 'val_indices': [67, 62, 179, 30, 65, 130, 107, 38, 169, 6, 84, 40, 77, 56, 124, 144, 92, 2, 109, 98, 118, 13, 89, 14, 39, 175, 145, 164, 20, 49, 131, 99, 21, 178, 76, 95, 156], 'accuracy': 0.5675675675675675, 'kappa': 0.13953488372093015, 'auc': 0.6842105263157895}], 'std_acc': 0.086, 'std_kappa': 0.172, 'std_auc': 0.081}\n",
      "sbj =  28\n",
      "Total trials loaded: 196\n",
      "Shape of X: (196, 64, 3584), Shape of y: (196,)\n",
      "Resampling from 512 to 128.0 Hz.\n",
      "X_train shape: (196, 64, 320, 1), y_train shape: (196,)\n",
      "Running fold 0 with 156 training samples and 40 validation samples\n",
      "Fold 0: train indices: [114 127  84 150  63], val indices: [ 83  73 177  12  76]\n",
      "Training data shape: (156, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 0 training loss: 0.0355067141354084\n",
      "y_true (val): [0 0 1 0 0]\n",
      "y_pred: [0 0 1 0 0]\n",
      "Appending results for fold 0: {'fold_index': 0, 'train_indices': [114, 127, 84, 150, 63, 55, 96, 37, 20, 0, 79, 107, 1, 4, 47, 87, 19, 58, 56, 139, 61, 71, 77, 174, 104, 136, 148, 166, 180, 62, 72, 48, 43, 109, 14, 78, 57, 23, 185, 171, 92, 82, 162, 173, 2, 28, 115, 18, 142, 120, 111, 27, 42, 130, 97, 168, 182, 159, 81, 108, 26, 21, 121, 158, 135, 98, 67, 105, 74, 24, 170, 22, 116, 36, 167, 156, 143, 163, 93, 124, 106, 101, 178, 17, 50, 46, 38, 172, 52, 187, 193, 7, 8, 15, 169, 192, 33, 29, 112, 13, 5, 119, 11, 94, 35, 183, 146, 144, 95, 10, 175, 191, 32, 176, 186, 165, 30, 34, 59, 70, 194, 80, 181, 164, 190, 86, 9, 154, 100, 155, 65, 60, 157, 68, 129, 123, 117, 189, 138, 160, 89, 147, 41, 16, 3, 118, 179, 44, 102, 125, 53, 151, 113, 88, 145, 188], 'val_indices': [83, 73, 177, 12, 76, 131, 161, 184, 99, 6, 66, 110, 85, 54, 31, 122, 133, 141, 39, 40, 132, 45, 140, 103, 149, 25, 51, 137, 128, 153, 134, 75, 90, 64, 49, 126, 152, 69, 91, 195], 'accuracy': 0.925, 'kappa': 0.85, 'auc': 0.995}\n",
      "New Max Found!\n",
      "Running fold 1 with 156 training samples and 40 validation samples\n",
      "Fold 1: train indices: [144 168 105  58 121], val indices: [195 116 136 186  91]\n",
      "Training data shape: (156, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 1 training loss: 0.03520883619785309\n",
      "y_true (val): [1 1 1 1 0]\n",
      "y_pred: [0 1 0 0 0]\n",
      "Appending results for fold 1: {'fold_index': 1, 'train_indices': [144, 168, 105, 58, 121, 51, 17, 102, 44, 37, 81, 46, 96, 120, 103, 20, 123, 118, 73, 129, 126, 122, 173, 71, 138, 69, 124, 175, 59, 151, 6, 180, 24, 53, 89, 146, 139, 106, 63, 84, 193, 154, 183, 10, 119, 87, 97, 65, 39, 27, 162, 128, 111, 194, 167, 130, 34, 152, 48, 125, 30, 85, 131, 68, 142, 45, 5, 35, 12, 158, 104, 171, 156, 33, 64, 149, 41, 88, 157, 145, 108, 40, 172, 47, 179, 36, 70, 133, 8, 0, 4, 134, 107, 28, 109, 29, 76, 137, 15, 26, 77, 11, 187, 114, 188, 66, 25, 23, 178, 75, 150, 182, 60, 50, 79, 101, 55, 176, 164, 153, 189, 169, 82, 115, 190, 93, 161, 9, 127, 83, 112, 56, 62, 184, 185, 163, 94, 98, 192, 49, 14, 19, 141, 72, 165, 52, 42, 113, 140, 147, 31, 43, 100, 1, 74, 3], 'val_indices': [195, 116, 136, 186, 91, 18, 54, 117, 80, 177, 160, 7, 67, 132, 61, 16, 13, 86, 148, 181, 57, 166, 99, 110, 95, 159, 22, 32, 143, 135, 38, 2, 174, 170, 155, 78, 92, 191, 90, 21], 'accuracy': 0.775, 'kappa': 0.55, 'auc': 0.9225}\n",
      "Running fold 2 with 156 training samples and 40 validation samples\n",
      "Fold 2: train indices: [ 66 134  81  20  79], val indices: [107 111  12 176 188]\n",
      "Training data shape: (156, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 2 training loss: 0.05750393867492676\n",
      "y_true (val): [1 1 0 1 1]\n",
      "y_pred: [1 1 0 1 1]\n",
      "Appending results for fold 2: {'fold_index': 2, 'train_indices': [66, 134, 81, 20, 79, 23, 139, 137, 39, 78, 170, 117, 148, 112, 158, 175, 9, 76, 164, 177, 163, 16, 31, 38, 173, 167, 96, 41, 149, 63, 129, 122, 179, 186, 172, 174, 195, 162, 147, 189, 192, 191, 184, 190, 36, 51, 1, 159, 84, 4, 97, 19, 60, 28, 14, 140, 183, 92, 146, 103, 124, 11, 151, 114, 187, 6, 194, 150, 108, 24, 2, 152, 109, 118, 91, 115, 144, 80, 30, 104, 43, 55, 49, 145, 34, 135, 18, 125, 73, 56, 113, 101, 154, 58, 166, 193, 75, 35, 17, 10, 138, 99, 27, 52, 21, 121, 136, 86, 53, 32, 127, 64, 54, 48, 123, 62, 143, 169, 178, 77, 7, 95, 33, 89, 42, 120, 94, 37, 102, 100, 160, 88, 132, 119, 82, 90, 0, 8, 46, 25, 57, 110, 155, 105, 44, 156, 106, 83, 65, 72, 67, 161, 171, 13, 93, 71], 'val_indices': [107, 111, 12, 176, 188, 68, 15, 182, 168, 22, 85, 26, 70, 141, 181, 69, 180, 116, 153, 3, 142, 59, 185, 61, 87, 40, 131, 165, 126, 133, 130, 50, 157, 47, 128, 45, 98, 74, 29, 5], 'accuracy': 0.75, 'kappa': 0.5, 'auc': 0.87}\n",
      "Running fold 3 with 156 training samples and 40 validation samples\n",
      "Fold 3: train indices: [175 194  26  84  96], val indices: [ 13  39  99  36 173]\n",
      "Training data shape: (156, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 3 training loss: 0.04542957618832588\n",
      "y_true (val): [0 0 1 0 1]\n",
      "y_pred: [0 0 1 0 0]\n",
      "Appending results for fold 3: {'fold_index': 3, 'train_indices': [175, 194, 26, 84, 96, 85, 73, 125, 8, 110, 31, 187, 61, 151, 42, 62, 24, 12, 37, 188, 57, 90, 20, 183, 58, 195, 94, 191, 19, 81, 45, 182, 146, 112, 48, 152, 35, 192, 21, 128, 92, 159, 64, 149, 170, 178, 15, 50, 28, 49, 95, 3, 114, 164, 88, 140, 23, 86, 141, 167, 180, 66, 56, 68, 160, 5, 38, 82, 105, 29, 89, 60, 117, 177, 87, 55, 40, 98, 139, 184, 46, 121, 9, 32, 126, 154, 162, 193, 97, 79, 130, 1, 47, 27, 43, 101, 115, 172, 155, 6, 169, 137, 181, 2, 71, 41, 33, 135, 67, 34, 51, 189, 158, 147, 18, 102, 143, 165, 100, 138, 131, 76, 129, 75, 179, 142, 161, 157, 124, 163, 116, 65, 10, 171, 104, 103, 127, 145, 176, 166, 185, 4, 106, 132, 25, 63, 74, 119, 134, 93, 52, 14, 111, 118, 17, 83], 'val_indices': [13, 39, 99, 36, 173, 44, 54, 70, 133, 186, 107, 150, 168, 136, 122, 0, 16, 53, 22, 80, 72, 7, 30, 78, 91, 190, 77, 109, 148, 11, 156, 144, 113, 108, 153, 69, 120, 174, 123, 59], 'accuracy': 0.8, 'kappa': 0.6, 'auc': 0.8925}\n",
      "Running fold 4 with 156 training samples and 40 validation samples\n",
      "Fold 4: train indices: [ 87 176 153  13 179], val indices: [119 132  79  81 146]\n",
      "Training data shape: (156, 64, 320, 1), Validation data shape: (40, 64, 320, 1)\n",
      "Fold 4 training loss: 0.05361153557896614\n",
      "y_true (val): [1 1 0 0 1]\n",
      "y_pred: [1 1 0 0 0]\n",
      "Appending results for fold 4: {'fold_index': 4, 'train_indices': [87, 176, 153, 13, 179, 109, 147, 12, 40, 93, 130, 107, 190, 73, 83, 158, 112, 55, 37, 9, 172, 125, 178, 169, 72, 183, 120, 145, 22, 76, 0, 161, 106, 157, 45, 150, 50, 167, 26, 187, 77, 142, 92, 171, 57, 174, 114, 25, 101, 95, 23, 60, 1, 18, 7, 177, 36, 118, 117, 70, 96, 48, 186, 3, 192, 63, 175, 68, 33, 141, 34, 155, 116, 105, 111, 89, 88, 97, 24, 52, 4, 108, 144, 127, 15, 160, 90, 113, 131, 11, 194, 8, 14, 49, 86, 54, 71, 75, 193, 180, 2, 41, 182, 156, 168, 128, 149, 143, 164, 80, 17, 136, 42, 30, 29, 188, 44, 148, 137, 39, 16, 59, 102, 181, 74, 99, 151, 129, 51, 61, 162, 38, 121, 47, 126, 122, 140, 184, 53, 31, 91, 10, 104, 98, 124, 35, 135, 115, 85, 67, 58, 69, 103, 64, 166, 134], 'val_indices': [119, 132, 79, 81, 146, 133, 6, 27, 100, 191, 139, 84, 152, 28, 62, 170, 138, 20, 189, 46, 159, 82, 66, 5, 173, 19, 123, 163, 78, 110, 94, 185, 154, 65, 165, 21, 195, 32, 56, 43], 'accuracy': 0.875, 'kappa': 0.75, 'auc': 0.8949999999999999}\n",
      "Final cross-validation results: {'params': [], 'mean_acc': 0.825, 'mean_kappa': 0.65, 'mean_auc': 0.915, 'mean_f1_left': array([0., 0., 0., 0., 0.]), 'mean_f1_right': array([0., 0., 0., 0., 0.]), 'mean_recall_left': array([0., 0., 0., 0., 0.]), 'mean_recall_right': array([0., 0., 0., 0., 0.]), 'mean_precision_left': array([0., 0., 0., 0., 0.]), 'mean_precision_right': array([0., 0., 0., 0., 0.]), 'all_folds': [{'fold_index': 0, 'train_indices': [114, 127, 84, 150, 63, 55, 96, 37, 20, 0, 79, 107, 1, 4, 47, 87, 19, 58, 56, 139, 61, 71, 77, 174, 104, 136, 148, 166, 180, 62, 72, 48, 43, 109, 14, 78, 57, 23, 185, 171, 92, 82, 162, 173, 2, 28, 115, 18, 142, 120, 111, 27, 42, 130, 97, 168, 182, 159, 81, 108, 26, 21, 121, 158, 135, 98, 67, 105, 74, 24, 170, 22, 116, 36, 167, 156, 143, 163, 93, 124, 106, 101, 178, 17, 50, 46, 38, 172, 52, 187, 193, 7, 8, 15, 169, 192, 33, 29, 112, 13, 5, 119, 11, 94, 35, 183, 146, 144, 95, 10, 175, 191, 32, 176, 186, 165, 30, 34, 59, 70, 194, 80, 181, 164, 190, 86, 9, 154, 100, 155, 65, 60, 157, 68, 129, 123, 117, 189, 138, 160, 89, 147, 41, 16, 3, 118, 179, 44, 102, 125, 53, 151, 113, 88, 145, 188], 'val_indices': [83, 73, 177, 12, 76, 131, 161, 184, 99, 6, 66, 110, 85, 54, 31, 122, 133, 141, 39, 40, 132, 45, 140, 103, 149, 25, 51, 137, 128, 153, 134, 75, 90, 64, 49, 126, 152, 69, 91, 195], 'accuracy': 0.925, 'kappa': 0.85, 'auc': 0.995}, {'fold_index': 1, 'train_indices': [144, 168, 105, 58, 121, 51, 17, 102, 44, 37, 81, 46, 96, 120, 103, 20, 123, 118, 73, 129, 126, 122, 173, 71, 138, 69, 124, 175, 59, 151, 6, 180, 24, 53, 89, 146, 139, 106, 63, 84, 193, 154, 183, 10, 119, 87, 97, 65, 39, 27, 162, 128, 111, 194, 167, 130, 34, 152, 48, 125, 30, 85, 131, 68, 142, 45, 5, 35, 12, 158, 104, 171, 156, 33, 64, 149, 41, 88, 157, 145, 108, 40, 172, 47, 179, 36, 70, 133, 8, 0, 4, 134, 107, 28, 109, 29, 76, 137, 15, 26, 77, 11, 187, 114, 188, 66, 25, 23, 178, 75, 150, 182, 60, 50, 79, 101, 55, 176, 164, 153, 189, 169, 82, 115, 190, 93, 161, 9, 127, 83, 112, 56, 62, 184, 185, 163, 94, 98, 192, 49, 14, 19, 141, 72, 165, 52, 42, 113, 140, 147, 31, 43, 100, 1, 74, 3], 'val_indices': [195, 116, 136, 186, 91, 18, 54, 117, 80, 177, 160, 7, 67, 132, 61, 16, 13, 86, 148, 181, 57, 166, 99, 110, 95, 159, 22, 32, 143, 135, 38, 2, 174, 170, 155, 78, 92, 191, 90, 21], 'accuracy': 0.775, 'kappa': 0.55, 'auc': 0.9225}, {'fold_index': 2, 'train_indices': [66, 134, 81, 20, 79, 23, 139, 137, 39, 78, 170, 117, 148, 112, 158, 175, 9, 76, 164, 177, 163, 16, 31, 38, 173, 167, 96, 41, 149, 63, 129, 122, 179, 186, 172, 174, 195, 162, 147, 189, 192, 191, 184, 190, 36, 51, 1, 159, 84, 4, 97, 19, 60, 28, 14, 140, 183, 92, 146, 103, 124, 11, 151, 114, 187, 6, 194, 150, 108, 24, 2, 152, 109, 118, 91, 115, 144, 80, 30, 104, 43, 55, 49, 145, 34, 135, 18, 125, 73, 56, 113, 101, 154, 58, 166, 193, 75, 35, 17, 10, 138, 99, 27, 52, 21, 121, 136, 86, 53, 32, 127, 64, 54, 48, 123, 62, 143, 169, 178, 77, 7, 95, 33, 89, 42, 120, 94, 37, 102, 100, 160, 88, 132, 119, 82, 90, 0, 8, 46, 25, 57, 110, 155, 105, 44, 156, 106, 83, 65, 72, 67, 161, 171, 13, 93, 71], 'val_indices': [107, 111, 12, 176, 188, 68, 15, 182, 168, 22, 85, 26, 70, 141, 181, 69, 180, 116, 153, 3, 142, 59, 185, 61, 87, 40, 131, 165, 126, 133, 130, 50, 157, 47, 128, 45, 98, 74, 29, 5], 'accuracy': 0.75, 'kappa': 0.5, 'auc': 0.87}, {'fold_index': 3, 'train_indices': [175, 194, 26, 84, 96, 85, 73, 125, 8, 110, 31, 187, 61, 151, 42, 62, 24, 12, 37, 188, 57, 90, 20, 183, 58, 195, 94, 191, 19, 81, 45, 182, 146, 112, 48, 152, 35, 192, 21, 128, 92, 159, 64, 149, 170, 178, 15, 50, 28, 49, 95, 3, 114, 164, 88, 140, 23, 86, 141, 167, 180, 66, 56, 68, 160, 5, 38, 82, 105, 29, 89, 60, 117, 177, 87, 55, 40, 98, 139, 184, 46, 121, 9, 32, 126, 154, 162, 193, 97, 79, 130, 1, 47, 27, 43, 101, 115, 172, 155, 6, 169, 137, 181, 2, 71, 41, 33, 135, 67, 34, 51, 189, 158, 147, 18, 102, 143, 165, 100, 138, 131, 76, 129, 75, 179, 142, 161, 157, 124, 163, 116, 65, 10, 171, 104, 103, 127, 145, 176, 166, 185, 4, 106, 132, 25, 63, 74, 119, 134, 93, 52, 14, 111, 118, 17, 83], 'val_indices': [13, 39, 99, 36, 173, 44, 54, 70, 133, 186, 107, 150, 168, 136, 122, 0, 16, 53, 22, 80, 72, 7, 30, 78, 91, 190, 77, 109, 148, 11, 156, 144, 113, 108, 153, 69, 120, 174, 123, 59], 'accuracy': 0.8, 'kappa': 0.6, 'auc': 0.8925}, {'fold_index': 4, 'train_indices': [87, 176, 153, 13, 179, 109, 147, 12, 40, 93, 130, 107, 190, 73, 83, 158, 112, 55, 37, 9, 172, 125, 178, 169, 72, 183, 120, 145, 22, 76, 0, 161, 106, 157, 45, 150, 50, 167, 26, 187, 77, 142, 92, 171, 57, 174, 114, 25, 101, 95, 23, 60, 1, 18, 7, 177, 36, 118, 117, 70, 96, 48, 186, 3, 192, 63, 175, 68, 33, 141, 34, 155, 116, 105, 111, 89, 88, 97, 24, 52, 4, 108, 144, 127, 15, 160, 90, 113, 131, 11, 194, 8, 14, 49, 86, 54, 71, 75, 193, 180, 2, 41, 182, 156, 168, 128, 149, 143, 164, 80, 17, 136, 42, 30, 29, 188, 44, 148, 137, 39, 16, 59, 102, 181, 74, 99, 151, 129, 51, 61, 162, 38, 121, 47, 126, 122, 140, 184, 53, 31, 91, 10, 104, 98, 124, 35, 135, 115, 85, 67, 58, 69, 103, 64, 166, 134], 'val_indices': [119, 132, 79, 81, 146, 133, 6, 27, 100, 191, 139, 84, 152, 28, 62, 170, 138, 20, 189, 46, 159, 82, 66, 5, 173, 19, 123, 163, 78, 110, 94, 185, 154, 65, 165, 21, 195, 32, 56, 43], 'accuracy': 0.875, 'kappa': 0.75, 'auc': 0.8949999999999999}], 'std_acc': 0.065, 'std_kappa': 0.13, 'std_auc': 0.043}\n"
     ]
    }
   ],
   "source": [
    "from pickle import dump\n",
    "\n",
    "subjects = [22, 23, 24, 25, 26, 27, 28]\n",
    "\n",
    "for sbj in subjects[:]:\n",
    "  print('sbj = ', sbj)\n",
    "  load_args['sbj'] = sbj\n",
    "  results = train(db_name, load_args, cv_args, model_args, compile_args, fit_args, seed)\n",
    "  with open('sbj' + str(load_args['sbj']) + '.txt', 'wb') as f:\n",
    "    dump(results, f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "7a89376f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T12:03:34.664237Z",
     "iopub.status.busy": "2025-01-20T12:03:34.663679Z",
     "iopub.status.idle": "2025-01-20T12:03:37.209448Z",
     "shell.execute_reply": "2025-01-20T12:03:37.207601Z"
    },
    "id": "V7-P0xjwzXVX",
    "outputId": "270dceef-351d-48d1-f71e-2c3367c7fdac",
    "papermill": {
     "duration": 2.575164,
     "end_time": "2025-01-20T12:03:37.213242",
     "exception": false,
     "start_time": "2025-01-20T12:03:34.638078",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "  adding: sbj22.h5 (deflated 75%)\r\n",
      "  adding: sbj23.h5 (deflated 75%)\r\n",
      "  adding: sbj24.h5 (deflated 75%)\r\n",
      "  adding: sbj25.h5 (deflated 75%)\r\n",
      "  adding: sbj26.h5 (deflated 75%)\r\n",
      "  adding: sbj27.h5 (deflated 75%)\r\n",
      "  adding: sbj28.h5 (deflated 75%)\r\n",
      "  adding: sbj22.txt (deflated 41%)\r\n",
      "  adding: sbj23.txt (deflated 42%)\r\n",
      "  adding: sbj24.txt (deflated 42%)\r\n",
      "  adding: sbj25.txt (deflated 42%)\r\n",
      "  adding: sbj26.txt (deflated 42%)\r\n",
      "  adding: sbj27.txt (deflated 41%)\r\n",
      "  adding: sbj28.txt (deflated 42%)\r\n"
     ]
    }
   ],
   "source": [
    "!zip Models_64ch_EEGNet.zip ./*.h5 \n",
    "!zip Results_64ch_EEGNet.zip ./*.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "3122383e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T12:03:37.261635Z",
     "iopub.status.busy": "2025-01-20T12:03:37.260919Z",
     "iopub.status.idle": "2025-01-20T12:03:37.267997Z",
     "shell.execute_reply": "2025-01-20T12:03:37.266401Z"
    },
    "papermill": {
     "duration": 0.034418,
     "end_time": "2025-01-20T12:03:37.270940",
     "exception": false,
     "start_time": "2025-01-20T12:03:37.236522",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#import pickle as pkl\n",
    "\n",
    "#with open(file= '/kaggle/working/sbj14.txt', mode = 'rb' ) as f:\n",
    "#    results_64ch_ShallowConvNet = pkl.load(f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "7803b155",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T12:03:37.318345Z",
     "iopub.status.busy": "2025-01-20T12:03:37.317801Z",
     "iopub.status.idle": "2025-01-20T12:03:37.325358Z",
     "shell.execute_reply": "2025-01-20T12:03:37.324093Z"
    },
    "papermill": {
     "duration": 0.034264,
     "end_time": "2025-01-20T12:03:37.328028",
     "exception": false,
     "start_time": "2025-01-20T12:03:37.293764",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#results_64ch_ShallowConvNet"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "e6ea2abc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T12:03:37.374173Z",
     "iopub.status.busy": "2025-01-20T12:03:37.373609Z",
     "iopub.status.idle": "2025-01-20T12:03:37.379693Z",
     "shell.execute_reply": "2025-01-20T12:03:37.378265Z"
    },
    "papermill": {
     "duration": 0.032608,
     "end_time": "2025-01-20T12:03:37.382349",
     "exception": false,
     "start_time": "2025-01-20T12:03:37.349741",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#with open(file= '/kaggle/working/sbj2.txt', mode = 'rb' ) as f:\n",
    " #   results_64ch_ShallowConvNet = pkl.load(f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "e1337ee0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-20T12:03:37.429841Z",
     "iopub.status.busy": "2025-01-20T12:03:37.429291Z",
     "iopub.status.idle": "2025-01-20T12:03:37.435970Z",
     "shell.execute_reply": "2025-01-20T12:03:37.434270Z"
    },
    "papermill": {
     "duration": 0.034049,
     "end_time": "2025-01-20T12:03:37.439248",
     "exception": false,
     "start_time": "2025-01-20T12:03:37.405199",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#results_64ch_ShallowConvNet"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 1645904,
     "sourceId": 2702213,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 1269900,
     "sourceId": 2702226,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 2984453,
     "sourceId": 5137200,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 3008205,
     "sourceId": 5175158,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30786,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 29225.368836,
   "end_time": "2025-01-20T12:03:40.191540",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-01-20T03:56:34.822704",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
